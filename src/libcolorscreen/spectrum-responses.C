#include "include/spectrum-to-xyz.h"
#include "spectrum.h"
namespace {
#if 0
/* Absolutes spectral sensitivity of panchromatic emulsion. log.  */
const static spectra_entry absolute_panchromatic[] = {
  {337.07194243011116, 0.047135149544788035},
  {338.2769364579749, 0.1294267981014965},
  {339.14068001310187, 0.21079121681531277},
  {340.58215190049447, 0.2758827517863658},
  {341.82141420119524, 0.35933343764669035},
  {343.2638014867538, 0.4312401119630027},
  {345.66109050572857, 0.5012790804529179},
  {347.1727197895808, 0.5807559241294173},
  {349.26050014530193, 0.6322171804099508},
  {351.5553473024728, 0.7014812496740204},
  {354.2263483794551, 0.7775604582833493},
  {357.30486977462795, 0.8400093882021586},
  {360.72449841697414, 0.9023192336445338},
  {364.82685930073484, 0.9682055370523521},
  {369.6110023333529, 1.0305948593384047},
  {374.7361245107772, 1.0918913750239043},
  {380.5437861829985, 1.1553293501084663},
  {387.37496245118774, 1.2197858731265079},
  {394.88764708716496, 1.2787071149612221},
  {402.3984975301567, 1.3239727900187916},
  {409.90693634903784, 1.3512839235730798},
  {417.4137787406909, 1.3667096564139274},
  {424.91973800238793, 1.375560486732447},
  {432.4253236321805, 1.3816296275222886},
  {439.92972043318616, 1.3788479379936112},
  {447.4330303050152, 1.3679740607451443},
  {454.93647604299133, 1.3581117069616515},
  {462.43975194828363, 1.3469849488469419},
  {469.94309578664945, 1.336363952464719},
  {477.4466094576992, 1.3270073604137123},
  {484.9499872626018, 1.3166392448977327},
  {492.4538745655559, 1.3100643423754046},
  {499.95830533309834, 1.30753553371297},
  {507.4640607955747, 1.3148690788340294},
  {514.9716164844999, 1.3356053098659881},
  {522.4805308348958, 1.3664567755476842},
  {529.9905321144684, 1.4054004289491688},
  {536.4796011983823, 1.462551504720179},
  {541.9459293685547, 1.5244440967332529},
  {548.4350409106396, 1.581911273587067},
  {555.945789454021, 1.6264183060459065},
  {563.4550095032479, 1.6595456995237932},
  {570.9640936863276, 1.691661569536706},
  {578.4719211075469, 1.7144208474986122},
  {585.978016235391, 1.7242832012821054},
  {593.4808166091685, 1.709616111039988},
  {600.9833792171887, 1.6931788547341662},
  {608.4876061855106, 1.6891327608742719},
  {615.992036953053, 1.6866039522118377},
  {623.4934107322862, 1.6613158655874973},
  {630.9939013815635, 1.6294528764408276},
  {638.4956487927012, 1.6069464793451642},
  {645.9985170995523, 1.592785150835534},
  {653.5023364694329, 1.5857044865807182},
  {661.008567463424, 1.5965783638291846},
  {668.517923378798, 1.630717280772045},
  {676.0275170599293, 1.6666263637786085},
  {683.53028346717, 1.6517063926702473},
  {691.034340602808, 1.6463958944791361},
  {698.5386694707402, 1.6431084432179714},
  {706.0464629254226, 1.6656148403136348},
  {713.5581285652969, 1.7169496561610469},
  {721.0694205732665, 1.7655027824797807},
  {728.5792180536184, 1.8029291506838052},
  {736.0819165277858, 1.7875034178429572},
  {741.5314805137359, 1.7245866583215976},
  {744.080135823604, 1.6517063926702473},
  {745.2661368963245, 1.5925954901858512},
  {746.6224207095011, 1.5313983205549464},
  {748.319674771486, 1.469042113620426},
  {749.6752113208537, 1.4022815649321667},
  {750.7569753194292, 1.3290304073436596},
  {752.6561462897808, 1.246136059389071},
  {753.7390810016572, 1.1816008623237533},
  {755.3665468510881, 1.1076079208609326},
  {757.3543433091768, 1.007281651859964},
  {758.7543005405186, 0.932608741845689},
  {760.1755210597564, 0.8469288409047437},
  {761.5306139212374, 0.7768650359011797},
  {762.5459586215976, 0.717058711034614},
  {763.9016819869174, 0.6516890071106931},
  {765.5288115676344, 0.5751925450720625},
  {766.9506117352574, 0.49382812635824624},
  {768.3058680606966, 0.42498131052347876},
  {769.3207768571682, 0.3619296812067887},
  {770.9478939834883, 0.2853404961838688},
  {772.3703293253488, 0.20870494966880404},
  {773.3838992741628, 0.13568559954102088},
  {773.709893110801, 0.02302717362958262},
};

/* Panchromatic emulsion wedge sensitivity to thungsten light.  */
const static spectra_entry wedge_thungsten_panchromatic[] = {
  {355.14229725410485, 0.033397353819889286},
  {358.33024315663425, 0.08409932860875857},
  {361.4818246572336, 0.13541217056375832},
  {364.560677353973, 0.18788566013440677},
  {367.5607405131974, 0.23736590059101426},
  {370.4517104666318, 0.28645344072653733},
  {373.50632022875124, 0.33357747925663883},
  {376.5609299908706, 0.3807015177867408},
  {379.61553975299, 0.4281397165737104},
  {382.88833592668936, 0.47707017658079964},
  {386.3793185119687, 0.5265504170374067},
  {389.870301097248, 0.5741064259207014},
  {393.7976565056872, 0.6214425226241889},
  {398.37957114886626, 0.6644453497846585},
  {403.17967220362533, 0.6966324961018857},
  {407.9797732583844, 0.7214225963710543},
  {412.7798743131434, 0.740814852226775},
  {417.5799753679025, 0.7576081459575026},
  {422.38007642266155, 0.7706029565824699},
  {427.18017747742056, 0.7821983260632102},
  {431.9802785321796, 0.7935937753804894},
  {436.7803795869387, 0.8029900230631584},
  {441.5804806416977, 0.8109868296015998},
  {446.3805816964568, 0.8157849135246646},
  {451.18068275121584, 0.8205829974477299},
  {455.98078380597485, 0.8229820394092622},
  {460.7808848607339, 0.8239816402265674},
  {465.580985915493, 0.8239816402265674},
  {470.381086970252, 0.8213826781015741},
  {475.18118802501107, 0.817384274832353},
  {479.98128907977014, 0.8139856320535155},
  {484.78139013452915, 0.806988426332379},
  {489.5814911892882, 0.7975921786497102},
  {494.3815922440473, 0.7867964898228141},
  {499.1816932988063, 0.7797992841016776},
  {503.98179435356536, 0.7789996034478335},
  {508.78189540832443, 0.7855969688420479},
  {513.5819964630834, 0.7977920988131713},
  {518.3820975178426, 0.8137857118900544},
  {523.1821985726016, 0.831578606438087},
  {527.9822996273606, 0.8499712614765025},
  {532.7824006821196, 0.86876375684184},
  {537.5825017368787, 0.8871564118802557},
  {542.3826027916377, 0.9051492265917491},
  {547.1827038463967, 0.9231420413032427},
  {551.9828049011559, 0.940735015687814},
  {556.7829059559149, 0.9571284690916191},
  {561.5830070106739, 0.9681240780819762},
  {566.383108065433, 0.9741216829858075},
  {571.183209120192, 0.9795195273992556},
  {575.9833101749512, 0.9797194475627167},
  {580.78341122971, 0.9727222418415802},
  {585.5835122844692, 0.9617266328512231},
  {590.3836133392283, 0.940335175360892},
  {595.1837143939872, 0.9215426799955544},
  {599.9838154487463, 0.9115466718225025},
  {604.7839165035055, 0.9073483483898206},
  {609.5840175582643, 0.9069485080628985},
  {614.3841186130235, 0.9129461129667298},
  {619.1842196677825, 0.9247414026109311},
  {623.9843207225415, 0.9309389276782232},
  {628.7844217773006, 0.9183439573801777},
  {632.3844975683699, 0.8734618806831744},
  {634.0208956552196, 0.8195833966304245},
  {634.8390946986444, 0.7648802419033978},
  {636.1482131681241, 0.7101770871763711},
  {637.4246036758668, 0.654209437415453},
  {638.7664501070836, 0.5966474243509334},
  {640.0428406148263, 0.5416144013541961},
  {641.5846912566581, 0.48287341465904365},
  {642.6938055155229, 0.43198817972033554},
  {644.4938434110575, 0.36832360366616745},
  {646.4575211152771, 0.3036144447579159},
  {648.2030124079167, 0.24203903441191565},
  {650.1182042428964, 0.17670679099421083},
  {651.912181404776, 0.11586442124756768},
  {653.8516161743756, 0.06259680436094861},
  {655.6213504016353, 0.02212685460477326},
};
#endif

/* Panchromatic emulsion wedge sensitivity to thungsten light.  */
const static spectra_entry wedge_Neopan_100_acros_daylight_5400k [] = {
  {380.1729818452725, 1.5732847620784898},
  {385.81266010382103, 1.5310698897253516},
  {391.61046018270264, 1.543692036238022},
  {397.62787390093587, 1.5757761441660834},
  {403.2060603404659, 1.5699302283904912},
  {409.0038604193476, 1.5370814898371168},
  {414.8016604982292, 1.534298199879324},
  {420.5994605771108, 1.5392176281567633},
  {426.39726065599245, 1.5426462077435126},
  {432.1950607348741, 1.543590039512445},
  {437.9928608137557, 1.5415521738999973},
  {443.79066089263733, 1.5340478630883534},
  {449.588460971519, 1.5185923592596957},
  {455.3862610504006, 1.4909615911237357},
  {461.1840611292822, 1.4526464073711645},
  {466.9818612081639, 1.4098586775465227},
  {472.77966128704554, 1.364834674685846},
  {478.57746136592715, 1.3205560961705145},
  {484.37526144480876, 1.2802531141636897},
  {490.1730615236904, 1.2479013251738782},
  {495.9708616025721, 1.2344336195994736},
  {501.5659413989753, 1.2578948398937064},
  {507.5664617603353, 1.292476583819997},
  {513.364261839217, 1.3359096032735946},
  {519.1620619180986, 1.3813304209814463},
  {524.9598619969802, 1.42699971347108},
  {530.7576620758618, 1.470184258142897},
  {536.5554621547435, 1.5101386306515514},
  {542.3532622336252, 1.5433841840521012},
  {548.1510623125067, 1.5587395531643709},
  {553.9488623913884, 1.5688769518592252},
  {559.7466624702699, 1.5879594426982198},
  {565.5444625491516, 1.6174778743720448},
  {571.3422626280333, 1.6452569825733976},
  {577.1400627069149, 1.6640909986306105},
  {582.9378627857966, 1.6610592338910364},
  {588.7356628646781, 1.62647117186519},
  {594.5334629435598, 1.5886529376761818},
  {600.2907189659458, 1.5551738055673625},
  {606.4218812871252, 1.5171827953158257},
  {611.9268631802047, 1.497064015905944},
  {617.7246632590864, 1.5191282041263188},
  {623.522463337968, 1.5660398705248606},
  {629.3202634168497, 1.582140663982475},
  {633.4489998366593, 1.5295525936078467},
  {634.8545271285093, 1.4730538556747668},
  {636.1722089646188, 1.4133671166384905},
  {637.602834958109, 1.3411195936516283},
  {638.5440362696158, 1.2762299674575592},
  {639.3346453712816, 1.2187343580789802},
  {640.4766362959097, 1.1586847065554307},
  {641.5307817647972, 1.0912561126093014},
  {643.6566417937206, 0.9619563256169599},
  {644.5300766107989, 0.8838306780362957},
  {645.6595181846069, 0.7975291825817941},
  {646.7136636534945, 0.7228640564195863},
  {647.9654613977984, 0.6462546830680491},
};
/* Response to mean moon sunlight (probably between 5000-5500k).  */
const static spectra_entry ilford_manual_of_photography_panchromatic_emulsion_fig54 [] = {
  {359.879849627755, 0.31079387699942806},
  {363.25987243167424, 0.3300672108428788},
  {367.36514775946716, 0.38326545697272607},
  {371.5592925471522, 0.46359357433074244},
  {376.206424720676, 0.5845300976672299},
  {383.767734599828, 0.799717620411494},
  {389.9581507736075, 1.0243269516350573},
  {399.2441864669615, 1.3567151889388605},
  {411.7937062152416, 1.9597603035362443},
  {419.07853333028487, 2.202176441353002},
  {427.4577713865918, 2.462399385762952},
  {434.5558080627878, 2.7501224908172883},
  {443.4723772052941, 3.1278670672808335},
  {450.94111473039175, 3.3566565545808036},
  {457.5034660511271, 3.508754989455376},
  {466.6405631126249, 3.470080317094931},
  {472.59481692539487, 3.2783938292999064},
  {478.37256611643477, 3.0188703204539227},
  {484.0655601744294, 2.686959345064354},
  {488.7501327222596, 2.3960517510305515},
  {494.34808583009186, 2.1048972973859374},
  {500.2151159137085, 1.8679779002365802},
  {508.2639735242129, 1.7436100283098153},
  {516.6707775703937, 1.7006070841064744},
  {524.8932597738354, 1.6757565499514655},
  {532.74545256106, 1.7053138740192786},
  {540.9638204376549, 1.7257209351796838},
  {549.362395830142, 1.7732331816071785},
  {559.0380582758933, 1.8385028627057025},
  {569.2588690288529, 1.9353047447585308},
  {577.6664959404031, 1.8832502814921082},
  {586.079882909539, 1.7678351847841043},
  {594.4920355806207, 1.6659973666707213},
  {604.1796295742279, 1.6000200213545384},
  {612.9505515463555, 1.5704956119015012},
  {621.5346830796358, 1.5862781696860395},
  {629.7575767157622, 1.556901875999488},
  {638.1701408195288, 1.4505382983545658},
  {645.8569376675097, 1.2900630940197928},
  {652.6324111189122, 1.1072059516381216},
  {659.9579700697393, 0.9015718958322623},
  {666.5573503320963, 0.6463519728680875},
  {672.0561481629194, 0.4412116362838461},
  {678.2848275763747, 0.2449253310740378},
  {685.7004902851478, 0.0528438679017178},
  {693.4699851027507, 0},
  {699.6817957761339, 0},
};

/* Ilford fp4 equal energy spectral sensitivity. (relative log sensitivity)  */
const static spectra_entry ilford_fp4_absolute[] = {
  {351.6820562682886, 1.3045820482561394},
  {353.9149734707438, 1.3033155303535586},
  {356.83309935292294, 1.301914153848439},
  {359.3599128953425, 1.3019737953690154},
  {361.9904098929244, 1.2985745648941263},
  {364.6206715519246, 1.29582957567652},
  {367.25081554163387, 1.2934117070875548},
  {369.8815871008945, 1.2892491951458358},
  {372.5116134213129, 1.2871584471855122},
  {375.1420711957979, 1.28386825692017},
  {377.7725681933798, 1.2804690264452812},
  {380.40306519096174, 1.2770697959703918},
  {383.0889331328051, 1.2730830276403413},
  {385.74363958126474, 1.2705342735882637},
  {388.2939678372531, 1.2685077076889315},
  {390.92462172722287, 1.2646723163758538},
  {393.4068480639676, 1.2581597035509413},
  {396.29511484216823, 1.252486492457128},
  {399.0033136664511, 1.2508810135240103},
  {401.4842991914188, 1.245972053797052},
  {404.09118780694087, 1.241755194332186},
  {406.71023166021064, 1.2369712394868617},
  {409.3406109885017, 1.233899129640614},
  {411.9005064115567, 1.2313342436552812},
  {414.60227177631384, 1.2252469851285348},
  {417.23308255867147, 1.2209754329772684},
  {419.83169640817164, 1.2176127793477307},
  {422.34089355031017, 1.2128540217934463},
  {425.1255541288412, 1.2080517363139232},
  {427.7576200503015, 1.2002908974571491},
  {430.3898820872466, 1.1919848575526395},
  {433.15776288481595, 1.1804339006424533},
  {435.59179302402396, 1.1722401492736372},
  {438.20433199584113, 1.1614357408341238},
  {441.01333419508563, 1.1518905009576452},
  {443.52514568414745, 1.13980300828699},
  {446.2133148526324, 1.1255852377137474},
  {448.9719566497129, 1.1148003529937396},
  {451.27588797878127, 1.0976702910985079},
  {453.70163844416516, 1.0855772196984912},
  {455.92128795171203, 1.070220997394159},
  {458.17888980529085, 1.0608340783492451},
  {459.8281229746911, 1.0443298816684128},
  {462.02544398292264, 1.0358870742856672},
  {463.88795504928055, 1.017670372965557},
  {466.0855013019145, 1.0086013861441623},
  {467.73546255005203, 0.9900731305736113},
  {469.920493356551, 0.98192115834024},
  {471.3301400827942, 0.9614405515458319},
  {473.53504499905165, 0.9514350166880415},
  {474.6691836492824, 0.931122035962119},
  {476.89218909090334, 0.9214247976348562},
  {477.9502827765907, 0.9007564884082326},
  {480.2192084434653, 0.8802343093550733},
  {482.5679365182652, 0.8557708864896065},
  {484.736779971876, 0.8294195528702413},
  {486.7427875848394, 0.8031585173774989},
  {488.8620472757911, 0.7747575573898094},
  {491.840351817069, 0.7458132129221298},
  {494.3666951492667, 0.7550906258972044},
  {496.9878766613208, 0.777588445189757},
  {499.6090581733748, 0.8000862644823091},
  {502.2318674439527, 0.8180589150786559},
  {504.8557357381485, 0.8330874800172304},
  {507.48087878299543, 0.8445722381455235},
  {510.1065317281029, 0.854639473549704},
  {512.733439812313, 0.8612174222483763},
  {515.3611323584623, 0.8656145667561066},
  {517.9893936395175, 0.8684306282254034},
  {520.6179883168969, 0.8703198479135498},
  {523.247387067764, 0.86997374330598},
  {525.8779625115399, 0.8663564324119967},
  {528.5081653358945, 0.8637750035087111},
  {531.134269346617, 0.8725882765030993},
  {533.7585690948794, 0.8864173991366557},
  {536.3817902079753, 0.9032451275327574},
  {539.0060115100437, 0.9172923305854078},
  {541.6320174630238, 0.9263782041036642},
  {544.2570624501284, 0.938135562755825},
  {546.8807542403878, 0.9536548086373616},
  {549.5036223456111, 0.9714638989193878},
  {552.1287850020066, 0.9828941369429073},
  {554.754477170211, 0.9928523321375405},
  {557.3807576848698, 1.0011749241889671},
  {560.0074892651435, 1.0082435538306016},
  {562.6350053073566, 1.013131379281294},
  {565.2064500646995, 1.0156856359172193},
  {568.0779857561682, 1.0172355969846874},
  {570.5223386518246, 1.0144919500686214},
  {573.1536397228942, 1.0088573952980162},
  {575.7850388517062, 1.0029502400035433},
  {578.3603751005976, 0.994686150135115},
  {580.8691572250149, 0.9815884374004593},
  {583.2946124849848, 0.9703160370512446},
  {585.5137169979213, 0.9564748997637775},
  {587.7901838156084, 0.948039843002038},
  {588.9240451025106, 0.9284979323293414},
  {591.1408651606229, 0.9192442287824953},
  {593.0044929316238, 0.8979230885552788},
  {595.2217027486615, 0.887585855195076},
  {596.3571049429444, 0.8637602220044567},
  {598.448948348333, 0.8579706754852267},
  {599.03115638805, 0.8342066718658699},
  {600.2176655305643, 0.8138585240847668},
  {602.4622842922511, 0.8029797040704231},
  {603.2800556922414, 0.7786159575749954},
  {605.7452092331716, 0.7748404750167814},
  {605.7531322987575, 0.7528143526882628},
  {608.3809817372946, 0.7567753363578046},
  {611.0057717742689, 0.7692414563720216},
  {613.6284829871045, 0.7874867074922363},
  {616.2508608036158, 0.8066588003936013},
  {618.8736504626452, 0.8246859710947217},
  {621.4959106098655, 0.8441851846247281},
  {624.1192493922524, 0.8606857923921889},
  {626.7448238911659, 0.8709711082154635},
  {629.1872940781682, 0.8734613913576594},
  {631.1853746391461, 0.852516750920739},
  {632.4134439214802, 0.7830803455567206},
  {632.5125824781061, 0.7474296316128015},
  {632.9127561248343, 0.7055130061390095},
  {633.1294419449257, 0.675325555343152},
  {633.2884161740633, 0.6209959631858454},
  {633.3851282625201, 0.5565946068652401},
  {633.5634847358783, 0.5207946725042005},
  {634.6185929658091, 0.48007667718659586},
  {634.7873041956569, 0.44102313013914984},
  {635.121896824269, 0.37980318335021157},
  {635.84362702317, 0.35225700321236597},
  {636.09362383659, 0.32175517306849066},
  {636.482616659365, 0.2798062625032611},
  {637.1371324783265, 0.24329860408022186},
  {637.5783805521908, 0.17579364599053626},
  {637.7319638180815, 0.1401425389440234},
  {637.9127697810286, 0.1058087145808202},
  {638.3041910738355, 0.06660136177254294},
  {638.5901465018878, 0.035807979625009034},
  {638.8501222315044, 0.015535580235860325}
};
/* Ilford SFX200 wedge spectrogramto tungsten light. (Sensitivity)  */
const static spectra_entry ilford_sfx200_wedge_tungsten[] = {
  {354.0041067761807, -0.06451612903225734},
  {358.93223819301846, 0.020737327188940613},
  {365.2292950034223, 0.13594470046082985},
  {371.80013689253934, 0.2419354838709682},
  {381.3826146475017, 0.3617511520737331},
  {390.4175222450376, 0.4677419354838712},
  {400.2737850787132, 0.566820276497696},
  {412.8678986995209, 0.6428571428571432},
  {423.27173169062286, 0.6889400921658988},
  {434.7707049965777, 0.7396313364055301},
  {453.11430527036276, 0.7534562211981568},
  {472.00547570157426, 0.7557603686635946},
  {484.5995893223819, 0.7258064516129034},
  {496.6461327857632, 0.6774193548387097},
  {507.0499657768652, 0.631336405529954},
  {524.0246406570842, 0.6221198156682031},
  {538.8090349075976, 0.6290322580645162},
  {554.6885694729638, 0.6428571428571432},
  {571.1156741957564, 0.6612903225806452},
  {583.1622176591376, 0.6889400921658988},
  {597.946611909651, 0.7165898617511521},
  {613.8261464750171, 0.7004608294930879},
  {630.8008213552362, 0.6866359447004611},
  {644.4900752908967, 0.6866359447004611},
  {661.4647501711157, 0.7004608294930879},
  {678.4394250513346, 0.7327188940092166},
  {692.6762491444217, 0.7718894009216589},
  {705.2703627652293, 0.804147465437788},
  {715.6741957563313, 0.8248847926267281},
  {726.6255989048598, 0.7995391705069126},
  {731.006160164271, 0.7073732718894012},
  {733.7440109514032, 0.6059907834101386},
  {737.303216974675, 0.5092165898617513},
  {740.3148528405201, 0.4124423963133643},
  {743.3264887063656, 0.3064516129032262},
  {747.707049965777, 0.1958525345622124},
  {752.3613963039015, 0.10829493087557651},
  {758.9322381930185, 0.016129032258064946},
  {769.3360711841206, -0.057603686635943285},
  {775.9069130732375, -0.07142857142857095}
};
/* Ilford FP4 wedge spectrogramto tungsten light. (Sensitivity)  */
const static spectra_entry ilford_fp4_plus_wedge_tungsten[] = {
  {364.9169672241462, -0.1041963385346234},
  {365.85493224478506, -0.06190208736565461},
  {366.660263448348, -0.024406371927393256},
  {367.97723956787746, 0.014508402093569295},
  {369.9709160255099, 0.05610169915430596},
  {371.820787556332, 0.09139781986197226},
  {373.534030917912, 0.12181784406119456},
  {376.0034763834226, 0.15222699017047558},
  {378.8733724649619, 0.18548131856120031},
  {382.123225086619, 0.21327430822142923},
  {385.3735008897847, 0.24013545219997545},
  {388.32539342646794, 0.2709485069227544},
  {391.12818904196195, 0.30352896107936833},
  {394.01178411347587, 0.3363039336390825},
  {397.0802228527458, 0.36775935774024093},
  {400.42896896263574, 0.3954849003286176},
  {403.6819047638547, 0.41648872859372865},
  {406.9378028356331, 0.43096963708706015},
  {410.1960586329587, 0.44025883392530174},
  {413.45534215680493, 0.4472849769651708},
  {416.7152302256633, 0.45297991188834974},
  {419.9731232959816, 0.4630678335966054},
  {423.22950500376965, 0.47648377559658517},
  {426.48479853053595, 0.4922958922066063},
  {429.7391247852828, 0.5102379418033314},
  {432.9928464950175, 0.5295111995167461},
  {436.24511729672315, 0.5519793567102158},
  {439.4967230989154, 0.5759118428320449},
  {442.747542992592, 0.6015748995055701},
  {446.00108333882304, 0.6212475196539913},
  {449.25655822909295, 0.6366602738290059},
  {452.5134235728907, 0.6490112493356337},
  {455.7714980067127, 0.6586998086088822},
  {459.0307210760577, 0.6658590724604203},
  {462.29000459990397, 0.6728852155002891},
  {465.55170630379865, 0.6745865260733992},
  {468.81195709966426, 0.6794827361265647},
  {472.07432380307233, 0.6797197177713159},
  {475.3368114154828, 0.6796904577927292},
  {478.59929902789327, 0.6796611978141427},
  {481.8628748213256, 0.6772357632255146},
  {485.1269342507676, 0.6737453621435345},
  {488.3896636811829, 0.673183618918272},
  {491.6552344731552, 0.6663651975445677},
  {494.9200193566117, 0.6612773467225599},
  {498.18528787607795, 0.6551245294072006},
  {501.45110048605505, 0.6477736247868204},
  {504.7147367339886, 0.6452150693865231},
  {507.97722434639905, 0.6451858094079366},
  {511.2376565057683, 0.6496826570260952},
  {514.4947636675709, 0.6615011492860472},
  {517.7490294678166, 0.6795763196944409},
  {521.0016629965295, 0.7012457520178972},
  {524.2560497057775, 0.7190546808029528},
  {527.5129150495752, 0.731405656309581},
  {530.7713522104045, 0.7402954907128156},
  {534.0311193702605, 0.7462566672593329},
  {537.2934860736685, 0.7464936489040841},
  {540.5560945950814, 0.7461981473021595},
  {543.8202749335259, 0.7424415045968418},
  {547.0817348194157, 0.7446752984166276},
  {550.3416833427752, 0.7502371125281377},
  {553.5986695955754, 0.7623218464114279},
  {556.8536003953344, 0.7789326878914629},
  {560.1087125585971, 0.7951441669364911},
  {563.3640665398644, 0.8108231627348437},
  {566.6186346126161, 0.8282327290848925},
  {569.8734445033726, 0.8451098121882654},
  {573.1274080311123, 0.8638505866550044},
  {576.3813715588518, 0.8825913611217429},
  {579.6346700870781, 0.9027964645168403},
  {582.8899031593431, 0.9187417019385307},
  {586.1457407766203, 0.9333557312435312},
  {589.402606120418, 0.945706706750159},
  {592.6605596452375, 0.9556615076467456},
  {595.9189363515657, 0.9646844628616491},
  {599.1790057839276, 0.9699800353498214},
  {602.4408283968248, 0.9714151042995935},
  {605.7031346457316, 0.9717852067560138},
  {608.9679195291881, 0.9666973559340062},
  {612.233671684664, 0.9594795721252949},
  {615.5014792931812, 0.9477356807198385},
  {618.7691659926959, 0.9362580309377202},
  {622.0331045131354, 0.9330338714790782},
  {625.2942016720181, 0.9360663901688779},
  {628.5576565564479, 0.9339071972035875},
  {631.8956518408722, 0.9183226685388985},
  {633.8920408343984, 0.8838061338690983},
  {635.4181542629958, 0.8481162145335417},
  {636.7675214004872, 0.815705967002365},
  {638.1166557881488, 0.7838082345961142},
  {639.4832223991641, 0.749807415367856},
  {641.0854131155203, 0.7121762160186449},
  {642.1691461974108, 0.6769129210754168},
  {643.6703707237682, 0.636656724286149},
  {645.437957699424, 0.5876021436473495},
  {646.7130047470744, 0.5492930307216071},
  {648.0280412846898, 0.5108427588607074},
  {649.415882480563, 0.4690689473166927},
  {650.7054955752458, 0.42757198530083995},
  {651.8574863230924, 0.3904344103883588},
  {653.207260688821, 0.3538290218237812},
  {654.2320711193886, 0.3195099301340003},
  {655.4803711193055, 0.2773008891969613},
  {656.7816868103189, 0.23424017105977968},
  {658.0413167975736, 0.19163038769748475},
  {659.2841222971409, 0.1504451421108508},
  {660.2366749889222, 0.11377971416596955},
  {661.3141853114779, 0.08392575379180034},
  {661.8409124260027, 0.05531443473045039},
  {662.7442311399261, 0.025470752820981435},
  {663.8064514875604, -0.011403104443587164},
  {664.6932800607739, -0.0484746993134455},
  {665.6473696403193, -0.08126782031442303},
  {666.5502727295468, -0.11019629664366803},
};
/* Rollei Retro 80s absolute log sensitivity */
const static spectra_entry rollei_retro_80s[] = {
  {335.44303797468365, -0.004158004158005824},
  {340.50632911392404, 0.21413721413721376},
  {346.20253164556965, 0.4636174636174637},
  {351.2658227848103, 0.6923076923076916},
  {358.2278481012659, 0.8690228690228685},
  {372.1518987341773, 0.9885654885654889},
  {382.2784810126582, 1.087318087318085},
  {384.8101265822785, 1.1548856548856552},
  {402.5316455696203, 1.264033264033264},
  {411.3924050632911, 1.316008316008316},
  {445.56962025316454, 1.321205821205821},
  {462.02531645569627, 1.316008316008316},
  {481.0126582278482, 1.2484407484407467},
  {491.77215189873436, 1.222453222453221},
  {500.0000000000001, 1.2328482328482324},
  {509.49367088607585, 1.3316008316008277},
  {524.0506329113924, 1.4147609147609144},
  {544.3037974683544, 1.4355509355509342},
  {558.2278481012659, 1.4407484407484406},
  {577.2151898734178, 1.5654885654885655},
  {589.240506329114, 1.6174636174636166},
  {600.632911392405, 1.622661122661122},
  {611.3924050632912, 1.503118503118503},
  {618.3544303797469, 1.4199584199584199},
  {625.3164556962026, 1.3575883575883574},
  {635.4430379746836, 1.367983367983368},
  {641.7721518987343, 1.3575883575883574},
  {656.9620253164558, 1.4511434511434516},
  {671.5189873417723, 1.5343035343035343},
  {677.8481012658232, 1.539501039501038},
  {684.8101265822786, 1.5810810810810807},
  {694.9367088607596, 1.5862785862785862},
  {706.3291139240507, 1.669438669438669},
  {727.848101265823, 1.6902286902286905},
  {736.7088607594939, 1.6382536382536377},
  {742.4050632911392, 1.492723492723493},
  {750.632911392405, 1.180873180873181},
  {757.5949367088609, 0.9002079002078998},
  {760.7594936708861, 0.7650727650727651},
  {765.1898734177215, 0.5987525987525988},
  {770.8860759493672, 0.3804573804573801},
  {774.6835443037975, 0.21413721413721376},
  {775.9493670886078, -0.004158004158004935}
};
/* Approximation of spicer-dufay. Rollei emulsion with faster cut after 750.  */
const static spectra_entry spicer_dufay_guess[] = {
  {335.44303797468365, 0},
  {340.50632911392404, 0.21413721413721376},
  {346.20253164556965, 0.4636174636174637},
  {351.2658227848103, 0.6923076923076916},
  {358.2278481012659, 0.8690228690228685},
  {372.1518987341773, 0.9885654885654889},
  {382.2784810126582, 1.087318087318085},
  {384.8101265822785, 1.1548856548856552},
  {402.5316455696203, 1.264033264033264},
  {411.3924050632911, 1.316008316008316},
  {445.56962025316454, 1.321205821205821},
  {462.02531645569627, 1.316008316008316},
  {481.0126582278482, 1.2484407484407467},
  {491.77215189873436, 1.222453222453221},
  {500.0000000000001, 1.2328482328482324},
  {509.49367088607585, 1.3316008316008277},
  {524.0506329113924, 1.4147609147609144},
  {544.3037974683544, 1.4355509355509342},
  {558.2278481012659, 1.4407484407484406},
  {577.2151898734178, 1.5654885654885655},
  {589.240506329114, 1.6174636174636166},
  {600.632911392405, 1.622661122661122},
  {611.3924050632912, 1.503118503118503},
  {618.3544303797469, 1.4199584199584199},
  {625.3164556962026, 1.4175883575883574},
  {640, 1.40},
  {650, 1.4},
  {660, 1.35},
  {660, 1.1},
  {680, 0},
#if 0
  {635.4430379746836, 1.367983367983368},
  {641.7721518987343, 1.3575883575883574},
  {656.9620253164558, 1.4511434511434516},
  {671.5189873417723, 1.33},
  {677.8481012658232, 1.33},
  {684.8101265822786, 1.33},
  {694.9367088607596, 1.33},
  {706.3291139240507, 1.33},
  {727.848101265823, 1.33},
  {736.7088607594939, 1.23},
  {742.4050632911392, 1.1},
  {750.632911392405, 0.7},
  {753.7594936708861, 0},
#endif
};
const static spectra_entry bergger_pancro_400[] = {
  {417.43821399219473, 1.840113289270028},
  {421.1845218663119, 1.8583971125979484},
  {424.93068024913566, 1.875313921097613},
  {428.6760724890802, 1.8852247786024674},
  {432.42013799379504, 1.883003379506552},
  {436.1622787981062, 1.8631816644968437},
  {438.81819600959994, 1.8321568357774458},
  {442.284171503499, 1.8160196529220207},
  {446.0263870534569, 1.7968814453264406},
  {449.77017226199644, 1.7920968934275454},
  {453.5144806900632, 1.7920968934275454},
  {457.25800428883906, 1.7849200655792028},
  {461.000873863206, 1.7717625478572412},
  {464.7436873783378, 1.758092399574684},
  {468.4862766565294, 1.742371729049743},
  {472.2297441960703, 1.7346822706408047},
  {475.9727258889073, 1.7225500140400352},
  {479.71333440746014, 1.6887163970407055},
  {483.45637215953224, 1.677096771000532},
  {487.22411909751884, 1.6519910179046813},
  {489.7569564246777, 1.6160736311303805},
  {492.9047667645825, 1.5773226755750769},
  {495.8977937806384, 1.5224304349736308},
  {498.0974890725478, 1.476750232420975},
  {500.4940132259649, 1.4271950686051478},
  {503.12181229305384, 1.3854669409726412},
  {505.59048784430786, 1.3412326194883328},
  {508.47911394383834, 1.3036858784401488},
  {511.68777428279213, 1.2765728181118363},
  {513.3641609276737, 1.250246390877678},
  {516.9764829177508, 1.2404932658530072},
  {520.8516752855177, 1.240164656519292},
  {524.5616577588119, 1.253924739987919},
  {528.1444123807493, 1.279948808653382},
  {531.9506096547209, 1.3118474965759523},
  {535.8388501688019, 1.3310711425982986},
  {539.3488870535566, 1.3437291741330128},
  {543.3309426975089, 1.3628542373552448},
  {547.155490577357, 1.3782857316665162},
  {550.8957614057557, 1.392672248296573},
  {554.5692122954515, 1.4117250174653875},
  {558.3145111033376, 1.4207814907025818},
  {562.0589316498745, 1.4218067518237736},
  {565.8024926214738, 1.4149716776824948},
  {569.5467263038938, 1.4142881702683672},
  {573.2910347319605, 1.4142881702683672},
  {577.0353431600273, 1.4142881702683672},
  {580.7788667588032, 1.4071113424200243},
  {584.5218110788169, 1.3946373321121908},
  {588.2651478134759, 1.3857517357285287},
  {592.0080547606661, 1.3729359717136314},
  {595.751167258385, 1.3619998530875852},
  {599.4945039930441, 1.3531142567039232},
  {603.2381023374667, 1.3466209362697084},
  {606.9818688595946, 1.3416655075172814},
  {610.7270181761872, 1.3493549659262198},
  {614.472634653072, 1.3613163456734578},
  {618.2188304087191, 1.3785749078801866},
  {621.9651756556597, 1.397200484915171},
  {625.8387169711478, 1.4117036578586966},
  {629.4583519962446, 1.438894437176971},
  {633.2043608877748, 1.4544442308483798},
  {636.9495288907792, 1.4623045661108505},
  {640.6948650714886, 1.4717027930551088},
  {644.4402573114332, 1.481613650559963},
  {648.1858364154946, 1.4932332766001366},
  {651.9309109864405, 1.5002392275949474},
  {655.6740608569827, 1.4896448626759655},
  {658.8867660992282, 1.4531028475481542},
  {661.4542771962933, 1.43073506742082},
  {663.0149230101513, 1.3835872955837911},
  {664.507767982167, 1.3389770450217122},
  {665.714273359768, 1.2828304708855565},
  {666.9246310968579, 1.2359724777126424},
  {668.5789448183582, 1.2153142798199301},
  {668.9117017597193, 1.1454988796625836},
  {670.1318180740338, 1.0492032005106458},
  {671.0237676989921, 1.0048387497301858},
  {672.2318566721232, 0.898325511028593},
  {673.4037304634055, 0.8421020004267659},
  {674.0974426124487, 0.7439382738624607},
  {674.6448423563891, 0.6561075711470301},
  {675.5570871014243, 0.6177522897157774},
  {675.7601077773152, 0.5587603421272029},
  {676.6718695504791, 0.5159885512508167},
  {677.2863441691676, 0.4284141638156833},
  {677.9620572733543, 0.3820495775573427},
  {678.5180029362392, 0.2780425327075524},
  {678.6263965816279, 0.2316779464492118},
  {679.694658250512, 0.14347701055112827},
  {680.0300212047791, 0.09749215063396965},
  {680.1302068837629, 0.055882906555972056},
  {681.0416769572489, 0.010443684181374202}
};
const static spectra_entry ilford_delta_400_professional_wedge_thungsten_2850[] = {
  {355.22942047403353, -0.09890627536467078},
  {356.5606000151164, -0.06998910043830131},
  {358.4399123084099, -0.02983678281497859},
  {360.18708545608115, 0.012028651932933343},
  {361.58772275319626, 0.05236862549569854},
  {363.19153810413553, 0.08319989100438341},
  {364.8290847013647, 0.129743406720078},
  {366.46124785192035, 0.17307982189652416},
  {368.1460219586034, 0.21167035783029187},
  {369.7794086197667, 0.25262777996799723},
  {371.3381611338656, 0.2960186759010557},
  {373.0339468360171, 0.34591396883189196},
  {374.7297325381686, 0.3919532348780521},
  {376.2884850522675, 0.4339881653132023},
  {377.9842707544191, 0.47827950708471545},
  {379.73144390209035, 0.5207314354322196},
  {381.1874215251498, 0.5517722592451265},
  {382.9969937138093, 0.5837860323276365},
  {385.31554631523585, 0.6151790549711689},
  {388.01595657729837, 0.6456543795366528},
  {391.0880693619537, 0.6836630169649466},
  {394.22991581171345, 0.7029644397222505},
  {397.4943709034151, 0.7326472705768757},
  {400.88471879711057, 0.7479244451659287},
  {403.7886741661796, 0.7633052474878386},
  {407.1038232156071, 0.7816315241888051},
  {410.3069739863378, 0.794597944262551},
  {413.3559624205093, 0.8037430070240106},
  {416.7132755277992, 0.8200068886494876},
  {419.9164262985299, 0.8314016214415674},
  {423.1195770692606, 0.8425344063533694},
  {426.44405930857954, 0.8471621522382754},
  {429.40454714213365, 0.8543657189459121},
  {432.60423129947617, 0.8587564643677097},
  {435.9321801521834, 0.8649309501171125},
  {439.135330922914, 0.869646011962111},
  {442.3384816936447, 0.8721345168247492},
  {445.5416324643754, 0.8721345168247492},
  {448.74478323510607, 0.8768495786697477},
  {451.9479340058368, 0.8807787968739131},
  {455.1510847765675, 0.8807787968739131},
  {458.3542355472982, 0.8807787968739131},
  {461.5573863180289, 0.8807787968739131},
  {464.7605370887595, 0.8807787968739131},
  {467.9636878594903, 0.8807787968739131},
  {471.1668386302209, 0.8780283441309973},
  {474.3699894009516, 0.8713486731839161},
  {477.69793825365883, 0.8589622805593564},
  {480.62212860585373, 0.846116928833638},
  {483.9794417131437, 0.8418795366526752},
  {487.1825924838744, 0.8310086996211508},
  {490.385743254605, 0.823936106853653},
  {493.5888940253358, 0.8180422795474048},
  {497.06504060039003, 0.8087431297975466},
  {499.9951955667971, 0.8073024164560193},
  {503.47134214185144, 0.8000988497483826},
  {506.12971461862077, 0.7971213755092261},
  {509.6046478789892, 0.7986581364068553},
  {513.0795811393576, 0.7971213755092261},
  {515.7379536161269, 0.8000988497483826},
  {519.4710374187799, 0.8052684682091571},
  {522.4172509619119, 0.8186971492480991},
  {525.6204017326427, 0.8302228559803178},
  {529.0251494050277, 0.8444284910261467},
  {531.9019051921275, 0.8573157510261823},
  {535.2298540448347, 0.8764566568493312},
  {538.5543362841537, 0.8926646819415136},
  {541.4808513065032, 0.9039262578944522},
  {544.8393063570268, 0.9238692231795942},
  {548.0424571277574, 0.9356568777920905},
  {551.2456078984882, 0.9428604444997271},
  {554.3863596282306, 0.9474632429674638},
  {557.6519094399496, 0.954255177291807},
  {560.6678630877154, 0.9573424201665084},
  {564.0582109814109, 0.9631614052212486},
  {567.2613617521416, 0.9681384149465249},
  {570.4645125228723, 0.9701030240486076},
  {573.667663293603, 0.9736393204323565},
  {576.8708140643337, 0.9744251640731896},
  {580.0739648350643, 0.9724605549711068},
  {583.2771156057951, 0.9701030240486076},
  {586.4802663765257, 0.9701030240486076},
  {589.6834171472565, 0.966304779784581},
  {592.8865679179871, 0.9628994573409709},
  {596.3393148526709, 0.9579598687414487},
  {599.0912725577941, 0.9533685844662516},
  {602.4960202301792, 0.954255177291807},
  {605.7505584464295, 0.9451024101809274},
  {608.9023217716406, 0.9456108972426429},
  {612.1054725423712, 0.9456108972426429},
  {615.3086233131019, 0.9445631057215321},
  {618.5117740838326, 0.9399790178166725},
  {621.7149248545634, 0.9384073305350064},
  {624.918075625294, 0.9384073305350064},
  {628.1212263960247, 0.9384073305350064},
  {631.3243771667553, 0.9384073305350064},
  {634.5275279374861, 0.9384073305350064},
  {637.7306787082168, 0.9384073305350064},
  {640.9338294789475, 0.9422055747990329},
  {644.1369802496781, 0.9456108972426429},
  {647.228132741712, 0.949378916751253},
  {650.5432817911395, 0.954255177291807},
  {653.8774705479454, 0.9516618932770577},
  {656.7656703696882, 0.9518287127166031},
  {660.1527341033316, 0.954255177291807},
  {663.4806829560388, 0.9480806915424042},
  {666.559035644793, 0.9367046693132013},
  {669.7621864155235, 0.9108279608543403},
  {671.839381157755, 0.8852930320106988},
  {674.1815067302216, 0.8495915904220274},
  {675.8772924323731, 0.8021327979952448},
  {677.5730781345246, 0.7585724063749478},
  {679.1318306486236, 0.7128085708205503},
  {680.6437033878624, 0.6548901103260228},
  {681.7012029246107, 0.614377802631496},
  {682.5747894984464, 0.5804555521355342},
  {683.094781506682, 0.5443722316272817},
  {684.3947615272707, 0.5043924363998982},
  {685.1426045791147, 0.4724020515209846},
  {686.0161911529503, 0.4387417489053005},
  {686.9136028151634, 0.40505525150158883},
  {687.8163089414602, 0.37412793843680214},
  {688.1075044660721, 0.34038031986102557},
  {689.0538899210608, 0.3038931630373449},
  {689.9274764948964, 0.266794794493016},
  {690.728264187579, 0.2260400701198111},
  {691.6018507614147, 0.18884347112037836},
  {692.4754373352503, 0.15112297636038985},
  {693.0578283844741, 0.11431929918137373},
  {693.7566976435426, 0.0758042291845431},
  {694.6302842173783, 0.03623263607059224},
  {695.678588105981, -0.0032952990633121626},
  {696.5521746798167, -0.03931313260149527},
  {697.4257612536524, -0.07441414855870643},
  {697.7169567782641, -0.09746556202314371},
};

/* Described as relative sensitivity. Y axis has no units, s-\lambda.
   Maybe to D55, since next table is relative to Daylight 55k.  */
const static spectra_entry fomapan_400[] = {
#if 0
  {403.59336871536203, 0.5019334366503194},
  {406.5104296355319, 0.5291576401650686},
  {409.4274905557018, 0.555659077214824},
  {412.3445514758717, 0.5809559034895906},
  {415.2616123960416, 0.6045662746793727},
  {418.1786733162115, 0.6252855800091817},
  {421.09573423638136, 0.6435956637890128},
  {424.01279515655125, 0.6592556038638682},
  {426.92985607672114, 0.6729881666987416},
  {429.846916996891, 0.6850342744486302},
  {432.7639779170609, 0.6968394600435213},
  {435.6810388372308, 0.7081628013284169},
  {438.5980997574007, 0.7194861426133123},
  {441.5151606775706, 0.7310504060532057},
  {444.43222159774047, 0.7416509808731078},
  {447.21668883972086, 0.7527815844340053},
  {452.653029645492, 0.77176625024783},
  {455.57009056566187, 0.7797166813627567},
  {458.48715148583176, 0.7833305136877233},
  {461.40421240600165, 0.7867034238576922},
  {464.32127332617154, 0.7845351244627121},
  {467.2383342463414, 0.7792348370527611},
  {470.1553951665113, 0.7679114957678654},
  {473.0724560866812, 0.7534561664679991},
  {475.9895170068511, 0.7402054479431213},
  {478.906577927021, 0.7363506934631567},
  {481.82363884719086, 0.7430965138030945},
  {484.74069976736075, 0.76092475327293},
  {487.6577606875307, 0.7859806573926988},
  {490.5748216077006, 0.81513223814743},
  {493.4918825278705, 0.8471748847621345},
  {496.40894344804036, 0.8794584535318366},
  {498.39784862088345, 0.9019846750241287},
  {503.0386273575174, 0.954867088046141},
  {505.9556882776873, 0.987150656815843},
  {508.87274919785716, 1.0160613154155762},
  {511.78981011802705, 1.0420809081553364},
  {514.7068710381969, 1.0647275907251272},
  {517.6239319583668, 1.0811102972649762},
  {520.5409928785367, 1.0914699499298806},
  {523.4580537987066, 1.094120093634856},
  {526.3751147188765, 1.0909881056198851},
  {529.2921756390464, 1.082314908039965},
  {532.2092365592163, 1.0690641895150872},
  {535.1262974793862, 1.0524405608202407},
  {538.043358399556, 1.035816932125394},
  {540.9604193197259, 1.0201569920505384},
  {543.8774802398958, 1.0081108843006492},
  {546.7945411600657, 0.9999195310307252},
  {549.2475242065723, 0.9993774561819799},
  {552.6286630004055, 1.0114837944706185},
  {555.5457239205754, 1.027866501010467},
  {558.4627848407453, 1.047622117720285},
  {561.3798457609151, 1.071232488910067},
  {564.2969066810851, 1.0989385367348117},
  {567.213967601255, 1.1300174947295247},
  {570.1310285214249, 1.1618192191892314},
  {573.0480894415948, 1.1907298777889646},
  {575.9651503617647, 1.2080762729488046},
  {578.8822112819346, 1.2121719495837668},
  {581.7992722021045, 1.2027759855388536},
  {584.7163331222744, 1.183743135294029},
  {587.6333940424443, 1.163264752119218},
  {590.5504549626141, 1.1565189317792803},
  {593.467515882784, 1.1647102850492046},
  {596.3845768029539, 1.178442847884078},
  {598.5060756539865, 1.1900552957549708},
  {603.0142607124309, 1.216267626218729},
  {605.9313216326008, 1.2328912549135758},
  {608.8483825527707, 1.2495148836084222},
  {611.7654434729405, 1.2666203566132646},
  {614.6825043931104, 1.2839667517731046},
  {617.5995653132803, 1.3015540690879421},
  {620.5166262334502, 1.3189004642477822},
  {623.4336871536201, 1.3355240929426289},
  {626.35074807379, 1.3533523324124643},
  {629.2678089939599, 1.370216883262309},
  {632.1848699141299, 1.3868405119571554},
  {635.1019308342998, 1.403464140652002},
  {638.0189917544697, 1.419846847191851},
  {640.9360526746395, 1.435988631576702},
  {643.8531135948094, 1.451166727341562},
  {646.7701745149793, 1.4668266674164174},
  {648.4938923314432, 1.4757407871513353},
  {653.1346710680772, 1.4976647032561328},
  {656.0517319882471, 1.5097108110060218},
  {658.968792908417, 1.5215159966009129},
  {661.885853828587, 1.5316347271108195},
  {664.8029147487568, 1.5415125354657284},
  {667.7199756689267, 1.5487402001156618},
  {670.6370365890966, 1.553799565370615},
  {673.5540975092665, 1.5586180084705705},
  {676.4711584294364, 1.5617499964855417},
  {679.3882193496063, 1.556931553385586},
  {681.9453831432616, 1.5190895663255781},
  {683.2334360171029, 1.4622250542559598},
  {683.9928361740066, 1.400091230482033},
  {684.7214317390078, 1.332927487494319},
  {685.1693037186701, 1.2769800092781687},
  {686.0179032590833, 1.2120514885062676},
  {686.5482779718413, 1.1506564926743341},
  {687.3197320994897, 1.0866515068299245},
  {687.821177282461, 1.01779595493156},
  {688.669776822874, 0.9483621898612005},
  {689.3327452138217, 0.8794584535318362},
  {689.9957136047694, 0.813793781730775},
  {690.3934946393381, 0.7555642353242291},
  {691.2269406165294, 0.6818334515322306},
  {691.852025099423, 0.6020767457443952},
  {692.1172124558021, 0.5455403467049167},
  {692.6475871685602, 0.4890039476654382},
  {693.2575180882321, 0.42946405242698793},
  {693.6818178584388, 0.36109034483861846},
  {694.2387113068348, 0.2961323780255509},
  {694.6630110770412, 0.22699307336685548},
  {694.9547171690583, 0.1623295669654521},
  {695.7074412806265, 0.08298834158264556},
  {696.1392206942182, 0.03582937411461895},
#endif
  {  403.59336871536203, 0.3764500774877395},
  {406.5104296355319, 0.3968682301238011},
  {409.4274905557018, 0.41674430791111794},
  {412.3445514758717, 0.43571692761719283},
  {415.2616123960416, 0.45342470600952933},
  {418.1786733162115, 0.46896418500688597},
  {421.09573423638136, 0.4826967478417594},
  {424.01279515655125, 0.4944417028979009},
  {426.92985607672114, 0.5047411250240561},
  {429.846916996891, 0.5137757058364727},
  {432.7639779170609, 0.522629595032641},
  {435.6810388372308, 0.5311221009963125},
  {438.5980997574007, 0.5396146069599843},
  {441.5151606775706, 0.5482878045399042},
  {444.43222159774047, 0.5562382356548308},
  {447.21668883972086, 0.5645861883255039},
  {452.653029645492, 0.5788246876858723},
  {455.57009056566187, 0.5847875110220673},
  {458.48715148583176, 0.5874978852657924},
  {461.40421240600165, 0.5900275678932689},
  {464.32127332617154, 0.5884013433470339},
  {467.2383342463414, 0.5844261277895706},
  {470.1553951665113, 0.5759336218258988},
  {473.0724560866812, 0.565092124850999},
  {475.9895170068511, 0.5551540859573407},
  {478.906577927021, 0.5522630200973673},
  {481.82363884719086, 0.5573223853523206},
  {484.74069976736075, 0.5706935649546974},
  {487.6577606875307, 0.5894854930445239},
  {490.5748216077006, 0.6113491786105723},
  {493.4918825278705, 0.6353811635716007},
  {496.40894344804036, 0.6595938401488772},
  {498.39784862088345, 0.6764885062680963},
  {503.0386273575174, 0.7161503160346054},
  {505.9556882776873, 0.740362992611882},
  {508.87274919785716, 0.762045986561682},
  {511.78981011802705, 0.7815606811165019},
  {514.7068710381969, 0.7985456930438453},
  {517.6239319583668, 0.810832722948732},
  {520.5409928785367, 0.8186024624474102},
  {523.4580537987066, 0.8205900702261419},
  {526.3751147188765, 0.8182410792149137},
  {529.2921756390464, 0.8117361810299735},
  {532.2092365592163, 0.8017981421363152},
  {535.1262974793862, 0.7893304206151803},
  {538.043358399556, 0.7768626990940453},
  {540.9604193197259, 0.7651177440379038},
  {543.8774802398958, 0.756083163225487},
  {546.7945411600657, 0.7499396482730438},
  {549.2475242065723, 0.7495330921364849},
  {552.6286630004055, 0.7586128458529637},
  {555.5457239205754, 0.7708998757578502},
  {558.4627848407453, 0.7857165882902137},
  {561.3798457609151, 0.8034243666825502},
  {564.2969066810851, 0.8242039025511088},
  {567.213967601255, 0.8475131210471436},
  {570.1310285214249, 0.8713644143919234},
  {573.0480894415948, 0.8930474083417234},
  {575.9651503617647, 0.9060572047116033},
  {578.8822112819346, 0.909128962187825},
  {581.7992722021045, 0.90208198915414},
  {584.7163331222744, 0.8878073514705217},
  {587.6333940424443, 0.8724485640894133},
  {590.5504549626141, 0.8673891988344601},
  {593.467515882784, 0.8735327137869033},
  {596.3845768029539, 0.8838321359130583},
  {598.5060756539865, 0.892541471816228},
  {603.0142607124309, 0.9122007196640466},
  {605.9313216326008, 0.9246684411851817},
  {608.8483825527707, 0.9371361627063166},
  {611.7654434729405, 0.9499652674599482},
  {614.6825043931104, 0.9629750638298282},
  {617.5995653132803, 0.9761655518159565},
  {620.5166262334502, 0.9891753481858365},
  {623.4336871536201, 1.0016430697069714},
  {626.35074807379, 1.0150142493093481},
  {629.2678089939599, 1.0276626624467315},
  {632.1848699141299, 1.0401303839678664},
  {635.1019308342998, 1.0525981054890012},
  {638.0189917544697, 1.064885135393888},
  {640.9360526746395, 1.0769914736825261},
  {643.8531135948094, 1.0883750455061714},
  {646.7701745149793, 1.1001200005623128},
  {648.4938923314432, 1.1068055903635012},
  {653.1346710680772, 1.1232485274420996},
  {656.0517319882471, 1.1322831082545162},
  {658.968792908417, 1.1411369974506844},
  {661.885853828587, 1.1487260453331145},
  {664.8029147487568, 1.1561344015992963},
  {667.7199756689267, 1.161555150086746},
  {670.6370365890966, 1.165349674027961},
  {673.5540975092665, 1.1689635063529278},
  {676.4711584294364, 1.171312497364156},
  {679.3882193496063, 1.1676986650391894},
  {681.9453831432616, 1.1393171747441833},
  {683.2334360171029, 1.0966687906919697},
  {683.9928361740066, 1.0500684228615245},
  {684.7214317390078, 0.9996956156207393},
  {685.1693037186701, 0.9577350069586265},
  {686.0179032590833, 0.9090386163797007},
  {686.5482779718413, 0.8629923695057504},
  {687.3197320994897, 0.8149886301224432},
  {687.821177282461, 0.7633469661986698},
  {688.669776822874, 0.7112716423959002},
  {689.3327452138217, 0.659593840148877},
  {689.9957136047694, 0.6103453362980811},
  {690.3934946393381, 0.5666731764931716},
  {691.2269406165294, 0.5113750886491728},
  {691.852025099423, 0.45155755930829633},
  {692.1172124558021, 0.4091552600286874},
  {692.6475871685602, 0.3667529607490785},
  {693.2575180882321, 0.3220980393202406},
  {693.6818178584388, 0.2708177586289635},
  {694.2387113068348, 0.22209928351916308},
  {694.6630110770412, 0.17024480502514128},
  {694.9547171690583, 0.12174717522408884},
  {695.7074412806265, 0.06224125618698384},
  {696.1392206942182, 0.02687203058596399}
};
/* Described as relative sensitivity. Y axis has no units, s-\lambda.
   Wedge spectrogram 2850K.  */
const static spectra_entry fomapan_100_classic[] = {
  {402.8946316390634, 0.3758078686019861},
  {406.0168475157053, 0.3907577349121465},
  {409.1390633923472, 0.40997899159663853},
  {412.26127926898914, 0.4315139180672267},
  {415.38349514563106, 0.4542946667303285},
  {418.505711022273, 0.47689744079449947},
  {421.6279268989149, 0.49576274828113065},
  {424.7501427755568, 0.5100007161955691},
  {427.8723586521987, 0.5187214715431625},
  {430.99457452884064, 0.5253065317035903},
  {434.11679040548256, 0.5299338712757828},
  {437.2390062821245, 0.5350951346447668},
  {440.3612221587664, 0.5434599407944993},
  {443.4834380354083, 0.5537824675324676},
  {446.60565391205023, 0.5653508164629488},
  {448.5925185608224, 0.5731223739495799},
  {453.1339234723015, 0.5911571333078685},
  {456.25613934894346, 0.6016576346447668},
  {459.3783552255854, 0.61020041539343},
  {462.5005711022273, 0.6135819327731091},
  {465.6227869788692, 0.6107343391902214},
  {468.74500285551113, 0.6043272536287241},
  {471.86721873215305, 0.6000558632543926},
  {474.98943460879497, 0.5966743458747135},
  {478.1116504854369, 0.5940047268907562},
  {481.2338663620788, 0.5940047268907562},
  {484.3560822387207, 0.5940047268907562},
  {487.47829811536263, 0.5940047268907562},
  {490.60051399200455, 0.5964963712757829},
  {493.72272986864647, 0.6004118124522535},
  {496.8449457452884, 0.6077087710084033},
  {498.83181039406054, 0.6135819327731091},
  {503.94089091947455, 0.6324472402597401},
  {507.0631067961165, 0.6486429287624138},
  {510.1853226727584, 0.66928798223835},
  {513.3075385494003, 0.6958061974789915},
  {516.5919474585951, 0.7288077731092437},
  {519.3086807538549, 0.7650256039915966},
  {522.6741861793261, 0.8029469060351413},
  {525.796402055968, 0.8241258833078684},
  {528.9186179326099, 0.8388977750190985},
  {532.0408338092518, 0.8490423271581358},
  {535.1630496858937, 0.852423844537815},
  {538.2852655625356, 0.8502881493506491},
  {541.4074814391776, 0.8454828351795263},
  {544.5296973158195, 0.8410334702062641},
  {547.5099942889777, 0.8379367121848738},
  {553.3286693318104, 0.8440590383880824},
  {556.4508852084523, 0.8540256159281894},
  {559.5731010850942, 0.8671957362490448},
  {562.6953169617361, 0.8848152215431624},
  {565.817532838378, 0.9058162242169594},
  {568.93974871502, 0.927885074484339},
  {572.0619645916619, 0.9440807629870129},
  {575.1841804683038, 0.9511997469442321},
  {578.3063963449457, 0.9513777215431625},
  {581.4286122215876, 0.9446146867838043},
  {584.5508280982295, 0.9312665918640182},
  {587.6730439748715, 0.9116893859816653},
  {590.7952598515134, 0.8899764849121465},
  {593.9174757281553, 0.8899764849121465},
  {597.0396916047972, 0.9006549608479755},
  {604.1356367789834, 0.9314445664629487},
  {607.2578526556254, 0.9463944327731091},
  {610.3800685322673, 0.9624121466768523},
  {613.5022844089092, 0.9789637843773871},
  {616.6245002855511, 0.9953374474789913},
  {619.746716162193, 1.0127789581741786},
  {622.8689320388349, 1.0305764180672268},
  {625.9911479154769, 1.0497976747517188},
  {629.1133637921188, 1.0691969060351412},
  {632.2355796687607, 1.090197908708938},
  {635.3577955454026, 1.1065715718105422},
  {638.4800114220445, 1.114224479564553},
  {641.6022272986864, 1.1129786573720395},
  {644.7244431753284, 1.0894711790966385},
  {646.2382448124881, 1.0400713629201679},
  {647.0983593790561, 0.9930237776928952},
  {647.988577955454, 0.9483521533613444},
  {648.4143346659052, 0.9064569327731091},
  {648.8400913763563, 0.8680856092436973},
  {652.3880639634494, 0.7682418592436973},
  {652.8138206739006, 0.7251720063025209},
  {653.2395773843518, 0.6812320553221287},
  {654.0910908052541, 0.6379446778711484},
  {654.9426042261564, 0.5933521533613444},
  {655.7941176470588, 0.5496297268907562},
  {656.6172472872644, 0.502970719537815},
  {657.7551788588339, 0.45304884453781513},
  {658.6324957167333, 0.4047584033613445},
  {659.4840091376357, 0.35994835434173655},
  {660.335522558538, 0.31622592787114834},
  {661.1870359794402, 0.27272102591036407},
  {662.0385494003426, 0.2303037464985993},
  {662.890062821245, 0.18745141806722687},
  {663.7415762421473, 0.14481661414565816},
  {664.5930896630496, 0.10174676120448178},
  {665.5865219874357, 0.054000131302521126},
  {666.2961165048544, 0.03148634453781529}
};

/* No description if it is absolute.  */
const static spectra_entry kodak_professional_trix_400[] = {
  {305.0321459666412, 2.5086362124373554},
  {311.8909660518822, 2.5350859589270183},
  {318.7497861371232, 2.5639402278248324},
  {325.6086062223642, 2.595499584431817},
  {332.46742630760514, 2.6276600716408387},
  {339.3262463928462, 2.6562137752376342},
  {345.873301928758, 2.6773735724293646},
  {354.914473859303, 2.6955878296711098},
  {361.773293944544, 2.7028013968955635},
  {368.63211402978493, 2.7088127029159415},
  {375.49093411502594, 2.712419486528168},
  {382.34975420026694, 2.712419486528168},
  {389.2085742855079, 2.7109166600230736},
  {396.0673943707489, 2.705205919303715},
  {404.7968017519647, 2.6961889602731475},
  {411.65562183720573, 2.6883742624466564},
  {418.5144419224467, 2.6775539116099765},
  {425.3732620076877, 2.662225081258012},
  {432.2320820929287, 2.6438905978958593},
  {439.09090217816964, 2.621648765620461},
  {445.94972226341065, 2.5970024109369114},
  {453.6992982038778, 2.5631673456222126},
  {459.66736243389266, 2.5284735223046026},
  {466.5261825191336, 2.4791808129375035},
  {473.3850026043746, 2.4241773628510455},
  {480.2438226896156, 2.3658676944533785},
  {487.1026427748566, 2.3096619831628447},
  {493.9614628600976, 2.2624732309028777},
  {500.6421317742933, 2.2353794159110314},
  {507.6791030305796, 2.2309138742958936},
  {514.5379231158206, 2.2483466617549897},
  {521.3967432010616, 2.277501495953823},
  {528.2555632863025, 2.309361417861826},
  {535.1143833715435, 2.3415219050708482},
  {541.9732034567845, 2.3709773045707},
  {547.584965344709, 2.3936055779474086},
  {555.6908436272665, 2.4202700139377993},
  {562.5496637125075, 2.4398067585040275},
  {569.4084837977484, 2.4527310664478406},
  {576.2673038829895, 2.4548350235549727},
  {583.1261239682304, 2.4398067585040275},
  {589.9849440534715, 2.4103513590041756},
  {596.5319995893833, 2.383781386394105},
  {607.443758815903, 2.384502743116551},
  {614.302578901144, 2.4079468365960244},
  {621.161398986385, 2.4133570120143646},
  {627.3966899729678, 2.375919933965233},
  {631.7613936635757, 2.3037709032628744},
  {634.5672746075379, 2.2247522856250064},
  {636.7496264528419, 2.1437499370004134},
  {638.3084491994875, 2.05833929729421},
  {640.1166835855965, 1.9584694628403239},
  {641.4260946927789, 1.8759462537925753},
  {642.3613883407663, 1.8032094509460022},
  {643.6084465380828, 1.7180743294323992},
  {644.7307989156677, 1.6054975959357711},
  {645.7284454735209, 1.5036660719505681},
  {646.5702097567096, 1.4188615722680864},
  {647.5990327694958, 1.3211628211718938},
  {648.4407970526845, 1.2411523380406626},
  {654.4162842481596, 0.7584444646043127},
  {655.45549941259, 0.6733093430907098},
  {656.9519692493698, 0.5799086757990874},
  {657.9496158072232, 0.5038656546413063},
  {659.446085644003, 0.4238551715100751},
  {660.8178496610512, 0.34119971372987834},
  {662.6260840471601, 0.2542461721451117},
  {664.434318433269, 0.1646476559113781},
  {666.990787737768, 0.06909794671746994},
  {668.5496104844137, 0.027770217827371546},
};
const static spectra_entry dufaycolor_harrison_horner_emulsion_cut[] = {
  {400.09487623169673, 94.85861182519284},
  {619.763002170191, 95.47695382488124},
  {622.6368308331375, 95.05531008997433},
  {629.9085131677735, 92.97854833683886},
  {631.8348774957719, 92.12961475292778},
  {635.9784083156758, 89.46470651242507},
  {637.36523774873, 88.27009247357901},
  {640.1622628517762, 84.61463688946019},
  {641.1383645949575, 83.49005194944306},
  {643.6984323149857, 77.88376312125109},
  {643.8536371057553, 76.86897493573268},
  {644.8697701948012, 73.57507230077124},
  {645.1654443116051, 72.34401778063413},
  {646.1935499657485, 68.40131614181665},
  {646.483391294428, 67.4863431876607},
  {647.5044362050523, 63.92626660239934},
  {647.5216275805769, 62.99465777634964},
  {648.446014859425, 58.7558376178235},
  {649.7295440067587, 54.28411525278494},
  {649.7437882893364, 53.5122107969152},
  {650.9206519684276, 48.90407428234792},
  {652.2410548620398, 43.91331271422453},
  {652.3944177197175, 42.998339760068575},
  {653.662474629079, 39.36506533847475},
  {655.1410030930781, 34.68040381319625},
  {656.9539414015026, 30.469151670951177},
  {657.2802768127008, 29.68964224507286},
  {658.9463867403689, 26.03925664095975},
  {659.2769322843485, 25.031598114824362},
  {661.4920468681054, 20.861539560125692},
  {664.0787992283399, 16.274475149957183},
  {664.915352612033, 15.316248928877485},
  {667.1675280590807, 11.603122322193684},
  {671.6243746216245, 6.75115145672666},
  {677.0186072479793, 2.8726167523564925},
  {684.8421534686709, 0.4734215548804457},
  {687.8541015975554, 0},
  {690.85696285652, 0},
  {693.8594892185587, 0},
  {696.8631319036833, 0},
  {698.7739421300165, 0},
};
const static spectra_entry aviphot_pan_400s[] = {
  {301.2540495349566, 3.2274996492141623},
  {306.54892534921794, 3.28827606147534},
  {312.6798341867837, 3.3012353628889746},
  {318.81074302434945, 3.255285792385607},
  {324.9416518619152, 3.2498497583307353},
  {331.07256069948096, 3.256896273343778},
  {337.2034695370467, 3.2556210889782116},
  {343.33437837461247, 3.246900173589678},
  {349.4652872121782, 3.2694951269153867},
  {355.596196049744, 3.2850823333959505},
  {361.7271048873097, 3.2673827423620745},
  {367.8580137248755, 3.245303309549983},
  {373.9889225624412, 3.2238808530046237},
  {380.119831400007, 3.202896380637086},
  {386.2507402375727, 3.2092859193833965},
  {392.38164907513845, 3.2288149834643547},
  {398.5125579127042, 3.216371202564338},
  {404.64346675026997, 3.201299516597391},
  {410.7743755878357, 3.1895127119641065},
  {416.9052844254015, 3.1807917965755728},
  {423.03619326296723, 3.17228987327595},
  {429.16710210053293, 3.164882910420881},
  {435.29801093809874, 3.1537530820543287},
  {441.42891977566444, 3.1428422457766874},
  {447.55982861323025, 3.129522496521027},
  {453.69073745079595, 3.112698873842794},
  {459.82164628836176, 3.0899624647639703},
  {465.95255512592746, 3.0556194749728744},
  {472.0834639634932, 3.0120788174475255},
  {478.21437280105897, 2.9626253735215853},
  {484.3452816386247, 2.9252164944857384},
  {490.4761904761905, 2.9064219430073086},
  {496.60709931375624, 2.9022998614859015},
  {502.738008151322, 2.912193273654785},
  {508.86891698888775, 2.9347882269804937},
  {514.9998258264535, 2.970084721463029},
  {521.1307346640192, 3.0064761763901173},
  {527.261643501585, 3.042867631317206},
  {533.3925523391507, 3.073784284021525},
  {539.5234611767164, 3.0906854430355537},
  {545.6543700142822, 3.1027687760935447},
  {551.785278851848, 3.1124431961735173},
  {557.9161876894137, 3.1216796320756686},
  {564.0470965269794, 3.133105988866927},
  {570.1780053645452, 3.1432183931247213},
  {576.308914202111, 3.1509218844044966},
  {582.4398230396768, 3.156873438972986},
  {588.5707318772425, 3.148590507762274},
  {594.7016407148083, 3.134613782239881},
  {600.832549552374, 3.1250168984957045},
  {606.9634583899397, 3.1189238881741},
  {613.0943672275055, 3.1189626563419983},
  {619.2252760650713, 3.121629329576826},
  {625.356184902637, 3.132836694279174},
  {631.4870937402027, 3.144044058981522},
  {637.6180025777685, 3.1607262259066395},
  {643.7489114153343, 3.177627384920668},
  {649.8798202529, 3.19825140944618},
  {656.0107290904657, 3.2149335763712976},
  {662.1416379280315, 3.2322727195631478},
  {668.2725467655972, 3.2294645905752057},
  {674.4034556031629, 3.1944646245173773},
  {679.4196537429896, 3.1548274912504928},
  {683.3211411850768, 3.0984147721320685},
  {686.107917929425, 3.0447480476592945},
  {687.7799839760337, 2.9907301440032894},
  {688.894694673773, 2.931546759586916},
  {690.6782317901557, 2.8641084742148726},
  {691.681471418121, 2.7985923850947847},
  {692.7961821158602, 2.735967696424099},
  {695.2113886276286, 2.6732976999046674},
  {700.5991570000349, 2.6366384277809805},
  {706.7300658376006, 2.622661702258588},
  {712.8609746751663, 2.616349699848073},
  {718.7132058382972, 2.589187888383801},
  {723.450726303689, 2.5301650646004488},
  {726.5161807224719, 2.4807157000286573},
  {729.0242797923852, 2.428819485057404},
  {731.5721899586463, 2.361248380949108},
  {734.0404779322116, 2.294674751591862},
  {737.1988249091394, 2.2188139642647067},
  {739.2955426501252, 2.1549336736540727},
  {740.728742118647, 2.093572810474101},
  {742.4804303579515, 2.0274125224320088},
  {743.7543854410821, 1.9534926229522491},
  {745.2672071022996, 1.8809289060714944},
  {746.9711220259867, 1.8059880739423504},
  {747.3055352353085, 1.7476944945016384},
  {749.2129290958844, 1.6866093850669404},
  {749.6464277005609, 1.6099194745503498},
  {750.7611383983001, 1.5336740186706206},
  {752.194337866822, 1.4807490242898615},
  {754.1848926842133, 1.4219153086086194},
  {756.0560142125614, 1.363287315958586},
  {758.28543560804, 1.3095826540643687},
  {761.3508900268228, 1.245284061635219},
  {764.1376667711709, 1.1850788590792511},
  {765.8097328177796, 1.1306479989127292},
  {768.5965095621277, 1.087305187202892},
  {771.6619639809105, 1.0177872833213684},
  {774.4885518216065, 0.952267429269535},
  {777.5141951440414, 0.8965756694062104},
  {780.0222942139549, 0.8366698187830455},
  {783.6451039816072, 0.7669346222574367},
  {786.1930141478683, 0.7104559888622077},
  {789.2186574703035, 0.6538312531788248},
  {791.7267565402167, 0.6063915272169056},
  {794.2348556101299, 0.5577473447659775},
  {797.8576653777825, 0.49502643443261407},
  {800.0870867732608, 0.4370175134464236},
  {803.7098965409134, 0.3729748077081565},
  {807.0540286341311, 0.3128419556161748},
  {809.8408053784792, 0.25745457901624436},
  {812.3489044483924, 0.20724460312960424},
  {815.4143588671752, 0.15555839079250955},
  {817.6437802626538, 0.12356835874300387}
};
const static spectra_entry aviphot_pan_40_pe0[] = {
  {362.7546862265689, 1.4455275229357794},
  {372.9421352893236, 1.41341743119266},
  {382.31458842705786, 1.3973623853211004},
  {392.90953545232276, 1.3130733944954123},
  {402.68948655256725, 1.2889908256880729},
  {412.87693561532194, 1.2568807339449535},
  {422.6568867155663, 1.2247706422018343},
  {432.8443357783211, 1.112385321100917},
  {442.6242868785656, 1.0160550458715591},
  {452.40423797881016, 0.9157110091743114},
  {462.5916870415648, 0.8314220183486234},
  {472.3716381418092, 0.7230504587155959},
  {482.55908720456387, 0.6307339449541278},
  {492.33903830480864, 0.6267201834862379},
  {502.5264873675633, 0.6508027522935775},
  {512.3064384678075, 0.7591743119266049},
  {522.0863895680523, 0.7792431192660545},
  {532.681336593317, 0.891628440366972},
  {542.0537897310513, 0.9759174311926601},
  {552.6487367563161, 1.1163990825688068},
  {562.0211898940506, 1.192660550458715},
  {572.2086389568053, 1.2127293577981646},
  {582.3960880195599, 1.108371559633027},
  {592.5835370823146, 1.0080275229357794},
  {602.3634881825592, 0.9237385321100913},
  {612.1434392828036, 0.9919724770642196},
  {622.7383863080685, 1.0481651376146783},
  {632.5183374083131, 1.108371559633027},
  {641.8907905460472, 1.160550458715596},
  {652.078239608802, 1.2047018348623848},
  {662.2656886715567, 1.2127293577981646},
  {672.0456397718011, 1.2528669724770638},
  {682.2330888345558, 1.2287844036697242},
  {692.0130399348004, 1.2127293577981646},
  {702.200488997555, 1.160550458715596},
  {712.3879380603097, 1.1364678899082563},
  {722.5753871230645, 0.9678899082568803},
  {731.9478402607988, 0.5624999999999996},
  {741.7277913610432, -0.16800458715596234},
  {751.5077424612878, -0.8985091743119265},
  {760.880195599022, -1.3560779816513762},
  {771.0676446617766, -1.7534403669724776},
  {780.8475957620212, -2.190940366972478},
};

/* Could be typical response of monochromatic ccd.
   Based on Ravimal Bandara: "A Music Keyboard with Gesture Controlled Effects Based on Computer Vision".  */
const static spectra_entry monochromatic_ccd[] = {
  {359.63024481837215, 13.459900074103373},
  {389.6343371608772, 20.378881902865473},
  {418.05926674851355, 26.80743781656207},
  {446.48419633614986, 33.40167816102405},
  {478.8570328109579, 40.70199685098552},
  {504.9132182662912, 46.746564952590504},
  {528.9954502780386, 51.9400990166528},
  {560.1839146866952, 58.25434277583047},
  {595.4518828787625, 64.93664843632791},
  {639.1420524301294, 73.7624054954697},
  {673.8836330372404, 80.21506096273217},
  {708.6252136443516, 86.08209727834391},
  {734.7941964393183, 90.39051372925705},
  {738.6293059868566, 79.13058105226787},
  {762.3167473098869, 94.04217982115173},
  {797.0583279169979, 97.21428355925975},
  {831.7999085241089, 99.65436335780439},
  {866.54148913122, 100.00681932870528},
  {901.283069738331, 97.8107475100151},
  {936.0246503454422, 93.31015588158834},
  {966.0287426879472, 86.66093843055422},
  {988.1370212561087, 79.52822368610478},
  {1005.5078115596643, 72.33089201365684},
  {1021.2994391083512, 65.3522637898192},
  {1035.5119039021693, 58.328900769674895},
  {1046.5660431862502, 52.09088195135848},
  {1057.6201824703307, 44.61022990230174},
  {1068.6743217544117, 36.48340857326005},
  {1078.149298283624, 29.02760918881812},
  {1087.624274812836, 21.472399145916967},
  {1097.0992513420479, 14.116010419934256},
};
}

void
set_response (spectrum film_response, spectrum_dyes_to_xyz::responses type)
{
  switch (type)
  {
  case spectrum_dyes_to_xyz::neopan_100:
    {
      spectrum dl;
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_D, 5400);
      compute_log_sensitivity (film_response, sizeof (wedge_Neopan_100_acros_daylight_5400k) / sizeof (spectra_entry), wedge_Neopan_100_acros_daylight_5400k);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::ilford_panchromatic:
    {
      spectrum dl;
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_D, 5400);
      compute_spectrum (film_response, sizeof (ilford_manual_of_photography_panchromatic_emulsion_fig54) / sizeof (spectra_entry), ilford_manual_of_photography_panchromatic_emulsion_fig54, false);
      //log2_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
      {
	if (film_response[i] < 0)
	  film_response [i] = 0;
	else if (dl[i])
	  film_response[i] /= dl[i];
      }
    }
    break;
  case spectrum_dyes_to_xyz::ilford_panchromatic_fp4:
    {
      /* It is best to clamp missing data to 0 for spectral response.
	 We make sure it remans zero in log_sensitivity_to_reversal_transmiatance  */
      compute_log_sensitivity (film_response, sizeof (ilford_fp4_absolute) / sizeof (spectra_entry), ilford_fp4_absolute);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
    break;
  case spectrum_dyes_to_xyz::ilford_sfx200:
    {
      spectrum dl;
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_A);
      compute_log_sensitivity (film_response, sizeof (ilford_sfx200_wedge_tungsten) / sizeof (spectra_entry), ilford_sfx200_wedge_tungsten);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::ilford_fp4_plus:
    {
      spectrum dl;
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_A);
      compute_log_sensitivity (film_response, sizeof (ilford_fp4_plus_wedge_tungsten) / sizeof (spectra_entry), ilford_fp4_plus_wedge_tungsten);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::rollei_retro_80s:
    {
      compute_log_sensitivity (film_response, sizeof (rollei_retro_80s) / sizeof (spectra_entry), rollei_retro_80s);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
    break;
  case spectrum_dyes_to_xyz::spicer_dufay_guess:
    {
      compute_log_sensitivity (film_response, sizeof (spicer_dufay_guess) / sizeof (spectra_entry), spicer_dufay_guess);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
    break;
  case spectrum_dyes_to_xyz::observer_y:
    for (int i = 0; i < SPECTRUM_SIZE; i++)
      film_response[i] = cie_cmf_y [i];
    break;
  case spectrum_dyes_to_xyz::response_even:
    for (int i = 0; i < SPECTRUM_SIZE; i++)
      film_response[i] = 1;
    break;
  case spectrum_dyes_to_xyz::bergger_pancro_400:
    {
      //spectrum dl;
      //set_illuminant_to (dl, spectrum_dyes_to_xyz::il_D, 6500);
      compute_log_sensitivity (film_response, sizeof (bergger_pancro_400) / sizeof (spectra_entry), bergger_pancro_400);
      log_sensitivity_to_reversal_transmitance (film_response);
      /* ??? It is not specified if it is absolute or relative.  */
      //for (int i = 0; i < SPECTRUM_SIZE; i++)
	//if (dl[i])
	  //film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::ilford_delta_400_professional:
    {
      spectrum dl;
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_A);
      compute_log_sensitivity (film_response, sizeof (ilford_delta_400_professional_wedge_thungsten_2850) / sizeof (spectra_entry), ilford_delta_400_professional_wedge_thungsten_2850);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::fomapan_400:
    {
      spectrum dl;
      //set_illuminant_to (dl, spectrum_dyes_to_xyz::il_D, 5500);
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_A);
      compute_log_sensitivity (film_response, sizeof (fomapan_400) / sizeof (spectra_entry), fomapan_400);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::fomapan_100_classic:
    {
      spectrum dl;
      //set_illuminant_to (dl, spectrum_dyes_to_xyz::il_D, 5500);
      set_illuminant_to (dl, spectrum_dyes_to_xyz::il_A);
      compute_log_sensitivity (film_response, sizeof (fomapan_100_classic) / sizeof (spectra_entry), fomapan_100_classic);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	if (dl[i])
	  film_response[i] /= dl[i];
    }
    break;
  case spectrum_dyes_to_xyz::kodak_professional_trix_400:
    {
      compute_log_sensitivity (film_response, sizeof (kodak_professional_trix_400) / sizeof (spectra_entry), kodak_professional_trix_400);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
    break;
  case spectrum_dyes_to_xyz::dufaycolor_harrison_horner_emulsion_cut:
    {
      compute_spectrum (film_response, sizeof (dufaycolor_harrison_horner_emulsion_cut) / sizeof (spectra_entry), dufaycolor_harrison_horner_emulsion_cut, false);
    }
  case spectrum_dyes_to_xyz::aviphot_pan_400s:
    {
      compute_spectrum (film_response, sizeof (aviphot_pan_400s) / sizeof (spectra_entry), aviphot_pan_400s, false);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
  case spectrum_dyes_to_xyz::aviphot_pan_40_pe0:
    {
      compute_spectrum (film_response, sizeof (aviphot_pan_40_pe0) / sizeof (spectra_entry), aviphot_pan_40_pe0, false);
      log_sensitivity_to_reversal_transmitance (film_response);
    }
    break;
  case spectrum_dyes_to_xyz::aviphot_pan_40_pe0_cut:
    {
      spectrum r;
      compute_spectrum (r, sizeof (dufaycolor_harrison_horner_emulsion_cut) / sizeof (spectra_entry), dufaycolor_harrison_horner_emulsion_cut, false);
      compute_spectrum (film_response, sizeof (aviphot_pan_40_pe0) / sizeof (spectra_entry), aviphot_pan_40_pe0, false);
      log_sensitivity_to_reversal_transmitance (film_response);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
        film_response[i] *= r[i];
    }
    break;
  case spectrum_dyes_to_xyz::monochromatic_ccd:
    compute_spectrum (film_response, sizeof (monochromatic_ccd) / sizeof (spectra_entry), monochromatic_ccd, false);
    break;
  default: abort ();
  }
}

#include "include/spectrum-to-xyz.h"
#include "spectrum.h"
namespace colorscreen
{
namespace {
// transmitance charts with iregular step
const static spectra_entry autochrome_violet[] = {
  {393.5, 0.127095 }, 
  {405.5, 0.1566675}, 
  {418  , 0.169205 }, 
  {430.5, 0.1837325}, 
  {442  , 0.1938125}, 
  {458.5, 0.211625 }, 
  {469  , 0.21933  }, 
  {482  , 0.218295 }, 
  {497  , 0.1910525}, 
  {512  , 0.1400325}, 
  {526.5, 0.0923225}, 
  {540.5, 0.06805  }, 
  {553  , 0.056125 }, 
  {567.5, 0.0512375}, 
  {581.5, 0.0581   }, 
  {599  , 0.074075 }, 
  {613.5, 0.10036  }, 
  {630  , 0.1587275}, 
  {642.5, 0.2249375}, 
  {660  , 0.34685  }, 
  {674  , 0.453125 }, 
  {687  , 0.532825 },
  {702.5, 0.596525 }, 
  {717.5, 0.6243   }, 
  {729  , 0.631325 }
};

const static spectra_entry autochrome_green[] =
{
  {393.5, 0.0169965 }, 
  {405.5, 0.013315  }, 
  {418  , 0.01199775}, 
  {430.5, 0.01231825}, 
  {442  , 0.01352325}, 
  {458.5, 0.018713  }, 
  {469  , 0.02652   }, 
  {482  , 0.0556475 }, 
  {497  , 0.1408075 }, 
  {512  , 0.257125  }, 
  {526.5, 0.28885   }, 
  {540.5, 0.250425  }, 
  {553  , 0.1931475 }, 
  {567.5, 0.1177475 }, 
  {581.5, 0.07777   }, 
  {599  , 0.05971   }, 
  {613.5, 0.054905  }, 
  {630  , 0.056885  }, 
  {642.5, 0.0627625 }, 
  {660  , 0.08448   }, 
  {674  , 0.1544125 }, 
  {687  , 0.299875  },
  {702.5, 0.49825   }, 
  {717.5, 0.604925  }, 
  {729  , 0.64265   }
};

const static spectra_entry autochrome_orange[] =
{
  {393.5, 0.020332 }, 
  {405.5, 0.0154836}, 
  {418  , 0.0136168}, 
  {430.5, 0.013252 }, 
  {442  , 0.0139408}, 
  {458.5, 0.0169314}, 
  {469  , 0.0198558}, 
  {482  , 0.0243   }, 
  {497  , 0.029428 }, 
  {512  , 0.032502 }, 
  {526.5, 0.03029  }, 
  {540.5, 0.028432 }, 
  {553  , 0.042744 }, 
  {567.5, 0.155518 }, 
  {581.5, 0.3822   }, 
  {599  , 0.5858   }, 
  {613.5, 0.62472  }, 
  {630  , 0.64806  }, 
  {642.5, 0.65596  }, 
  {660  , 0.67084  }, 
  {674  , 0.67944  }, 
  {687  , 0.69568  },
  {702.5, 0.71826  }, 
  {717.5, 0.7292   }, 
  {729  , 0.72862  }
};
/* Dufay_measuredODs_DC_MSI_NSMM11948.xlsx
   NSMM, Bradford  - 11948*/
const static spectra_entry real_dufay_red[] = {
  {399.8, 1.6927},
  {415, 1.7791},
  {431.4, 2.0204},
  {448.6, 2.1196},
  {465, 1.9656},
  {479.6, 1.8325},
  {495, 1.8215},
  {511.6, 1.8198},
  {528, 1.918},
  {544.6, 2.0032},
  {559.8, 1.6813},
  {575.8, 0.95527},
  {591.8, 0.61793},
  {607.8, 0.53945},
  {624.4, 0.52953},
  {640, 0.51923},
  {655.4, 0.49664},
  {671.8, 0.46236},
  {688.4, 0.43002},
  {704, 0.40052},
  {719.8, 0.3778}
};

const static spectra_entry real_dufay_green[] = {
  {399.8, 1.6847},
  {415, 1.8519},
  {431.4, 2.1937},
  {448.6, 2.3151},
  {465, 2.0288},
  {479.6, 1.3976},
  {495, 0.89105},
  {511.6, 0.67346},
  {528, 0.68622},
  {544.6, 0.75878},
  {559.8, 0.8529},
  {575.8, 1.0047},
  {591.8, 1.2232},
  {607.8, 1.4468},
  {624.4, 1.5554},
  {640, 1.6181},
  {655.4, 1.6121},
  {671.8, 1.4628},
  {688.4, 1.1606},
  {704, 0.77729},
  {719.8, 0.53417}
};

const static spectra_entry real_dufay_blue[] = {
  {399.8, 1.0481},
  {415, 0.97954},
  {431.4, 1.0399},
  {448.6, 1.1047},
  {465, 1.0588},
  {479.6, 0.94428},
  {495, 0.88739},
  {511.6, 0.9773},
  {528, 1.2357},
  {544.6, 1.5597},
  {559.8, 1.792},
  {575.8, 1.869},
  {591.8, 1.8027},
  {607.8, 1.7517},
  {624.4, 1.7054},
  {640, 1.6319},
  {655.4, 1.4618},
  {671.8, 1.1179},
  {688.4, 0.8054},
  {704, 0.59388},
  {719.8, 0.474}
};

/* Dufay_measuredODs_DC_MSI_NSMM11951.xlsx
   NSMM, Bradford  - 11951 */
const static spectra_entry real_dufay_red2[] = {
  {399.8, 1.8533},
  {415, 1.968},
  {431.4, 2.152},
  {448.6, 2.1629},
  {465, 1.9818},
  {479.6, 1.8919},
  {495, 1.8868},
  {511.6, 1.8915},
  {528, 1.9458},
  {544.6, 2.0081},
  {559.8, 1.8989},
  {575.8, 1.2803},
  {591.8, 0.90078},
  {607.8, 0.81549},
  {624.4, 0.8354},
  {640, 0.84269},
  {655.4, 0.7865},
  {671.8, 0.70112},
  {688.4, 0.64347},
  {704, 0.61199},
  {719.8, 0.61987}
};

const static spectra_entry real_dufay_green2[] = {
  {399.8, 1.4331},
  {415, 1.513},
  {431.4, 1.6304},
  {448.6, 1.5451},
  {465, 1.2448},
  {479.6, 0.95866},
  {495, 0.77296},
  {511.6, 0.70791},
  {528, 0.72691},
  {544.6, 0.77999},
  {559.8, 0.85564},
  {575.8, 0.98678},
  {591.8, 1.1519},
  {607.8, 1.2991},
  {624.4, 1.4954},
  {640, 1.6041},
  {655.4, 1.4168},
  {671.8, 0.9952},
  {688.4, 0.69584},
  {704, 0.55954},
  {719.8, 0.52881}
};

const static spectra_entry real_dufay_blue2[] = {
  {399.8, 1.0851 },
  {415  , 1.0968 },
  {431.4, 1.1751 },
  {448.6, 1.221  },
  {465  , 1.1737 },
  {479.6, 1.1266 },
  {495  , 1.0915 },
  {511.6, 1.151  },
  {528  , 1.323  },
  {544.6, 1.5472 },
  {559.8, 1.7401 },
  {575.8, 1.8799 },
  {591.8, 1.9253 },
  {607.8, 1.9434 },
  {624.4, 1.9692 },
  {640  , 1.9159 },
  {655.4, 1.6896 },
  {671.8, 1.2867 },
  {688.4, 0.95971},
  {704  , 0.75514},
  {719.8, 0.66195}
};



/* Dufay_measuredODs_DC_MSI_NSMM11960.xlsx
   NSMM, Bradford  - 11960 */
const static spectra_entry real_dufay_red3[] = {
  {399.8, 1.7223 },
  {415  , 1.8139 },
  {431.4, 1.978  },
  {448.6, 1.9971 },
  {465  , 1.877  },
  {479.6, 1.7589 },
  {495  , 1.7396 },
  {511.6, 1.7447 },
  {528  , 1.797  },
  {544.6, 1.8695 },
  {559.8, 1.8032 },
  {575.8, 1.2207 },
  {591.8, 0.83176},
  {607.8, 0.74176},
  {624.4, 0.75947},
  {640  , 0.76662},
  {655.4, 0.70403},
  {671.8, 0.60837},
  {688.4, 0.54681},
  {704  , 0.5134 },
  {719.8, 0.47837}
};

const static spectra_entry real_dufay_green3[] = {
  {399.8, 1.3607 },
  {415  , 1.4427 },
  {431.4, 1.5687 },
  {448.6, 1.5079 },
  {465  , 1.2667 },
  {479.6, 0.95143},
  {495  , 0.77167},
  {511.6, 0.71681},
  {528  , 0.73318},
  {544.6, 0.78763},
  {559.8, 0.86442},
  {575.8, 0.99519},
  {591.8, 1.1528 },
  {607.8, 1.2903 },
  {624.4, 1.4726 },
  {640  , 1.5766 },
  {655.4, 1.3989 },
  {671.8, 0.98751},
  {688.4, 0.68867},
  {704  , 0.54908},
  {719.8, 0.47378}
};

const static spectra_entry real_dufay_blue3[] = {
  {399.8, 1.0618 },
  {415  , 1.0929 },
  {431.4, 1.1928 },
  {448.6, 1.2557 },
  {465  , 1.2389 },
  {479.6, 1.1284 },
  {495  , 1.0716 },
  {511.6, 1.1087 },
  {528  , 1.2352 },
  {544.6, 1.417  },
  {559.8, 1.589  },
  {575.8, 1.7311 },
  {591.8, 1.7831 },
  {607.8, 1.8115 },
  {624.4, 1.8573 },
  {640  , 1.8365 },
  {655.4, 1.6414 },
  {671.8, 1.2555 },
  {688.4, 0.93111},
  {704  , 0.7315 },
  {719.8, 0.60242}
};

/* Dufay_measuredODs_DC_MSI_NSMM11967.xlsx
   NSMM, Bradford  - 11960 (probably Spicer Dufay) */
const static spectra_entry real_dufay_red4[] = {
  {399.8, 1.4999 },
  {415  , 1.5488 },
  {431.4, 1.6861 },
  {448.6, 1.6924 },
  {465  , 1.5851 },
  {479.6, 1.5783 },
  {495  , 1.7847 },
  {511.6, 2.0285 },
  {528  , 2.243  },
  {544.6, 2.157  },
  {559.8, 1.5352 },
  {575.8, 1.0201 },
  {591.8, 0.82265},
  {607.8, 0.78033},
  {624.4, 0.83171},
  {640  , 0.88678},
  {655.4, 0.81072},
  {671.8, 0.62652},
  {688.4, 0.46347},
  {704  , 0.37381},
  {719.8, 0.33736}
};

const static spectra_entry real_dufay_green4[] = {
  {399.8, 1.589  },
  {415  , 1.7027 },
  {431.4, 1.8468 },
  {448.6, 1.7037 },
  {465  , 1.3414 },
  {479.6, 0.95984},
  {495  , 0.74934},
  {511.6, 0.69904},
  {528  , 0.75442},
  {544.6, 0.79839},
  {559.8, 0.85828},
  {575.8, 0.99681},
  {591.8, 1.2175 },
  {607.8, 1.4319 },
  {624.4, 1.7052 },
  {640  , 1.8639 },
  {655.4, 1.6296 },
  {671.8, 1.0919 },
  {688.4, 0.67033},
  {704  , 0.45825},
  {719.8, 0.38017}
};

const static spectra_entry real_dufay_blue4[] = {
  {399.8, 1.2124 },
  {415  , 1.2054 },
  {431.4, 1.2408 },
  {448.6, 1.1804 },
  {465  , 1.0732 },
  {479.6, 1      },
  {495  , 1.0586 },
  {511.6, 1.3329 },
  {528  , 1.7472 },
  {544.6, 2.0362 },
  {559.8, 2.0575 },
  {575.8, 2.0652 },
  {591.8, 2.0709 },
  {607.8, 2.0721 },
  {624.4, 2.0752 },
  {640  , 1.9618 },
  {655.4, 1.5912 },
  {671.8, 1.0474 },
  {688.4, 0.67086},
  {704  , 0.46989},
  {719.8, 0.37775}
};

/* Dufay_measuredODs_DC_MSI_NSMM12075.xlsx
   Spicer-Dufay NSMM, Bradford  - 12075 (probably Spicer Dufay) */
const static spectra_entry real_dufay_red5[] = {
  {399.8, 0.73443 },
  {415  , 0.72961 },
  {431.4, 0.79942 },
  {448.6, 0.86928 },
  {465  , 0.90753 },
  {479.6, 1.0464  },
  {495  , 1.2993  },
  {511.6, 1.5107  },
  {528  , 1.6803  },
  {544.6, 1.5851  },
  {559.8, 1.0156  },
  {575.8, 0.51808 },
  {591.8, 0.33356 },
  {607.8, 0.29447 },
  {624.4, 0.31872 },
  {640  , 0.33544 },
  {655.4, 0.29066 },
  {671.8, 0.19609 },
  {688.4, 0.11962 },
  {704  , 0.078058},
  {719.8, 0.063112}
};

const static spectra_entry real_dufay_green5[] = {
  {399.8, 0.742   },
  {415  , 0.80711 },
  {431.4, 0.88456 },
  {448.6, 0.81187 },
  {465  , 0.60816 },
  {479.6, 0.40745 },
  {495  , 0.30496 },
  {511.6, 0.29288 },
  {528  , 0.33324 },
  {544.6, 0.36014 },
  {559.8, 0.38578 },
  {575.8, 0.48257 },
  {591.8, 0.63152 },
  {607.8, 0.79237 },
  {624.4, 1.0142  },
  {640  , 1.1369  },
  {655.4, 0.95171 },
  {671.8, 0.55545 },
  {688.4, 0.26571 },
  {704  , 0.12767 },
  {719.8, 0.079921}
};


const static spectra_entry real_dufay_blue5[] = {
  {399.8, 0.54229 },
  {415  , 0.52097 },
  {431.4, 0.56026 },
  {448.6, 0.58749 },
  {465  , 0.57181 },
  {479.6, 0.5746  },
  {495  , 0.65477 },
  {511.6, 0.88583 },
  {528  , 1.2167  },
  {544.6, 1.4602  },
  {559.8, 1.5044  },
  {575.8, 1.4776  },
  {591.8, 1.4719  },
  {607.8, 1.4672  },
  {624.4, 1.4474  },
  {640  , 1.3245  },
  {655.4, 1.0359  },
  {671.8, 0.63761 },
  {688.4, 0.3646  },
  {704  , 0.21458 },
  {719.8, 0.14175 }
};

/* Chart from Dufaycolor manual called "Transmission of Dufaycolor Reseau"  */
const static spectra_entry manual_dufay_red[] = {
  {399.5091807909605, 0},
  {569.7132768361582, 0},
  {572.970338983051, 0.129613559322034},
  {578.2210451977402, 0.26511779661016965},
  {583.4795197740114, 0.3830686440677966},
  {591.5275423728815, 0.49775677966101695},
  {599.5833333333334, 0.5948915254237288},
  {607.917372881356, 0.6632957627118643},
  {615.1942090395481, 0.7205567796610168},
  {623.1419491525425, 0.7618432203389829},
  {633.7478813559322, 0.7966788135593219},
  {646.2266949152543, 0.7995516949152541},
  {659.9081920903955, 0.7848406779661017},
  {668.2810734463278, 0.7654779661016948},
  {680.3792372881356, 0.7284669491525423},
  {688.2238700564972, 0.7027347457627118},
  {700.0614406779662, 0.6545601694915253}
};

const static spectra_entry manual_dufay_green[] = {
  {400, 0},
  {466.8912429378532, 0},
  {472.81214689265545, 0.24706440677966102},
  {479.6610169491526, 0.37135762711864406},
  {486.781779661017, 0.4812822033898305},
  {494.30790960451986, 0.5752389830508475},
  {501.84039548022605, 0.6548338983050848},
  {508.983757062147, 0.7136940677966102},
  {515.7316384180791, 0.7661813559322033},
  {523.2810734463277, 0.8074779661016949},
  {530.8453389830509, 0.8152635593220339},
  {538.8185028248588, 0.7991025423728813},
  {546.6638418079096, 0.7717745762711864},
  {553.9844632768362, 0.7300983050847457},
  {560.3742937853108, 0.6916372881355932},
  {567.5649717514125, 0.6435813559322033},
  {572.7620056497176, 0.6003635593220339},
  {578.7570621468927, 0.5539338983050848},
  {586.0833333333334, 0.4994915254237289},
  {592.7478813559322, 0.4402788135593221},
  {600.0833333333334, 0.3650915254237288},
  {608.3559322033899, 0.2723271186440679},
  {613.9597457627119, 0.20995000000000008},
  {620.3679378531074, 0.12999915254237315},
  {627.0437853107345, 0.04525423728813571},
  {631.5854519774011, -0.017095762711864193},
  {700.8891242937854, -0.015673728813559107}
};

const static spectra_entry manual_dufay_blue[] = {
  {399.4329096045198, 0.7547889830508474},
  {409.1165254237289, 0.7736906779661016},
  {418.2718926553673, 0.7862228813559321},
  {426.7655367231639, 0.7939847457627118},
  {433.93432203389835, 0.7953974576271186},
  {442.83050847457633, 0.7935745762711864},
  {451.8622881355933, 0.7853652542372881},
  {460.23305084745766, 0.7707898305084745},
  {467.5430790960453, 0.7530499999999999},
  {474.85451977401135, 0.7321186440677966},
  {482.03531073446334, 0.7064033898305085},
  {489.61864406779665, 0.6711033898305085},
  {496.6723163841808, 0.6326254237288136},
  {503.7309322033899, 0.5829771186440678},
  {509.99788135593224, 0.5221788135593222},
  {514.9343220338983, 0.46779745762711866},
  {520.2740112994351, 0.4022355932203392},
  {524.9526836158193, 0.33030762711864425},
  {530.1737288135594, 0.2328338983050846},
  {534.4639830508476, 0.1385754237288137},
  {536.75, 0.07309152542372899},
  {538.7803672316385, 0},
  {701.1546610169491, 0}
};

/* Old readout from deformed scan.  */
#if 0
/* Chart from Color Cinematography, third edition (1951)  */
const static spectra_entry color_cinematography_dufay_red[] = {
  {399.8642759485018, 0},
  {431.38230602711633,0},
  {453.6759428050587, 0},
  {460.2329953287, 0.1418836162697943},
  {467.39375640879575, 1.2570140708670436},
  {477.50427253047735, 1.2085920587900176},
  {487.89720291671415, 0.4404266833769981},
  {495.9141791044776, 0},
  {531.0036174091375, 0},
  {557.4753617409137, 0},
  {569.4358835593027, 2.9234789791500475},
  {575.5028768371881, 8.641548934715729},
  {578.9115016520451, 15.234419505525807},
  {581.4609205879002, 23.411864817135694},
  {584.0163210664236, 31.876637803349666},
  {586.5687307736129, 40.197746952261596},
  {589.400563974023, 47.6554489005355},
  {591.3014127834113, 53.24979349436026},
  {594.0824028711404, 58.26521020849948},
  {598.4040674490145, 65.85945510994645},
  {603.2576620713228, 70.43391107439899},
  {611.3733337131139, 74.56170958186169},
  {624.4306141050472, 73.20607126580836},
  {632.4057194941324, 70.5816694200752},
  {639.8369317534465, 70.40240116212829},
  {651.4851315939387, 72.78914350005697},
  {663.4217272416543, 74.74347014925374},
  {680.1072405149823, 76.24401845733166},
  {703.9086532983936, 76.70473966047625},
  {721.4473909080551, 76.3333855531503}
};

const static spectra_entry color_cinematography_dufay_green[] = {
  {399.2635581633816, 0},
  {439.7026318787741, 0},
  {473.3052295773043, 0},
  {480.49290759940754, 1.9126694770422716},
  {485.6408795716076, 6.342037427366975},
  {488.4128973453344, 10.926462629600096},
  {492.44616611598497, 18.95312321977896},
  {496.18804830807795, 27.26853566138773},
  {499.33220348638486, 35.44313261934603},
  {503.7286373476131, 46.628973453343974},
  {507.4406118263644, 53.50774752193233},
  {510.85521818388975, 60.38794576734648},
  {516.0390794120998, 66.54127976529566},
  {523.5899225247807, 72.10856499943034},
  {530.4921955109946, 75.09274951577989},
  {541.1436139911132, 72.45553007861457},
  {545.811780790703, 68.12282813034065},
  {551.9488435684175, 62.921022274125555},
  {559.2305172610231, 55.558562151076686},
  {565.0522672895066, 49.49619744787513},
  {569.3961490258631, 43.87194514070866},
  {573.7250769055486, 37.52937364703202},
  {578.3663267631309, 31.903697163039766},
  {585.3625954198474, 25.11731656602484},
  {590.292241084653, 19.059224393300667},
  {599.0906630967302, 13.126281759143225},
  {607.324256579697, 8.632825851657728},
  {615.5877577760054, 5.5760083171926595},
  {628.9065170331548, 2.494979776689064},
  {628.9065170331548, 2.494979776689064},
  {640.7653526261821, 0.7140466560328207},
  {652.0444058334283, 0},
  {667.8079070297367, 0},
  {682.7032300330409, 0.9442292355018793},
  {694.6577703087615, 3.760538908510881},
  {703.6894724849037, 9.033375583912502},
  {713.3159109034978, 14.303363905662536},
  {720.2002392617067, 16.425565398199836}
};

const static spectra_entry color_cinematography_dufay_blue[] = {
  {399.8057422809616, 83.1899068588356},
  {419.4320382818731, 83.09591118833315},
  {436.6524723709696, 81.7203343967187},
  {451.74646804147204, 78.19976928335421},
  {461.4728836732369, 73.98652016634385},
  {470.56867380653983, 68.0521533553606},
  {476.7087273555885, 62.99401133644754},
  {483.99339181952837, 55.775215050700695},
  {490.0915745698986, 48.70577930955908},
  {496.50207929816565, 42.353238578101866},
  {502.87370399908855, 34.133067961718126},
  {508.0797823857811, 27.067904751053902},
  {512.9914834225817, 20.1478295545175},
  {519.966816679959, 12.355802096388288},
  {528.1555485929133, 5.707388629372204},
  {535.2265865329839, 2.51260396490828},
  {545.5866184345448, 0.16413637917283097},
  {558.9622023470434, 0},
  {577.3960350917171, 0},
  {594.3490087729292, 0},
  {616.0479093084198, 0},
  {628.5523242565797, 0},
  {644.6520736014584, 1.7011792184117667},
  {653.8974023014698, 2.950004272530464},
  {661.1000341802438, 6.076428449356271},
  {667.4404694086818, 10.643763529679859},
  {672.627321408226, 16.940761364931063},
  {677.5377406858836, 24.24483023812236},
  {681.8235160077475, 30.11510909194486},
  {685.5534351145038, 37.85586618434546},
  {688.9710322433634, 44.87972826706164},
  {692.0852797083286, 51.617686851999544},
  {695.5148399225247, 59.2162042839239},
  {700.1278910789564, 66.52169733394098},
  {702.3290987809046, 72.258281588242},
  {707.5279138657855, 79.12993477270138},
  {712.4114162014355, 85.14102911017433},
  {716.9945596445255, 91.00988378717102},
  {721.2205195397061, 94.00688589495272},
};
#else
/* Chart from Color Cinematography, third edition (1951)  */
const static spectra_entry color_cinematography_dufay_red[] = {
  {400.2745059092264,  0},
  {406.1070612771874,  0},
  {412.48942298142816, 0},
  {418.43162180951435, 0},
  {424.37382063760055, 0},
  {429.87585658953225, 0},
  {435.3786870592909,  0},
  {440.22047869699077, 0},
  {444.6221074585361,  0},
  {449.464693614063,   0},
  {453.8663223756083,  0},
  {458.26715661932667, 0},
  {461.783692521601, 0.5470751812494115},
  {465.74078855894334, 1.1454215910220285},
  {470.1412255437482, 1.3108550998113486},
  {473.8818154732347, 1.4216903366769458},
  {477.1834343033072, 1.369773562419354},
  {482.4665805939021, 1.210894825702681},
  {486.8701956500149, 0.9431174893236687},
  {490.6139636508094, 0.6207418810210044},
  {494.360115205085,  0},
  {498.76214122554376,0},
  {503.60433012215714,0},
  {508.0059588837025, 0},
  {512.4071903863344, 0},
  {516.1485748336479, 0},
  {522.090773661734,  0},
  {526.4931969411064, 0},
  {530.0137054325156, 0},
  {535.296454464197,  0},
  {539.2575230906743, 0},
  {545.4198033568379, 0},
  {551.1411262290198, 0},
  {556.4226834839607, 0},
  {561.9207468467574, 0.6148574833648439},
  {566.0947462508691, 1.6465637103983255},
  {569.6057205283544, 3.0568825106764024},
  {572.4536696792135, 4.845813884199046},
  {574.415334194061, 7.446419704042171},
  {576.1565200119177, 10.101027907438691},
  {577.6752408382163, 13.080395272618944},
  {578.9734829675241, 16.11376502135269},
  {580.0516436587545, 19.14698579799385},
  {581.0229417022545, 21.746921243420417},
  {581.9894726387922, 24.99667295659947},
  {582.7391002085609, 27.81306485251764},
  {583.7040421094449, 31.279421988280873},
  {584.3436289601748, 34.09573939815276},
  {585.0916674942894, 37.1287367166551},
  {585.8436786175389, 39.62022047869699},
  {586.8117985897309, 42.65336676929189},
  {587.7783295262687, 45.90311848247096},
  {588.9649419008839, 49.153019167742585},
  {590.15393782898, 52.07801171913795},
  {591.3437282749032, 54.89470155924125},
  {592.9720925613268, 57.92829476611382},
  {594.3819644453273, 60.74513357830967},
  {596.0103287317509, 63.77872678518224},
  {597.9704042109444, 66.59593802760949},
  {600.1529446816962, 69.08839010825307},
  {602.9941404310259, 71.79789452775847},
  {606.2778826099911, 74.18278875757275},
  {610.0089383255536, 75.59325652994339},
  {614.408978051445, 75.81284139437881},
  {618.596881517529, 74.94925017380078},
  {622.1261297050353, 73.86860661436091},
  {625.2144204985599, 72.89596782202801},
  {628.7424769093257, 71.97777832952629},
  {632.0484655874466, 71.3301966431622},
  {636.2312046876552, 71.17057304598272},
  {640.8469560035753, 71.98597179461714},
  {645.6815969808322, 72.96397358228225},
  {649.6378985003475, 73.67062270334691},
  {654.0335683781905, 74.48587247988877},
  {657.9906644155328, 75.08421888966134},
  {661.9485549707022, 75.57426258814182},
  {666.7859767603536, 76.17320488628465},
  {671.624987585659, 76.55554176184327},
  {675.1439070414142, 76.88283344920052},
  {679.544344026219, 77.04826695798987},
  {685.2648723805739, 77.26874565498063},
  {689.8857880623696, 77.38017678021652},
  {694.5071010030788, 77.43745654980634},
  {698.028404012315, 77.43984010328731},
  {702.6497169530242, 77.49711987287714},
  {706.8312642764922, 77.49995034263583},
  {711.233290296951, 77.448778428841},
  {715.6353163174099, 77.39760651504619},
  {720.1477803158209, 77.2923577316516},
};

/* Charts published in book are ambigous on what represent green and blue sensitivity.
   consider both posibilities.  */
#define MORE_RED_IN_BLUE
const static spectra_entry color_cinematography_dufay_green[] = {
  {400, 0},
  {440, 0},
  {461.3482967524084, 0},
  {467.2916873572351, 0},
  {471.14271526467377, 0},
  {474.11341741980334, 0},
  {478.5051147085113, 1.208213328036578},
  {481.13576323368756, 2.6179362399443846},
  {483.43470056609397, 4.244041116297552},
  {485.2902969510378, 6.303058893633931},
  {486.81338762538485, 8.68676134670774},
  {488.55338166650114, 11.503823617042414},
  {489.8532128314629, 14.320587943191995},
  {491.5900288012713, 17.570861058695016},
  {492.9975171317907, 20.71260800476712},
  {494.29496474327146, 23.854280464792936},
  {495.59161783692525, 27.10425563611085},
  {496.7782302115404, 30.35415632138249},
  {497.85559638494385, 33.49567980931573},
  {499.1530439964247, 36.63735226934155},
  {500.7758466580594, 40.429064455258725},
  {502.0717052338862, 43.78734233786871},
  {503.369947363194, 46.820712086602455},
  {504.5589432912901, 49.74570463799782},
  {506.29496474327146, 53.104280464792936},
  {508.14182143211843, 56.354628066342244},
  {510.20717052338864, 59.82173006256828},
  {512.1656569669282, 62.8555467275797},
  {514.1273214817758, 65.45615254742279},
  {516.6391895918165, 68.05713079749728},
  {519.2634819743769, 70.33327539974178},
  {522.216307478399, 72.82624888270931},
  {524.9562022047869, 74.34434899195551},
  {528.7984904161287, 75.5924371834343},
  {532.9796404806833, 75.64941900883902},
  {536.2860264177177, 74.94768596682889},
  {539.5983712384547, 73.43368259012811},
  {542.2520607806138, 71.70262687456551},
  {544.9085311351673, 69.59251166948059},
  {547.7870692223657, 67.21178865825803},
  {550.0029794418513, 65.15552686463403},
  {552.2188896613368, 63.09926507101004},
  {554.2131294070911, 61.25945972787763},
  {556.4302314033171, 59.04074386731552},
  {558.6477306584566, 56.76787665110736},
  {560.8660244314232, 54.38670672360712},
  {562.864634025226, 51.95123646836827},
  {565.0829277981925, 49.57006654086801},
  {567.4144403615055, 46.755760254245715},
  {569.5242824510875, 44.15791041811502},
  {571.6357135763234, 41.343455159400136},
  {573.9696096931175, 38.20424073890159},
  {576.3011222564306, 35.38993445227928},
  {578.7442645744364, 32.35909722911909},
  {581.2966530936537, 29.436637203297252},
  {584.1815473234681, 26.189492501738016},
  {587.0640579998014, 23.26725593405503},
  {589.9441851226536, 20.669927500248306},
  {592.7134770086403, 18.180827291687365},
  {595.5904260601848, 16.01670970304899},
  {598.9083325057106, 13.744587347303622},
  {602.665607309564, 11.581065647035459},
  {606.0895818849935, 9.850531333796823},
  {609.4027212235575, 8.22822524580397},
  {612.9339557056312, 6.876824908133884},
  {616.6848743668686, 5.579724898202429},
  {621.0956400834244, 4.337223160194711},
  {625.5052140232397, 3.257175489125075},
  {631.6758367265866, 2.124168239149924},
  {637.8440758764525, 1.3160691230509656},
  {643.1284139437878, 0.9947363193961962},
#ifdef MORE_RED_IN_BLUE
  {649.0733935842685, 0.6196990763730668},
  {654.1380474724401, 0.24406594497969536},
  {659.8605621213626, 0.19378786374022638},
  {664.702751017976, 0.1429138941305581},
  {669.9847055318304, 0.14648922435202394},
  {675.2634819743768, 0.5832753997418223},
  {680.5402721223558, 1.2908183533618427},
  {685.8158704935942, 2.160815373919988},
  {690.2095540768696, 3.2468219286920714},
  {694.1622802661634, 4.440833250571075},
  {698.5504022246499, 6.284958784387769},
  {701.6184328135862, 8.074039130002987},
  {704.9025722514648, 10.404782004171224},
  {708.190287019565, 12.248162677525087},
  {711.9181646638197, 14.091841295064057},
  {715.6472340848147, 15.773065845664917},
  {720, 17.021228523189976},
#else
  {647.0807428741682, 2.2428989969212836},
  {651.4764127520111, 3.0581487734631594},
  {655.8681100407192, 4.414912106465451},
  {659.5971794617142, 6.096136657066253},
  {663.2126328334491, 8.264648922435214},
  {666.3855397755486, 10.757771377495288},
  {669.007448604628, 13.358824113616066},
  {670.97189393187, 15.580370443936829},
  {672.7154633032078, 17.91007051345717},
  {674.3485946965934, 20.293847452577225},
  {675.980931572152, 22.78592710298939},
  {677.6116794120567, 25.494612175985722},
  {679.1347700864037, 27.878314629059503},
  {680.5462310060582, 30.47854801867119},
  {682.1730062568279, 33.728746648127924},
  {683.364385738405, 36.32883106564705},
  {684.6642169033668, 39.145595391796604},
  {686.0724997517132, 42.17903962657664},
  {687.2630847154633, 44.887426755387835},
  {688.3452179958288, 47.37913397556858},
  {689.5350084417519, 50.19582381567187},
  {691.053332009137, 53.22934253649817},
  {692.3539576919258, 55.93780415135565},
  {693.9799384248684, 59.29630549210449},
  {695.7183434303306, 62.32997318502334},
  {697.2366669977157, 65.36349190584964},
  {698.8666203197934, 68.18047969013804},
  {700.496573641871, 70.99746747442646},
  {702.4542655675835, 74.13958685072997},
  {704.0866024431423, 76.63166650114212},
  {706.0450888866819, 79.66548316615354},
  {708.1144105670869, 82.59107160591915},
  {710.2945674843579, 85.40843182043898},
  {712.694011321879, 88.33424371834343},
  {714.5480186711688, 90.60986691826398},
  {716.8421888966134, 92.88578806236964},
  {719.4640977256927, 95.48684079849042},
  {720, 95.81219584864435},
#endif
};

const static spectra_entry color_cinematography_dufay_blue[] = {
  {400, 83.24908133876255},
  {404.39566987784286, 83.25191180852121},
  {409.23785877445624, 83.20103783891152},
  {414.0800476710696, 83.15016386930182},
  {418.0423080742874, 83.04454265567584},
  {422.6652100506505, 82.8852170026815},
  {428.1692322971497, 82.61818452676533},
  {433.4547621412255, 82.13439765617242},
  {438.7414837620419, 81.48815671864139},
  {443.811302016089, 80.40855596384944},
  {447.7799185619227, 79.43651305988678},
  {452.41195749329626, 78.03170622703348},
  {455.9431919753699, 76.68030588936338},
  {459.47561823418414, 75.16645148475519},
  {463.0096335286523, 73.43599165756282},
  {465.6625285529844, 71.81323865329227},
  {468.31701261297053, 69.97388022643759},
  {470.75141523487935, 68.13437282749032},
  {472.9669281954514, 66.13226238951236},
  {475.40291985301417, 64.07614956798093},
  {477.8408978051445, 61.74927996821929},
  {480.72062766908334, 59.20610289005862},
  {483.1597973979541, 56.71677922335883},
  {485.1556261793624, 54.660368457642285},
  {487.1514549607707, 52.603957691925714},
  {489.14847551891944, 50.385092859271026},
  {491.367563809713, 47.895620220478705},
  {493.144105670871, 45.73075777137751},
  {494.8090177773364, 43.7824262588142},
  {496.5855596384944, 41.61756380971299},
  {498.36130698182546, 39.56100407190387},
  {500.02780812394474, 37.396067136756386},
  {501.6935147482372, 35.33943291290099},
  {503.5808918462608, 33.06634223855397},
  {505.24818750620716, 30.793102592114423},
  {507.0255238851922, 28.519937431721146},
  {508.5827788260999, 26.246623299235296},
  {510.02800675340154, 24.243991458933365},
  {511.69291885986695, 22.295659946370066},
  {513.1373522693416, 20.401330817360233},
  {514.914291389413, 18.182317012612984},
  {516.578806236965, 16.28813685569571},
  {518.7971000099315, 13.906966928195473},
  {520.7921342735127, 11.958858873770993},
  {523.3397556857682, 9.686215115701671},
  {525.6641175886384, 7.846633230708136},
  {528.3178071307975, 6.115577515145503},
  {531.3016188300725, 4.3847452577217325},
  {534.8332505710597, 2.9791935644056338},
  {539.68417916377, 1.7369897705830226},
  {544.0913695501042, 0.9818502333896504},
  {548.7182441156024, 0.281011023934866},
  {554.222663621015, 0},
  {559.0644552587148, 0},
  {564.5672857284735, 0},
  {570.3990465786076, 0},
  {575.3504816764325, 0},
  {580.6324361902871, 0},
  {585.3637898500348, 0},
  {590.3164167246002, 0},
  {595.5983712384547, 0},
  {600.6610388320588, 0},
  {605.2827490316814, 0},
  {609.6839805343132, 0},
  {614.5261694309266, 0},
  {619.1478796305491, 0},
  {623.7664117588639, 0.2776591518522764},
  {628.3873274406594, 0.3890902770881297},
  {633.6665011421194, 0.7717250968319149},
  {637.8456649121065, 1.0994637004668277},
  {642.6838812195849, 1.5901032873175467},
#ifdef MORE_RED_IN_BLUE
  {647.0807428741682, 2.2428989969212836},
  {651.4764127520111, 3.0581487734631594},
  {655.8681100407192, 4.414912106465451},
  {659.5971794617142, 6.096136657066253},
  {663.2126328334491, 8.264648922435214},
  {666.3855397755486, 10.757771377495288},
  {669.007448604628, 13.358824113616066},
  {670.97189393187, 15.580370443936829},
  {672.7154633032078, 17.91007051345717},
  {674.3485946965934, 20.293847452577225},
  {675.980931572152, 22.78592710298939},
  {677.6116794120567, 25.494612175985722},
  {679.1347700864037, 27.878314629059503},
  {680.5462310060582, 30.47854801867119},
  {682.1730062568279, 33.728746648127924},
  {683.364385738405, 36.32883106564705},
  {684.6642169033668, 39.145595391796604},
  {686.0724997517132, 42.17903962657664},
  {687.2630847154633, 44.887426755387835},
  {688.3452179958288, 47.37913397556858},
  {689.5350084417519, 50.19582381567187},
  {691.053332009137, 53.22934253649817},
  {692.3539576919258, 55.93780415135565},
  {693.9799384248684, 59.29630549210449},
  {695.7183434303306, 62.32997318502334},
  {697.2366669977157, 65.36349190584964},
  {698.8666203197934, 68.18047969013804},
  {700.496573641871, 70.99746747442646},
  {702.4542655675835, 74.13958685072997},
  {704.0866024431423, 76.63166650114212},
  {706.0450888866819, 79.66548316615354},
  {708.1144105670869, 82.59107160591915},
  {710.2945674843579, 85.40843182043898},
  {712.694011321879, 88.33424371834343},
  {714.5480186711688, 90.60986691826398},
  {716.8421888966134, 92.88578806236964},
  {719.4640977256927, 95.48684079849042},
  {720, 95.81219584864435},
#else
  {649.0733935842685, 0.6196990763730668},
  {654.1380474724401, 0.24406594497969536},
  {659.8605621213626, 0.19378786374022638},
  {664.702751017976, 0.1429138941305581},
  {669.9847055318304, 0.14648922435202394},
  {675.2634819743768, 0.5832753997418223},
  {680.5402721223558, 1.2908183533618427},
  {685.8158704935942, 2.160815373919988},
  {690.2095540768696, 3.2468219286920714},
  {694.1622802661634, 4.440833250571075},
  {698.5504022246499, 6.284958784387769},
  {701.6184328135862, 8.074039130002987},
  {704.9025722514648, 10.404782004171224},
  {708.190287019565, 12.248162677525087},
  {711.9181646638197, 14.091841295064057},
  {715.6472340848147, 15.773065845664917},
  {720, 17.021228523189976},
#endif
};
#endif

/* The Photographic Journal, Volume 79, p. 325, May 1939.  */
const static spectra_entry harrison_horner_dufay_red[] = {
  {400.3263871453678, 0},
  {411.4235500878734, 0},
  {421.8679387396435, 0},
  {431.33316595531005, 0},
  {440.145618880241, 0},
  {449.6108460959076, 0},
  {463.98024939325467, 0.0896169832901137},
  {476.66750355678295, 1.7735096381845068},
  {480.25357770524727, 1.9567537032387747},
  {487.12444556029794, 1.3597720869250054},
  {496.2842078835049, 0.6172064607916923},
  {506.08419114570256, 0},
  {516.5285797974726, 0},
  {527.2993555946105, 0},
  {541.3340028454264, 0},
  {552.1131475437276, 0},
  {559.6116829860239, 0.7026389935001731},
  {566.4114151811867, 2.8295603537255687},
  {569.2945016319358, 4.931375010461139},
  {572.1566658297766, 7.834337601472939},
  {574.6338605741066, 12.978422183167368},
  {577.2533266382123, 18.924700811783424},
  {579.4125031383379, 23.74623399447654},
  {582.3332496443218, 30.655982369514888},
  {584.4673194409573, 36.43889307333947},
  {586.5972047870115, 42.382033364019314},
  {589.5305046447402, 48.811092978491935},
  {592.1457862582643, 54.91760119396325},
  {596.3888191480459, 61.1948001227439},
  {602.6110971629425, 66.68340446899323},
  {610.3355929366473, 70.8995871342093},
  {621.9871955812202, 74.74030253577706},
  {633.6848271821909, 76.81849248193713},
  {647.0353167629091, 78.10599562027505},
  {658.7727006444054, 78.6620044913103},
  {670.5100845259018, 79.21801336234553},
  {681.5988785672441, 79.60960819594388},
  {691.0536446564566, 80.07085669651576},
  {701.6423968532931, 80.85988715931599}
};

/* The Photographic Journal, Volume 79, p. 325, May 1939.  */
const static spectra_entry harrison_horner_dufay_green[] = {
  {400.08787346221436, 2.885178676039857},
  {408.1136496777973, 1.8148310876782148},
  {421.2047033224537, 0},
  {431.9775713448824, 0},
  {441.4469830111306, 0},
  {451.56707674282364, 0},
  {459.20579127960497, 1.661575585125675},
  {466.95120930621806, 5.076610316065526},
  {471.7361285463219, 9.354077747091821},
  {474.5501715624738, 14.099680586938945},
  {477.0399196585488, 18.76307640806762},
  {479.0275336848272, 23.904022651825827},
  {481.49217507741236, 29.528795994085982},
  {483.3333333333333, 34.027777777777786},
  {485.16612268809104, 38.84721873518009},
  {487.4717549585739, 44.31071637793959},
  {488.9823416185455, 48.96783552319582},
  {491.5767009791614, 55.87549167294336},
  {494.21290484559375, 61.18085195413843},
  {497.03322453761814, 65.68611041370269},
  {500.98334588668513, 70.67938042235056},
  {505.16988869361455, 72.86967877367701},
  {511.35659887856724, 73.47023460819595},
  {519.8845091639467, 71.9223365972048},
  {527.1361620219265, 69.24446257706364},
  {534.0739810862833, 66.08380757106593},
  {539.7146204703322, 62.59432449019445},
  {545.7025692526571, 58.30578570033755},
  {551.0335592936648, 54.17329204675427},
  {556.2097246631517, 49.71929310681509},
  {560.7205623901582, 45.74179847686},
  {565.7419030881244, 40.966294250564914},
  {569.7631600970792, 36.98566128267359},
  {574.119173152565, 32.686661366362614},
  {577.8119507908611, 28.784050966608092},
  {582.8437526152816, 23.607972773174893},
  {587.5177839149719, 19.631524255865216},
  {592.0076993890702, 16.4551775601864},
  {598.3136664155996, 12.48919016933084},
  {605.0924763578543, 9.167259463832409},
  {612.0156498451754, 6.567408011828078},
  {619.5769520461963, 4.532544564398705},
  {627.6236505146874, 2.6610490417608474},
  {636.6285881663738, 1.5969781292716476},
  {646.1168298602394, 0.7763899350015322},
  {656.8624989538873, 1.8068108907300484},
  {663.9802493932547, 4.256283649956771},
  {669.420035149385, 8.457820738137102},
  {674.1652021089631, 14.257469244288231},
  {677.6257427399783, 19.24760091499988},
  {681.3875638128713, 25.201202332133803},
  {684.3292325717634, 31.30980277289592},
  {686.9654364381956, 36.615163054091},
  {689.7690183278935, 41.76133986107626},
  {692.3884843919993, 47.70761848969232},
  {695.6858314503306, 52.69670404775854},
  {701.0670348983178, 59.14145535191231}
};

/* The Photographic Journal, Volume 79, p. 325, May 1939.  */
const static spectra_entry harrison_horner_dufay_blue[] = {
   {399.96233994476523, 32.69206628169721},
   {404.7033224537618, 38.65194437470362},
   {408.7957151226044, 44.44740843027312},
   {411.16829860239346, 47.347232683348686},
   {414.47819901246964, 51.855629480849174},
   {418.2693112394342, 56.68762378999639},
   {422.2152481379195, 61.84112338549949},
   {426.97296844924256, 67.1600831310849},
   {434.6556197171312, 72.97856166485342},
   {442.73997824085694, 75.91499986051832},
   {451.9081094652272, 74.85197506067456},
   {459.4777805674115, 72.4966524395347},
   {466.8926269980752, 69.81982453203895},
   {472.9998326219767, 67.21474251680755},
   {479.1237760482049, 63.96874215415517},
   {483.9338019917985, 61.03483206405},
   {488.25843166792197, 57.93755404915335},
   {493.27977236588833, 53.16204982285827},
   {497.3177671771697, 48.54049850754596},
   {500.38496945351073, 43.592211342650714},
   {503.2722403548414, 39.283796412531046},
   {506.172064607917, 34.49469272184564},
   {508.41074566909367, 30.021863754289072},
   {511.3314921750774, 24.431612129327434},
   {514.2355008787347, 19.482278851786788},
   {517.1269562306469, 15.01363433481184},
   {520.3196920244372, 11.50845956425924},
   {523.8346305130136, 8.165606605852659},
   {528.9773202778476, 4.993444360755433},
   {534.749769855218, 2.7067292939437095},
   {543.2818645911791, 0.9986016960973245},
   {553.0944012051218, 0},
   {564.3547577203113, 0},
   {575.6172064607917, 0},
   {585.0824336764583, 0},
   {594.2233659720479, 0},
   {606.6281697213155, 0},
   {617.3989455184535, 0.43204452255420733},
   {630.1092141601807, 1.2346744497447588},
   {638.2479705414679, 2.088128016291506},
   {646.6921918152148, 3.74482174240525},
   {653.4710017574694, 6.672891036906876},
   {660.0552347476776, 10.80163612017742},
   {665.9678634195329, 15.647229893714965},
   {670.8971462047032, 20.646776578235276},
   {674.6966273328312, 25.158311713672006},
   {678.4793706586324, 30.3107651965297},
   {682.4127542053728, 35.94495355259855},
   {686.0155661561637, 41.73727927023183},
   {689.30035986275, 47.20705358886379},
   {692.9115407147042, 52.67892013278657},
   {697.01230228471, 58.153925014645594},
   {700.8389823416186, 61.6239678355232}
};

#if 0
/* 400 to 700 10nm bands.  */
const static luminosity_t tartrazine_data[] = {
	3.515, 3.584, 3.673, 3.785, 3.928,
	4.118, 4.359, 4.646, 5.054, 5.549,
	6.432, 7.768, 10.596, 16.05, 24.013,
	35.13, 47.59, 60.385, 71.63, 78.625,
	83.134, 86.293, 88.246, 89.348, 89.914,
	90.363, 90.535, 90.377, 90.264, 90.521,
	91.021};

const static luminosity_t rose_data[] = {
	29.753, 26.88, 24.764, 23.653, 22.746,
	21.441, 19.339, 15.616, 11.697, 8.784,
	6.582, 5.012, 4.028, 3.697, 3.667,
	3.399, 3.505, 3.148, 6.065, 16.857,
	32.822, 52.956, 71.318, 80.17, 84.432,
	86.681, 87.525, 88.024, 88.278, 88.738,
	89.232};
const static luminosity_t erythrosine_data[] = {
	10.625, 9.864, 9.194, 8.754, 8.073,
	6.622, 5.085, 3.935, 3.081, 2.647,
	2.486, 2.461, 2.583, 2.825, 3.132,
	3.047, 3.891, 6.17, 11.901, 24.623,
	39.47, 52.566, 63.498, 70.147, 74.383,
	77.371, 79.456, 81.175, 82.621, 84.049,
	85.365};
#endif

const static spectra_entry erythrosine_paper_data[] = {
  {359.8422239231262, 50.473856392368035},
  {373.5502320384302, 59.331899741810304},
  {381.94932575051445, 64.13197356155366},
  {394.97156869134335, 67.10010832014967},
  {409.3029782984745, 66.6936853770068},
  {421.6514581320549, 66.68841388081316},
  {437.08729325868194, 66.73901083088596},
  {450.5333739068649, 65.53235593877778},
  {457.8000372759245, 63.07023774784003},
  {465.9444988950843, 59.57838925579285},
  {474.85673981476725, 55.11404384988136},
  {482.0023046788574, 50.016827085766295},
  {488.0130529065566, 44.57926370061829},
  {495.29155831527976, 38.56471999565969},
  {508.61029467684216, 34.276915114595695},
  {523.1964493375305, 29.32978161246774},
  {541.2839317700285, 26.43986456132194},
  {551.7811374474943, 30.964547889201157},
  {556.5681831409305, 36.809243986800965},
  {560.088149417139, 43.395617006718105},
  {562.6521298586326, 49.158913672379406},
  {565.8511749772817, 54.92193923252218},
  {568.4144776549791, 60.52053929567675},
  {572.5651031436671, 66.03611329378164},
  {578.62126154572, 71.63322227658429},
  {584.3493822703521, 74.67766947329196},
  {602.4599086719251, 77.38743690737485},
  {630.4051266400571, 77.9519463733331},
  {652.5694260838234, 78.0742420727418},
  {673.5277804047904, 78.36174947514243},
  {693.3470848896555, 79.63792448251677},
  {711.6458940738472, 81.8041117966719},
  {728.0317827192943, 82.09357115880594},
  {748.7561458672184, 81.07677906733997},
  {777.1049450655095, 80.94609536318796},
  {800.8812785882807, 80.81736361876938},
  {825.5721052461556, 80.68824148240411}
};

const static spectra_entry o2_erythrosine_paper_data[] = {
  {359.90331943440407, 34.284400337962296},
  {369.9861674373492, 39.97202060918125},
  {377.78229461260094, 45.54203530646206},
  {386.03713232520477, 51.467599469184066},
  {395.658829841131, 56.20676250593762},
  {407.1090256373319, 60.82656320499296},
  {420.83911040215935, 63.90382772471863},
  {435.0235137949387, 66.26940772564191},
  {451.4936620355446, 68.51543019289363},
  {468.8748874817212, 69.93099139156479},
  {488.0782673390388, 69.68563005307476},
  {504.9876065196628, 67.54393983357396},
  {522.3580961873056, 66.35070684853855},
  {536.0667093950653, 64.21038300085115},
  {548.8749811757884, 65.50931460545087},
  {558.4942387420481, 69.6555698731802},
  {567.6557617508222, 73.68343878307803},
  {581.8430930832017, 76.76050810683037},
  {600.1378356846154, 77.93851580594514},
  {623.0021160219492, 78.40308222249745},
  {643.5782115617895, 78.39429840369709},
  {663.2407899463926, 78.6230680844531},
  {682.448073723177, 79.32635917640182},
  {700.7442802943909, 80.86011153693113},
  {718.1279456902342, 82.8685805046265},
  {738.7011132904744, 82.14830736299707},
  {758.8165463332292, 81.30964786353616},
  {775.2759587953014, 80.94687614708134},
  {796.3088129127606, 80.8193155785028},
  {811.8556841994621, 80.93126046921404},
  {829.6887883239237, 81.04222938005856},
};

const static spectra_entry patent_paper_data[] = {
  {359.8745688303544, 53.535353535353536},
  {366.64785199121985, 53.468013468013474},
  {374.9263091878332, 52.5925925925926},
  {381.95045468799003, 50.841750841750844},
  {389.22546252743814, 49.42760942760943},
  {397.75478206334276, 48.21548821548822},
  {404.1517717152713, 46.5993265993266},
  {409.04358733145193, 44.91582491582493},
  {413.93540294763255, 43.87205387205387},
  {420.08153026026974, 46.06060606060606},
  {424.09532768893075, 48.8888888888889},
  {427.2311069300722, 52.121212121212125},
  {429.3634368140483, 54.545454545454554},
  {430.86861084979626, 56.63299663299664},
  {432.87550956412673, 59.86531986531987},
  {436.63844465349644, 63.63636363636364},
  {440.15051740357484, 66.93602693602693},
  {444.41517717152715, 69.83164983164984},
  {451.43932267168395, 72.65993265993266},
  {462.72812793979307, 74.14141414141415},
  {474.2677955471935, 74.68013468013469},
  {485.30573847601136, 74.27609427609428},
  {491.57729695829414, 73.1986531986532},
  {501.8626528692381, 71.04377104377105},
  {510.39197240514267, 69.0909090909091},
  {516.6635308874255, 67.47474747474747},
  {524.0639698965193, 65.25252525252526},
  {531.5898400752587, 62.76094276094277},
  {535.9799310128567, 60.67340067340068},
  {543.0040765130135, 57.17171717171718},
  {549.777359673879, 52.659932659932664},
  {554.543744120414, 49.831649831649834},
  {560.0627155848229, 46.936026936026934},
  {565.5816870492317, 43.50168350168351},
  {571.2260896832863, 40.06734006734007},
  {576.4941988084039, 36.96969696969697},
  {581.5114455942303, 34.478114478114485},
  {587.9084352461588, 31.919191919191924},
  {594.9325807463156, 30.00000000000003},
  {603.7127626215115, 28.417508417508415},
  {614.7507055503293, 26.666666666666686},
  {622.52743806836, 24.848484848484844},
  {633.3145186578865, 22.289562289562298},
  {643.3490122295391, 21.279461279461287},
  {656.3938538726875, 22.289562289562298},
  {666.0520539354029, 24.57912457912458},
  {673.7033552837881, 27.74410774410775},
  {677.7171527124492, 30.370370370370374},
  {681.73095014111, 34.612794612794616},
  {685.2430228911885, 38.85521885521886},
  {687.7516462841018, 42.89562289562291},
  {692.768893069928, 51.24579124579125},
  {698.0370021950455, 58.65319865319866},
  {702.5525243022892, 63.70370370370371},
  {707.8206334274067, 68.28282828282829},
  {713.0887425525243, 72.45791245791247},
  {721.1163374098464, 76.4983164983165},
  {736.4189401066166, 79.5959595959596},
  {760.2508623392914, 79.93265993265993},
  {779.0655377861399, 80.13468013468014},
  {800.1379742866102, 80.40404040404042},
  {820.2069614299153, 80.60606060606061},
  {829.7397303229852, 80.74074074074075},
};

const static spectra_entry o2_patent_paper_data[] = {
  {360.1254311696457, 43.23232323232324},
  {367.4004390090938, 45.52188552188553},
  {372.9194104735027, 46.73400673400675},
  {381.19786767011607, 47.40740740740741},
  {389.22546252743814, 47.27272727272728},
  {396.50047036688625, 47.27272727272728},
  {405.28065224208217, 46.26262626262626},
  {414.0608341172782, 44.91582491582493},
  {419.3289432423958, 46.464646464646464},
  {424.59705236751336, 49.0909090909091},
  {428.8617121354657, 53.872053872053876},
  {435.38413295703987, 57.64309764309765},
  {440.4013797428662, 60.67340067340068},
  {449.1815616180621, 63.77104377104377},
  {463.98243963624964, 65.11784511784512},
  {477.27814361868934, 65.993265993266},
  {489.82126058325497, 65.4882154882155},
  {499.1031671370336, 64.57912457912458},
  {509.3885230479775, 63.70370370370371},
  {518.670429601756, 62.76094276094277},
  {527.1997491376608, 61.54882154882155},
  {539.2411414236439, 58.92255892255893},
  {548.0213232988399, 55.622895622895626},
  {553.7911571025401, 52.5925925925926},
  {559.8118532455316, 50.235690235690235},
  {565.8325493885231, 47.07070707070708},
  {572.3549702100972, 43.70370370370371},
  {579.6299780495453, 40.33670033670034},
  {585.9015365318282, 37.710437710437716},
  {593.9291313891503, 35.42087542087542},
  {603.2110379429289, 33.939393939393945},
  {611.4894951395422, 32.659932659932664},
  {620.2696770147381, 31.313131313131315},
  {630.0533082470995, 29.42760942760944},
  {642.5964252116652, 28.55218855218856},
  {655.3904045155222, 28.888888888888893},
  {664.9231734085921, 30.437710437710443},
  {671.6964565694575, 33.40067340067341},
  {675.4593916588274, 36.430976430976436},
  {678.9714644089056, 39.73063973063974},
  {682.2326748196928, 43.83838383838384},
  {684.9419880840389, 47.43434343434344},
  {687.9523361555347, 51.47474747474748},
  {691.5647538413295, 56.08080808080809},
  {695.7792411414237, 61.8989898989899},
  {701.4989024772657, 67.7979797979798},
  {707.5195986202572, 72.96969696969697},
  {715.0454687989966, 77.0909090909091},
  {725.8827218563813, 80.56565656565657},
  {747.2561931640014, 81.13131313131314},
  {764.7162119786767, 80.8888888888889},
  {783.9824396362496, 81.16363636363637},
  {803.8507369081217, 81.16363636363637},
  {819.0228911884603, 81.16363636363637},
  {829.4989024772656, 81.35757575757576},
};

const static spectra_entry tartrazine_paper_data[] = {
  {361.75493575681605, 45.694294940796546},
  {369.52679410842995, 44.85468245425187},
  {378.05076778439366, 43.82131324004305},
  {386.3240363522407, 42.787944025834214},
  {394.59730492008777, 41.62540365984929},
  {402.6198683798183, 40.527448869752405},
  {410.64243183954875, 39.55866523143163},
  {419.6678157317456, 38.91280947255112},
  {435.9636477593231, 38.78363832077502},
  {446.99467251645257, 39.55866523143163},
  {456.5214666248825, 41.36706135629708},
  {462.789094327797, 43.433799784714736},
  {468.5553118144783, 45.82346609257265},
  {474.4468818552178, 48.66523143164692},
  {480.08774678784084, 51.70075349838536},
  {485.8539642745221, 55.44671689989235},
  {491.36947665308685, 59.64477933261571},
  {495.1300532748355, 62.93864370290635},
  {499.14133500470075, 66.68460710441335},
  {503.40332184268266, 70.43057050592034},
  {509.92165465371363, 73.91819160387514},
  {517.442807897211, 77.14747039827773},
  {530.2287684111565, 79.60172228202369},
  {542.2626136007523, 80.76426264800862},
  {560.3133813851458, 80.15069967707214},
  {571.9711689125667, 79.66630785791175},
  {589.896584142902, 79.14962325080734},
  {607.4459417110625, 79.27879440258343},
  {622.7389533061737, 79.27879440258343},
  {639.2854904418679, 79.34337997847149},
  {657.586963334378, 79.34337997847149},
  {671.6264493889064, 79.34337997847149},
  {684.1617047947353, 79.92465016146396},
  {697.1983704167974, 80.95801937567278},
  {710.485741146976, 82.50807319698602},
  {722.7702914446884, 83.34768568353068},
  {740.3196490128488, 82.57265877287406},
  {754.3591350673771, 81.82992465016147},
  {770.9056722030713, 81.41011840688914},
  {785.9479786900661, 81.21636167922499},
  {801.2409902851773, 81.21636167922499},
  {813.7762456910061, 81.21636167922499},
  {829.5706675023505, 81.28094725511303},
};

const static spectra_entry rose_paper_data[] = {
  {360.1308044473513, 54.969453564171395},
  {363.79332897318517, 56.48237337624867},
  {371.9032047089602, 61.50216891560716},
  {377.6586003924134, 64.66538318758148},
  {385.2452583387836, 67.82875484458604},
  {395.7096141268804, 70.09856175064117},
  {407.22040549378687, 70.44332490115971},
  {417.68476128188365, 69.75667649781836},
  {429.98037933289737, 69.55146890196713},
  {442.79921517331593, 69.96509924500154},
  {454.31000654022245, 70.1035980716087},
  {467.3904512753434, 69.3484197293877},
  {476.0235448005233, 67.49278277218494},
  {480.7325049051668, 65.70556333598307},
  {486.6187050359713, 63.29965210413794},
  {492.7665140614781, 60.96251813050568},
  {497.9986919555265, 58.350286365809794},
  {501.92282537606286, 55.80669695787229},
  {504.2773054283846, 52.91919877529466},
  {508.0706344015698, 49.61929560456088},
  {511.2099411379988, 46.800619647347624},
  {516.0497056899935, 43.98208983337673},
  {516.0497056899935, 43.98208983337673},
  {523.3747547416613, 42.19509523293236},
  {530.699803793329, 42.53949864623894},
  {539.0712884238064, 40.61508443082331},
  {543.7802485284499, 37.79654337506453},
  {548.0967952910398, 34.84045904466788},
  {553.9829954218444, 32.0907739396371},
  {561.831262262917, 30.819485116122685},
  {569.941137998692, 33.32973138122603},
  {573.6036625245258, 36.49276578459437},
  {576.2197514715501, 39.93072935220823},
  {578.7050359712231, 43.91871987513123},
  {581.5827338129498, 48.93806574297477},
  {583.6756049705691, 53.5448155122683},
  {586.5533028122957, 58.770425704023225},
  {589.3001962066711, 63.85851510471602},
  {592.7011118378025, 68.80915116507393},
  {596.2328319162852, 72.59096729838853},
  {605.2583387835186, 76.92329378389087},
  {621.4780902550688, 78.2997832583298},
  {637.4362328319163, 78.71368340427318},
  {652.3479398299542, 78.98998406663932},
  {665.1667756703728, 78.99108576185097},
  {679.8168737737083, 79.19860916600425},
  {693.6821451929366, 80.36863196435004},
  {707.8090255068672, 81.88245111945724},
  {721.6742969260954, 83.32749301635155},
  {740.5101373446697, 82.43529976352275},
  {755.68345323741, 81.54279174063348},
  {771.3799869195552, 81.26912165662984},
  {785.7684761281885, 81.16722609134028},
  {800.1569653368215, 81.20284007532499},
  {811.9293655984303, 81.10071967427794},
  {829.9803793328974, 81.4460449141902},
};

const static spectra_entry o2_rose_paper_data[] = {
  {360.3924133420537, 35.51187482544004},
  {365.8862001308045, 39.56887868412127},
  {372.1648136036626, 44.31349773990102},
  {377.6586003924134, 48.09548250003374},
  {383.9372138652715, 52.01504426016796},
  {390.21582733812954, 55.59083214711655},
  {397.2792674950949, 59.16668748479238},
  {407.4820143884893, 62.46779352682867},
  {420.0392413342054, 64.94404462540115},
  {433.90451275343366, 66.9391247193925},
  {449.3394375408765, 68.79683016556407},
  {462.41988227599745, 70.3793141610054},
  {475.238718116416, 71.82426612359671},
  {491.9816873773709, 72.23823372026736},
  {503.2308698495749, 71.07036934519334},
  {512.3871811641596, 69.55855122832772},
  {526.7756703727928, 69.49103305035672},
  {537.7632439502944, 69.76699645908664},
  {547.1811641595815, 67.70516262869974},
  {552.6749509483323, 65.23046289685385},
  {562.0928711576194, 63.58115771428972},
  {571.2491824722041, 66.26338085028888},
  {577.0045781556573, 69.56410467153745},
  {582.4983649444082, 72.79605123457316},
  {589.0385873119686, 75.61555908408909},
  {601.0725964682799, 78.02301044087295},
  {615.4610856769131, 78.78054955854749},
  {631.1576193590582, 79.05691767164087},
  {646.8541530412035, 79.33328578473426},
  {659.672988881622, 79.12812315603452},
  {671.7069980379333, 79.19791217515605},
  {683.7410071942446, 80.02400371528599},
  {696.2982341399608, 80.91889499720455},
  {705.4545454545455, 82.0885130911869},
  {719.8430346631785, 83.28608276653904},
  {735.5395683453237, 82.54488021500295},
  {751.8639633747548, 81.96874308317774},
  {769.1301504251144, 81.55769835135433},
  {785.7684761281885, 81.22910538851369},
  {829.404839764552, 81.54637742129374},
};

const static spectra_entry flexo_paper_data[] = {
  {360.50955414012736, 48.72},
  {368.1528662420382, 48.51428571428571},
  {379.87261146496814, 47.005714285714284},
  {388.5350318471337, 44.81142857142857},
  {397.452229299363, 42.34285714285714},
  {404.84076433121015, 40.628571428571426},
  {417.8343949044586, 38.84571428571429},
  {427.77070063694265, 42.068571428571424},
  {431.8471337579617, 45.01714285714286},
  {439.3630573248407, 52.49142857142857},
  {445.85987261146494, 59.82857142857143},
  {449.936305732484, 64.21714285714286},
  {455.92356687898086, 68.81142857142856},
  {464.968152866242, 72.48},
  {481.27388535031844, 73.54285714285714},
  {493.2484076433121, 70.90285714285714},
  {501.91082802547766, 68.12571428571428},
  {508.5350318471337, 65.89714285714285},
  {515.9235668789809, 62.50285714285714},
  {524.0764331210191, 58.457142857142856},
  {530.4458598726114, 54.96},
  {536.1783439490446, 51.325714285714284},
  {542.1656050955414, 47.34857142857143},
  {548.0254777070063, 43.92},
  {552.9936305732484, 40.69714285714286},
  {559.4904458598726, 36.85714285714286},
  {566.4968152866242, 33.291428571428575},
  {574.0127388535032, 30.000000000000007},
  {584.2038216560509, 27.188571428571436},
  {598.9808917197452, 24.994285714285695},
  {612.4840764331209, 23.21142857142857},
  {625.4777070063694, 21.085714285714275},
  {639.4904458598726, 19.714285714285708},
  {655.796178343949, 21.017142857142844},
  {668.28025477707, 23.554285714285726},
  {677.4522292993629, 26.982857142857142},
  {683.8216560509552, 31.78285714285714},
  {687.8980891719744, 36.03428571428572},
  {691.8471337579617, 40.56},
  {695.1592356687898, 45.01714285714286},
  {698.5987261146497, 49.885714285714286},
  {702.0382165605095, 55.028571428571425},
  {706.2420382165604, 60.51428571428571},
  {710.4458598726114, 65.65714285714286},
  {715.5414012738853, 70.38857142857142},
  {722.4203821656051, 75.12},
  {732.7388535031846, 78.27428571428571},
  {749.2993630573247, 79.67999999999999},
  {765.0955414012737, 80.09142857142857},
  {777.8343949044586, 80.19428571428571},
  {789.2993630573247, 80.53714285714285},
  {804.5859872611463, 80.94857142857143},
  {816.56050955414, 81.01714285714286},
  {830.0636942675158, 81.1542857142857},
};

const static spectra_entry o2_flexo_paper_data[] = {
  {360.25477707006365, 32.26285714285714},
  {367.6433121019108, 35.417142857142856},
  {374.01273885350315, 38.64000000000001},
  {383.43949044585986, 42.205714285714286},
  {393.8853503184713, 44.26285714285714},
  {408.6624203821656, 44.81142857142857},
  {420.3821656050955, 46.04571428571429},
  {428.0254777070063, 48.582857142857144},
  {435.41401273885344, 52.49142857142857},
  {443.312101910828, 56.05714285714286},
  {452.2292993630573, 59.48571428571428},
  {463.9490445859872, 61.748571428571424},
  {478.4713375796178, 63.325714285714284},
  {493.75796178343944, 64.01142857142858},
  {508.0254777070063, 63.25714285714285},
  {520.764331210191, 62.16},
  {532.2292993630573, 60.03428571428571},
  {539.872611464968, 57.42857142857143},
  {548.7898089171974, 54.27428571428572},
  {555.4140127388534, 50.84571428571429},
  {563.0573248407643, 47.074285714285715},
  {568.9171974522292, 43.78285714285715},
  {577.0700636942674, 40.628571428571426},
  {587.0063694267515, 37.74857142857143},
  {600, 35.485714285714295},
  {612.4840764331209, 33.77142857142857},
  {625.7324840764331, 32.26285714285714},
  {642.0382165605095, 31.577142857142853},
  {657.3248407643312, 32.948571428571434},
  {666.496815286624, 36.24000000000001},
  {672.3566878980891, 40.011428571428574},
  {675.9235668789809, 44.12571428571429},
  {680, 48.44571428571429},
  {683.8216560509554, 52.354285714285716},
  {687.388535031847, 56.605714285714285},
  {690.700636942675, 61.611428571428576},
  {696.3057324840763, 66.20571428571428},
  {700.8917197452229, 70.38857142857142},
  {707.0063694267515, 74.57142857142857},
  {716.1783439490446, 78.87771428571429},
  {728.1019108280254, 81.264},
  {747.3630573248406, 81.264},
  {762.343949044586, 81.18171428571428},
  {778.5477707006369, 80.85257142857142},
  {795.9745222929935, 80.98422857142857},
  {811.016560509554, 81.08297142857143},
  {829.7273885350317, 80.98422857142857},
};

const static spectra_entry crystal_paper_data[] = {
  {360, 45.52003081664099},
  {368.619000979432, 47.53081664098613},
  {378.54391119817177, 49.333590138674886},
  {385.8570029382958, 51.899075500770415},
  {391.864185439112, 55.01926040061633},
  {398.3937316356513, 58.20878274268105},
  {405.8374142997062, 61.32896764252696},
  {414.3258243552074, 64.24114021571648},
  {424.7730982696703, 67.153312788906},
  {435.48155403199485, 67.98536209553158},
  {447.4959190336272, 66.80662557781201},
  {457.9431929480902, 64.10246533127889},
  {464.86451191642186, 61.60631741140215},
  {472.699967352269, 58.20878274268105},
  {480.2742409402547, 53.771186440677965},
  {486.54260528893246, 49.12557781201849},
  {492.941560561541, 43.64791987673344},
  {502.6052889324193, 37.823574730354395},
  {512.6607900750898, 33.03929121725732},
  {524.2833823049299, 30.057781201848996},
  {542.3049298073785, 27.977657935285052},
  {560.5876591576887, 26.382896764252706},
  {579.1315703558603, 25.412172573189522},
  {598.7202089454784, 24.718798151001536},
  {615.4358472086192, 25.550847457627114},
  {626.7972575905976, 27.63097072419106},
  {635.2856676460987, 31.16718027734977},
  {648.3447600391773, 42.74653312788906},
  {657.747306562194, 51.34437596302003},
  {663.885079986941, 57.44607087827426},
  {670.9369898792036, 63.33975346687211},
  {680.2089454782894, 69.37211093990754},
  {692.2233104799217, 74.57241910631741},
  {704.7600391772772, 77.62326656394453},
  {720.1697682011102, 80.32742681047766},
  {738.9748612471435, 80.25808936825887},
  {758.3023179888999, 79.63405238828967},
  {773.4508651648712, 79.63405238828967},
  {791.2112308194583, 79.59938366718028},
  {809.2327783219067, 79.49537750385208},
  {829.8661443029711, 79.77272727272727}
};

const static spectra_entry o2_crystal_paper_data[] = {
  {360, 33.31664098613251},
  {366.2683643486778, 36.50616332819723},
  {372.53672869735556, 39.973035439137135},
  {378.2827293503102, 43.57858243451464},
  {385.0734573947111, 47.11479198767334},
  {392.1253672869736, 50.92835130970724},
  {401.2667319621287, 54.53389830508474},
  {411.7140058765916, 57.238058551617875},
  {429.47437153117863, 58.902157164869024},
  {447.23473718576565, 59.04083204930662},
  {461.8609206660137, 59.768875192604},
  {475.18119490695403, 60.0115562403698},
  {486.4120143650017, 58.20878274268105},
  {493.4639242572642, 55.365947611710325},
  {500.51583414952665, 52.4537750385208},
  {507.04538034606605, 49.333590138674886},
  {514.0972902383285, 46.560092449922955},
  {520.6268364348679, 43.717257318952235},
  {529.2458374142998, 41.567796610169495},
  {540.2154750244858, 39.21032357473036},
  {553.013385569703, 37.4768875192604},
  {565.0277505713354, 36.090138674884436},
  {580.6986614430298, 34.77272727272727},
  {595.0636630754163, 33.94067796610169},
  {610.4733920992492, 34.28736517719568},
  {621.9653934051585, 36.367488443759626},
  {632.4126673196214, 39.90369799691834},
  {639.2033953640223, 43.23189522342064},
  {644.1658504733922, 46.90677966101695},
  {648.605941887039, 50.026964560862865},
  {653.5683969964089, 54.048536209553156},
  {658.5308521057788, 57.44607087827426},
  {662.4485798237024, 60.91294298921417},
  {667.9333986287954, 64.58782742681048},
  {674.2017629774732, 68.33204930662558},
  {680.7313091740125, 71.86825885978428},
  {691.1785830884754, 75.88983050847457},
  {703.715311785831, 79.35670261941448},
  {715.9908586353249, 82.06086286594761},
  {732.7169441723802, 82.6959938366718},
  {751.8981390793341, 81.99707241910632},
  {769.5749265426055, 81.59768875192604},
  {786.4995102840353, 81.49784283513097},
  {802.2957884427033, 81.3979969183359},
  {819.2203721841332, 81.49784283513097},
  {829.751224289912, 81.6975346687211},
};
#if 0
const static luminosity_t patent_data[] = {
	4.109, 3.429, 4.551, 7.879, 12.157,
	16.729, 19.668, 18.52, 15.802, 13.106,
	10.459, 8.196, 6.274, 4.773, 3.666,
	2.99, 2.605, 2.418, 2.374, 2.396,
	2.471, 2.545, 2.641, 2.74, 2.859,
	3.011, 3.165, 3.283, 3.522, 4.02,
	4.722};
/* Described as malachite */
const static luminosity_t flexo_data[] = {
	19.459, 17.381, 18.342, 22.466, 29.516,
	40.348, 49.614, 52.108, 50.776, 46.243,
	39.993, 33.718, 27.426, 21.506, 16.355,
	12.579, 9.8, 7.86, 6.613, 5.931,
	5.58, 5.305, 5.137, 4.972, 4.965,
	5.21, 5.82, 6.881, 8.833, 12.118,
	16.567};
const static luminosity_t crystal_data[] = {
	38.315, 40.266, 39.171, 34.427, 28.003,
	21.398, 15.17, 10.28, 6.66, 4.782,
	3.949, 3.522, 3.41, 3.351, 3.366,
	3.433, 3.545, 3.684, 3.841, 3.974,
	4.143, 4.377, 4.831, 5.544, 6.886,
	9.098, 12.809, 18.647, 26.089, 34.848,
	45.039};
#endif 
/* This optical absorption measurement of Malachite Green were made by
   R.-C. A. Fuh in the summer of 1995 using a Cary 3. The absorption values
   were collected using a spectral bandwidth of 1.0 nm, a signal averaging
   time of 0.133 sec, a data interval of 0.25 nm, and a scan rate of 112.5 nm/min.

   These measurements were scaled to make the molar extinction coefficient
   match the value of 148,900cm-1/M at 616.5nm (Green, 1990).  
   
   380...780 step 1
   https://omlc.org/spectra/PhotochemCAD/data/030-orig-abs.txt
   https://www.photochemcad.com/databases/common-compounds/arylmethane-dyes/malachite-green
   */
#if 0
const static luminosity_t malachite_green_absorption[] = {
  5714.710449, 6882.785156, 8064.250000, 9556.415039, 11162.849609, 12651.099609, 14063.299805, 15344.900391, 16374.000000, 16848.199219, 
  16122.599609, 14301.549805, 11657.049805, 8980.445312, 6529.435059, 4758.515137, 3444.159912, 2746.590088, 2446.639893, 2309.064941, 
  2464.064941, 2643.600098, 2823.439941, 3214.024902, 3654.260010, 4145.814941, 4852.984863, 5593.334961, 6596.870117, 7599.415039, 
  8862.839844, 10317.500000, 12109.099609, 14307.200195, 16943.949219, 20061.400391, 23428.849609, 26756.599609, 30044.449219, 33338.601562, 
  36689.449219, 40676.750000, 45561.800781, 51820.949219, 59052.500000, 66234.601562, 72624.851562, 76337.898438, 76083.101562, 71255.148438, 
  62538.148438, 51596.800781, 40586.000000, 31159.900391, 23039.500000, 16792.349609, 11849.509766, 8251.544922, 5805.365234, 4006.100098, 
  2770.989990, 2101.284912, 1626.385010, 1260.034058, 1003.224976, 848.287476, 738.367004, 616.599487, 585.451965, 563.359009, 
  517.446472, 468.053009, 438.311493, 350.077850, 422.556702, 443.668243, 408.154938, 382.989410, 372.640289, 285.500000, 
  287.421448
};
#endif

/* Auramine O 
   https://www.photochemcad.com/databases/common-compounds/arylmethane-dyes/auramine-o
   380...600 step 1 extended to 380...780.  */
const static luminosity_t auramine_absorption[] = {
  9070.205078, 8657.660156, 9303.535156, 10857.150391, 12929.549805, 15225.599609, 17700.800781, 20127.150391, 22403.550781, 24155.949219, 
  25057.150391, 24937.900391, 23739.750000, 21656.050781, 18725.250000, 15412.400391, 11922.049805, 8683.285156, 6045.535156, 3987.445068, 
  2521.854980, 1576.045044, 946.416016, 584.485474, 347.091492, 224.826004, 151.973251, 124.607155, 107.565048, 84.402748, 
  79.390549, 71.909500, 72.717453, 64.016800, 60.051800, 63.489799, 64.031548, 68.086601, 72.403748, 85.249352, 
  84.987198, 86.827301, 82.742348, 76.832649, 66.079636, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000
};

/* Crystal violet
   https://www.photochemcad.com/databases/common-compounds/arylmethane-dyes/crystal-violet
   380...700 step 1 extended to 380...780.  */
const static luminosity_t crystal_violet_absorption[] = {
  1235.365845, 933.183472, 668.357483, 660.151489, 621.073486, 619.455994, 641.633484, 676.014526, 747.124023, 891.176514, 
  1048.065552, 1300.500000, 1595.984985, 1974.510010, 2446.314941, 3073.139893, 3776.560059, 4657.365234, 5670.160156, 6934.430176, 
  8454.764648, 10128.695312, 12149.400391, 14342.250000, 16979.900391, 20113.099609, 23626.800781, 27699.699219, 32085.000000, 36463.398438, 
  40730.500000, 44567.398438, 47733.101562, 50296.898438, 52000.550781, 53479.699219, 55006.050781, 57069.449219, 60310.148438, 64409.550781, 
  69289.148438, 73673.546875, 75493.046875, 73375.500000, 66916.000000, 57560.300781, 46456.000000, 35952.648438, 26284.550781, 18433.800781, 
  12697.049805, 8489.924805, 5690.850098, 3783.590088, 2483.495117, 1663.650024, 1077.110962, 702.646484, 432.394012, 318.666992, 
  244.475647, 172.238342, 127.698601, 98.900139, 48.088692, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000
};
/* Methylene blue
   https://www.photochemcad.com/databases/common-compounds/acridines/methylene-blue
   380...780 step 1.  */
const static luminosity_t methylene_blue_absorption[] = {
  416.822021, 492.717987, 511.117981, 417.496002, 261.010010, 165.565994, 125.589996, 118.251999, 135.619995, 163.496002, 
  196.804001, 246.472000, 303.605988, 368.895996, 450.838013, 531.005981, 602.890015, 670.078003, 769.612000, 850.000000, 
  927.669983, 996.997986, 1039.859985, 1014.557983, 967.929993, 903.445984, 884.210022, 897.752014, 943.114014, 1027.265991, 
  1167.739990, 1359.079956, 1631.200073, 1979.179932, 2398.520020, 2879.939941, 3408.239990, 4043.919922, 4785.799805, 5726.839844, 
  6932.060059, 8406.700195, 10200.860352, 12137.000000, 13827.599609, 14999.000000, 15777.000000, 16427.400391, 17354.000000, 18976.400391, 
  21592.599609, 24941.199219, 28790.800781, 33072.199219, 37579.000000, 40303.398438, 37675.398438, 30022.400391, 20697.400391, 13173.400391, 
  8128.959961, 4858.799805, 2771.820068, 1513.699951, 821.511963, 460.062012, 266.532013, 150.904007, 101.571999, 70.424194, 
  49.140999, 34.718201, 30.912201, 31.627001, 27.825001, 24.366199, 20.560001, 18.183479, 18.886200, 22.254200, 
  19.956400
};
/* Rhodamine B
   https://www.photochemcad.com/databases/common-compounds/xanthenes/rhodamine-b
   380...780 step 1.  */
const static luminosity_t  rhodamine_b_absorption[] = {
  3156.336914, 3252.969971, 3441.300049, 3501.310059, 3423.669922, 3241.004883, 3140.139893, 2984.225098, 2583.514893, 2081.689941, 
  1545.214966, 1211.983521, 1084.613525, 1209.706543, 1494.959961, 1990.369995, 2837.600098, 3980.445068, 5217.240234, 6819.115234, 
  8809.570312, 11587.700195, 15590.900391, 20672.900391, 26503.599609, 31867.199219, 36139.101562, 40927.398438, 48158.050781, 59408.398438, 
  74852.101562, 90990.296875, 103044.648438, 103682.203125, 90223.500000, 66902.703125, 42872.398438, 24423.400391, 12112.785156, 5512.529785, 
  2178.935059, 698.428528, 154.039246, 31.907211, 51.212009, 10.501052, 74.048698, 117.038101, 92.102478, 116.547104, 
  78.113998, 85.488548, 106.536140, 56.307148, 75.791481, 96.347198, 76.595177, 107.877327, 81.600075, 108.905434, 
  93.934601, 80.528145, 132.353455, 88.571838, 67.033180, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
  0.000000
};

#if 0
/* Table 25 of COlor Cinematography book, page 159.  */
/* Transmission percents.  */
/* 400 to 700, step 10  */
const static luminosity_t  wratten_filter_red_25[] = {
  /* 400 */ 0,
  /* 410 */ 0,
  /* 420 */ 0,
  /* 430 */ 0,
  /* 440 */ 0,
  /* 450 */ 0,
  /* 460 */ 0,
  /* 470 */ 0,
  /* 480 */ 0,
  /* 490 */ 0,
  /* 500 */ 0,
  /* 510 */ 0,
  /* 520 */ 0,
  /* 530 */ 0,
  /* 540 */ 0,
  /* 550 */ 0,
  /* 560 */ 0,
  /* 570 */ 0,
  /* 580 */ 0.16,
  /* 590 */ 10.2,
  /* 600 */ 50.1,
  /* 610 */ 70.0,
  /* 620 */ 80.5,
  /* 630 */ 84.0,
  /* 640 */ 85.5,
  /* 650 */ 87.0,
  /* 660 */ 87.0,
  /* 670 */ 87.0,
  /* 680 */ 87.0,
  /* 690 */ 87.0,
  /* 700 */ 87.0};
#endif

// Table from Wratten light color filters, 1945 edition.
const static luminosity_t  wratten_filter_red_25_kodak[] = {
  /* 400 */ 0,
  /* 410 */ 0,
  /* 420 */ 0,
  /* 430 */ 0,
  /* 440 */ 0,
  /* 450 */ 0,
  /* 460 */ 0,
  /* 470 */ 0,
  /* 480 */ 0,
  /* 490 */ 0,
  /* 500 */ 0,
  /* 510 */ 0,
  /* 520 */ 0,
  /* 530 */ 0,
  /* 540 */ 0,
  /* 550 */ 0,
  /* 560 */ 0,
  /* 570 */ 0,
  /* 580 */ 0.16,
  /* 590 */ 14.7,
  /* 600 */ 54.8,
  /* 610 */ 74.8,
  /* 620 */ 83.1,
  /* 630 */ 85.0,
  /* 640 */ 86.3,
  /* 650 */ 87.0,
  /* 660 */ 87.6,
  /* 670 */ 88.3,
  /* 680 */ 88.7,
  /* 690 */ 89.2,
  /* 700 */ 89.5};

#if 0
const static luminosity_t  wratten_filter_green_58[] = {
  /* 400 */ 0,
  /* 410 */ 0,
  /* 420 */ 0,
  /* 430 */ 0,
  /* 440 */ 0,
  /* 450 */ 0,
  /* 460 */ 0,
  /* 470 */ 0,
  /* 480 */ 1.97,
  /* 490 */ 11.5,
  /* 500 */ 30.3,
  /* 510 */ 50.1,
  /* 520 */ 60.2,
  /* 530 */ 54.7,
  /* 540 */ 39.0,
  /* 550 */ 30.2,
  /* 560 */ 25.1,
  /* 570 */ 17.0,
  /* 580 */ 10.0,
  /* 590 */ 5.63,
  /* 600 */ 2.82,
  /* 610 */ 1.35,
  /* 620 */ 0.57,
  /* 630 */ 0.21,
  /* 640 */ 0,
  /* 650 */ 0,
  /* 660 */ 0,
  /* 670 */ 0,
  /* 680 */ 0,
  /* 690 */ 0.1,
  /* 700 */ 1.97};
#endif

const static luminosity_t  wratten_filter_green_58_kodak[] = {
  /* 400 */ 0,
  /* 410 */ 0,
  /* 420 */ 0,
  /* 430 */ 0,
  /* 440 */ 0,
  /* 450 */ 0,
  /* 460 */ 0,
  /* 470 */ 0,
  /* 480 */ 0.50,
  /* 490 */ 3.94,
  /* 500 */ 17.4,
  /* 510 */ 40.7,
  /* 520 */ 51.3,
  /* 530 */ 52.0,
  /* 540 */ 47.9,
  /* 550 */ 39.8,
  /* 560 */ 29.8,
  /* 570 */ 19.5,
  /* 580 */ 10.7,
  /* 590 */ 5.4,
  /* 600 */ 2.4,
  /* 610 */ 1.2,
  /* 620 */ 0.55,
  /* 630 */ 0.24,
  /* 640 */ 0,
  /* 650 */ 0,
  /* 660 */ 0,
  /* 670 */ 0,
  /* 680 */ 0.3,
  /* 690 */ 1.0,
  /* 700 */ 2.00};

#if 0
const static luminosity_t  wratten_filter_blue_47[] = {
  /* 400 */ 25.1,
  /* 410 */ 35.4,
  /* 420 */ 49.0,
  /* 430 */ 49.5,
  /* 440 */ 48.0,
  /* 450 */ 47.8,
  /* 460 */ 43.7,
  /* 470 */ 37.4,
  /* 480 */ 30.3,
  /* 490 */ 21.8,
  /* 500 */ 12.5,
  /* 510 */ 5.42,
  /* 520 */ 1.30,
  /* 530 */ 0.15,
  /* 540 */ 0,
  /* 550 */ 0,
  /* 560 */ 0,
  /* 570 */ 0,
  /* 580 */ 0,
  /* 590 */ 0,
  /* 600 */ 0,
  /* 610 */ 0,
  /* 620 */ 0,
  /* 630 */ 0,
  /* 640 */ 0,
  /* 650 */ 0,
  /* 660 */ 0,
  /* 670 */ 0,
  /* 680 */ 0,
  /* 690 */ 0,
  /* 700 */ 0};
#endif

const static luminosity_t  wratten_filter_blue_47_kodak[] = {
  /* 400 */ 6.03,
  /* 410 */ 16.2,
  /* 420 */ 35.5,
  /* 430 */ 49.0,
  /* 440 */ 51.3,
  /* 450 */ 49.0,
  /* 460 */ 44.7,
  /* 470 */ 36.3,
  /* 480 */ 27.5,
  /* 490 */ 18.6,
  /* 500 */ 9.85,
  /* 510 */ 4.17,
  /* 520 */ 1.02,
  /* 530 */ 0.16,
  /* 540 */ 0,
  /* 550 */ 0,
  /* 560 */ 0,
  /* 570 */ 0,
  /* 580 */ 0,
  /* 590 */ 0,
  /* 600 */ 0,
  /* 610 */ 0,
  /* 620 */ 0,
  /* 630 */ 0,
  /* 640 */ 0,
  /* 650 */ 0,
  /* 660 */ 0,
  /* 670 */ 0,
  /* 680 */ 0,
  /* 690 */ 0,
  /* 700 */ 0};

/* Log sensitivity.  */
const static spectra_entry kodachrome_25_spectral_response_red[] = {
  {480.58159801400745, 0.7146799756434878},
  {492.1948225154755, 0.7295921763332602},
  {504.8599623805286, 0.7603749374446864},
  {512.2411196106902, 0.8042419282074544},
  {519.3599759393157, 0.8415735835381533},
  {529.6469045288815, 0.8798315505582521},
  {540.200324917846, 0.9087518273547299},
  {551.2793332034977, 0.9470079454493012},
  {556.8127975229328, 0.9890118355886115},
  {562.608562743904, 1.0375510611599912},
  {567.3492077970423, 1.082357922399363},
  {572.0888667565655, 1.1308996132047797},
  {576.5630200103046, 1.1850441646677727},
  {579.9835322366329, 1.2298541074496907},
  {584.4547272095276, 1.2952031476108186},
  {588.1387729544103, 1.3418798888672496},
  {594.1988112641474, 1.3894847907386088},
  {605.0115742738036, 1.4361448916652901},
  {615.0359554384295, 1.4688012306448313},
  {621.8897991080784, 1.509868331850084},
  {628.2133709363699, 1.5593400321959565},
  {635.5955142601463, 1.5994721933926797},
  {643.7714629438345, 1.6330665539232967},
  {651.1627276335479, 1.638651541634105},
  {655.9250667462115, 1.60129215242049},
  {661.2218685980954, 1.539655138410565},
  {664.6670331647935, 1.4910943420413616},
  {667.3196249885982, 1.4444028093807084},
  {669.1781649290875, 1.405182784777673},
  {671.036458346173, 1.3668964675661484},
  {672.8962309036808, 1.3230079060055564},
  {674.7587152186292, 1.2688485631383415},
  {676.8862121925545, 1.2109537743965724},
  {678.7491895543103, 1.1549270167463348},
  {680.8761934814281, 1.098899642787588},
  {683.2667309271005, 1.0447390673033545},
  {685.6557892323508, 0.9961807361681883},
  {688.3078880093482, 0.9513566182905575},
  {691.4909981979139, 0.8953267790977735},
  {694.6731222928648, 0.8430317694710348},
  {698.1202590467926, 0.7870013139697418},
  {699.7098419538459, 0.7664560535054397}
};
const static spectra_entry kodachrome_25_spectral_response_green[] = {
  {440.1303122711954, 0.9239247265439146},
  {451.99893501889596, 0.9715160696280702},
  {462.55038322063103, 1.0079060055566373},
  {470.9898654228739, 1.0433671645617677},
  {475.7310035228195, 1.086306611018117},
  {479.94359544523354, 1.1311147048745074},
  {485.4758271476502, 1.1777871319713737},
  {492.0631790179, 1.228191923400248},
  {498.1229708042333, 1.2767305326631182},
  {504.7103226744831, 1.3271353240919925},
  {511.2976745447329, 1.3775401155208669},
  {519.206391858811, 1.4232732884496389},
  {527.9062027753605, 1.4727394420189281},
  {535.5516330942878, 1.5156721090816756},
  {544.2526766278556, 1.5604697256934088},
  {552.6975823449799, 1.5753893220852921},
  {561.1523489982521, 1.5529606228167272},
  {567.4983544562803, 1.517464950535079},
  {571.9986391908116, 1.4726365184978838},
  {574.9137784395562, 1.4315466138777886},
  {577.0353588517926, 1.3960608025322885},
  {578.8938987922818, 1.3568407779292526},
  {581.0174513917478, 1.3138853074516628},
  {582.8794426598889, 1.2615933793674703},
  {584.2084503292319, 1.2279768317305204},
  {586.0699485505656, 1.17755231842935},
  {587.4014214539457, 1.134598696877288},
  {588.9979070163025, 1.0879096294506718},
  {590.8594052376362, 1.0374851161495018},
  {592.7218895525847, 0.9833257732822864},
  {594.5824016803035, 0.9366360895471613},
  {596.7098986542287, 0.8787413008053917},
  {599.3629835248408, 0.8301823533617163},
  {602.5446145729844, 0.7797547585179998},
  {605.1967133499818, 0.7349306406403693},
  {608.6403987762577, 0.6919720886202332}
};
const static spectra_entry kodachrome_25_spectral_response_blue[] = {
  {409.6084961825851, 1.5253031621556992},
  {411.18032940457203, 1.5719848338802045},
  {412.49208043565613, 1.6037278036490394},
  {414.3341033080975, 1.627066174277255},
  {418.5503930815672, 1.657868657260977},
  {423.30065254744954, 1.6662609302314115},
  {429.1112091726428, 1.6587777123121183},
  {435.45154459238586, 1.6447573100352282},
  {441.00103293306154, 1.6260702197263097},
  {448.92971864283936, 1.5961730939426733},
  {457.38645748334113, 1.5662747355420188},
  {466.10771593601237, 1.534508346049832},
  {473.77434726765784, 1.4971421774426155},
  {479.59427178219164, 1.4541780786458962},
  {483.56502424557675, 1.4149531235747865},
  {488.0667881205302, 1.364522447188524},
  {491.50948745319135, 1.3252987247344326},
  {494.4231475615137, 1.2898110644634047},
  {497.8673260345971, 1.2449850976602463},
  {501.8410367788266, 1.194555653891002},
  {505.0216817333553, 1.1478628886133304},
  {508.9973646648144, 1.0899637857119964},
  {512.7090210309116, 1.0320652991191719},
  {515.890652079055, 0.9816377042754554},
  {519.8658419637068, 0.925606016157144},
  {522.782953399681, 0.8770464524049588},
  {526.2295971068013, 0.8228834116866885},
  {529.4119677251559, 0.7696546946684384},
};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_red[] = {
  {400, 0.14797509610367854},
  {419.9287323673442, 0.13618294677388576},
  {439.85746473468834, 0.12439079744407877},
  {459.43032688118706, 0.11280922220946366},
  {479.3590592485313, 0.10101707287971351},
  {499.288493529526, 0.1779819046660691},
  {519.2172258968702, 0.16618975533627633},
  {539.8576987059052, 0.15397645781614244},
  {560.1423012940949, 0.1419737343911578},
  {576.5130333666352, 0.22104430712933265},
  {581.1533845106376, 1.9934464662157154},
  {585.0826971265996, 3.855026754608616},
  {588.3002693008707, 5.717028191191929},
  {590.4502308126055, 7.5796613500606895},
  {592.9609759407399, 10.063382802647595},
  {594.400600838085, 12.103951071939107},
  {595.8381199944783, 13.87824839788206},
  {597.9929949017671, 16.362180424564173},
  {599.4354274537147, 18.757776618320392},
  {600.8799657466138, 21.4196437554252},
  {602.3245040395132, 24.081510892529963},
  {603.7648308505088, 26.210836142937666},
  {604.8520950952615, 28.695399891905296},
  {605.9407631673153, 31.357477603105238},
  {606.6665418820178, 33.13219607723856},
  {607.3937244240215, 35.08442851360424},
  {608.1237146206274, 37.391688874434635},
  {610.2771857006152, 39.69810693888435},
  {611.0071758972213, 42.00536729971476},
  {611.7357622665261, 44.13511369831281},
  {613.1803005594252, 46.79698083541761},
  {613.9074831014289, 48.749213271783276},
  {614.6388771253361, 51.233987594846056},
  {615.3695692355927, 53.63000493679264},
  {615.7429872977026, 55.84871889060205},
  {616.8260400605518, 57.80074075287256},
  {617.5574340844589, 60.28551507593533},
  {618.2818089718603, 61.882719587836284},
  {618.652419379368, 63.74640561718095},
  {619.7396836241206, 66.23096936614856},
  {620.829053609825, 68.9818040584647},
  {621.9135101999752, 71.11133988296757},
  {623.0049859266313, 74.12844551863228},
  {624.44882230588, 76.70155567462088},
  {626.9560578657614, 78.74149222162687},
  {629.099702154641, 79.80531255045003},
  {631.2419426162194, 80.6916189170408},
  {636.9456929408545, 81.93084746714456},
  {642.6480394381883, 82.99256205501597},
  {646.922693570237, 83.52257705257097},
  {652.6208285856674, 84.05174975374527},
  {659.0314059564394, 84.6692582878454},
  {666.1523199416008, 85.10883171152281},
  {672.560791571421, 85.4600693022744},
  {678.2575227595503, 85.81172804121634},
  {684.6652924757198, 86.07420865085174},
  {691.7848026335801, 86.33626811229679},
  {699.2587791849847, 86.42060303741431},
};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_green[] = {
  {400, 0.14797509610366433},
  {419.9287323673442, 0.13618294677388576},
  {439.5015945138429, 0.12460137153927064},
  {459.7861971020325, 0.1125986481143002},
  {474.7334482911912, 0.19251151723312887},
  {478.299871549802, 1.1667325685593966},
  {481.15525628037244, 2.2301317491921964},
  {485.4411410308304, 4.180258444606139},
  {488.3000353296538, 5.687442530819823},
  {491.51550176297314, 7.283173024054605},
  {494.7358815918466, 9.500202385102568},
  {497.2396075834751, 11.09635402652765},
  {500.46139123964974, 13.490897349808023},
  {502.61416040598687, 15.708558433141562},
  {505.4793719276655, 18.014555349400908},
  {507.2755689595066, 20.14367002571342},
  {509.4297419531449, 22.53884507127931},
  {511.1077835204714, 24.72720125970102},
  {512.3109805031785, 26.87145972302487},
  {513.5130076298013, 28.867789884488403},
  {515.0121782018376, 30.93790871846943},
  {516.5160281982111, 33.599740759891716},
  {517.7279991015506, 36.85346148716782},
  {518.6346375668866, 38.99789542890432},
  {519.2458873709356, 41.29043315091376},
  {519.854212534774, 43.213150118272445},
  {520.1671490373254, 45.28397086590407},
  {521.0743724307036, 47.502368958570706},
  {521.9810108960396, 49.6468029003072},
  {523.1830380226625, 51.64313306177074},
  {523.7954576827959, 54.08359908564048},
  {524.1054695451367, 55.78459907862133},
  {524.4172361916037, 57.70749152439265},
  {525.6198482462688, 59.77778583678635},
  {527.1160941780943, 61.47808391611663},
  {528.6158496781726, 63.622166901027825},
  {531.0046958023224, 65.69175929977092},
  {533.3912022143036, 67.46549509479343},
  {537.5535501622591, 68.79439311375913},
  {544.0813471126783, 69.23431749426184},
  {550.0054983235963, 68.3432381148471},
  {554.7387360406924, 66.86114744164172},
  {558.283399976135, 65.08390207836631},
  {560.6406599860086, 63.15943032688117},
  {562.4083125293927, 61.67909443780224},
  {564.7597232588448, 59.014981177015585},
  {566.5226963778916, 56.94293208049544},
  {568.8729372512594, 54.13089051784847},
  {570.039283767311, 51.615407472572706},
  {571.2114795637841, 49.83956593659847},
  {572.0871168428861, 48.06389987903687},
  {573.5517766604353, 45.770133808138894},
  {574.4244892993265, 43.62464699592654},
  {575.8885641888335, 41.25691677409843},
  {577.0572504170538, 39.03729033254328},
  {578.5201554504765, 36.52163180885486},
  {579.985400196068, 34.30182988888704},
  {581.4518147977437, 32.22995627077955},
  {583.212448204622, 29.862050570538784},
  {585.2702250569135, 27.56793354281554},
  {587.918779231779, 24.977608954546398},
  {589.6829222069102, 23.053488159886527},
  {591.7401141311597, 20.685406981233143},
  {593.7978909834512, 18.39128995350991},
  {595.5614490305404, 16.393205007919903},
  {598.2111730614901, 13.950808721511066},
  {600.5690179994058, 12.100301120956075},
  {603.5164704038109, 9.8056576579949},
  {607.3518435762032, 7.288595307005309},
  {612.8461896617479, 4.548657824114457},
  {617.8129306532711, 2.5930562022259807},
  {624.2031525281761, 0.6366122839568078},
  {629.8928645797994, 0.10070121173690438},
  {640.5689712051624, 0.09438398888165977},
  {659.4300929099703, 0.08322356183738577},
  {680.0712676326558, 0.1597672454334429},
  {700, 0.14797509610366433}
};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_blue[] = {
  {400.41132139924144, 52.15956603018697},
  {404.3364225333, 53.488604431882784},
  {408.2601198400573, 54.64012887134624},
  {413.96737973294523, 56.32314232703093},
  {422.16713499905245, 58.182195726281755},
  {429.6509383415652, 59.509128387025825},
  {438.2016504329638, 60.74667234436819},
  {446.03781442806905, 61.629609525436166},
  {456.71251722613084, 61.44577834034856},
  {461.6876811814611, 60.555260491854284},
  {465.94408555859457, 58.777593980388524},
  {470.1983841947764, 56.73365652557421},
  {473.3850721684219, 54.69035079304543},
  {476.5703563147662, 52.46953109828428},
  {478.33426531868054, 50.51582464325237},
  {480.80921285063516, 48.472940058913935},
  {482.5661027180436, 45.63166379272021},
  {483.9692281055585, 43.0568690439702},
  {485.37445923402504, 40.74834523856873},
  {486.77898844884106, 38.3510644520511},
  {487.47388296291797, 36.22047575707231},
  {488.52464769784024, 34.08967648799842},
  {489.9305807399574, 31.86990966371316},
  {491.33721569572515, 29.738899820544077},
  {492.3858746896957, 27.3418296081216},
  {493.436639424618, 25.211030339047696},
  {494.8425724667352, 22.991263514762394},
  {495.8926352880069, 20.7717072645723},
  {497.6544385509695, 18.55172986619185},
  {499.05966967943607, 16.2432060607904},
  {500.46419889425204, 13.845925274272744},
  {502.5839781190118, 11.892008245145675},
  {504.34858903657675, 10.02705877122996},
  {507.53387318292107, 7.806239076468813},
  {510.36398902207054, 5.674386936918992},
  {514.2631193510574, 3.719417037316049},
  {518.5209275554921, 2.1192644880826634},
  {523.1346059807722, 0.5189013647540861},
  {524.9104475167466, 0.07406358869728535},
  {540.2128670131001, 0.0650089026048164},
  {560.1423012940949, 0.14197373439120042},
  {579.7151634405936, 0.1303921591565711},
  {599.6445977215883, 0.20735699094296933},
  {619.5733300889326, 0.19556484161317655},
  {640.2138028979676, 0.18335154409302845},
  {659.4300929099702, 0.08322356183738577},
  {680.0712676326557, 0.15976724543347132},
  {700.3558702208455, 0.14776452200845824}};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_red1s[] = {
  {399.9376459440879, 0.0893916825383485},
  {419.75471503955214, 0.1192694872192277},
  {438.6050535381037, 0.14208815701734068},
  {458.42218361669256, 0.1796772778065332},
  {538.6560741920906, 0.16507842508431736},
  {559.6815045254127, 0.19720370099446427},
  {595.206413694565, 0.1480550968209684},
  {600.5234467213382, 0.18874468633165975},
  {605.8406964125923, 0.25683149945058403},
  {610.1989045091169, 1.2901335037479669},
  {613.1074497699766, 2.367607205284557},
  {618.4454905848166, 5.06473159584948},
  {620.390684072207, 6.562398386918119},
  {622.0937174470288, 7.99792515487475},
  {623.3132568106007, 9.41364662263345},
  {624.2913669431194, 10.859648034918592},
  {625.2704303993542, 12.426197231079954},
  {626.4444485554916, 14.197563260984992},
  {627.2299872973974, 15.740117299217033},
  {628.2103615737417, 17.472419698208213},
  {629.3872635341196, 19.608442774338826},
  {634.7219200497682, 31.04532439549719},
  {635.9106352798591, 33.65650188645466},
  {636.5681108692618, 35.30360693661004},
  {637.5461415581376, 36.73956270023882},
  {638.7189680596301, 38.36024400029859},
  {639.5029179286762, 39.70188506540358},
  {640.723092841392, 41.197971722413094},
  {642.1371102430085, 42.75823613197735},
  {644.1328934422563, 44.5411707451749},
  {646.319150719942, 45.962347607897875},
  {648.988091683719, 47.300864154523985},
  {652.3824802178426, 48.695207337953505},
  {656.9849537866487, 50.05687210105316},
  {662.309786734734, 51.08386174046022},
  {667.6306763892669, 51.61222191019745},
  {672.9496593963681, 51.89948651218223},
  {678.2680790758191, 52.115518332785605},
  {683.5857620960348, 52.23839959312099},
  {688.9028817886006, 52.29004807207497},
  {694.2196981508928, 52.30334043797742}};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_green2s[] = {
  {400.90555767194206, 0.24580482497685807},
  {418.7886167858537, 0.19217015177450492},
  {438.6050535381037, 0.14208815701734068},
  {457.9385884953515, 0.14708660659142936},
  {504.8254754857596, 0.5467415747470028},
  {510.26693892390654, 1.0421535768756627},
  {513.8683399375249, 3.147386283073601},
  {516.2135339327947, 4.293440276877746},
  {518.1578376513836, 5.678595802995233},
  {519.8599971461325, 7.003620435732003},
  {520.8390606023672, 8.570169631893364},
  {522.3003469715641, 9.99579374975103},
  {524.0031420154569, 11.4011835717386},
  {526.4309397452956, 12.806144398054016},
  {530.5504826305021, 14.219236642337151},
  {535.6252067684298, 14.178973448524857},
  {538.9963024264283, 12.62793244591198},
  {540.9182030376934, 11.180215050938202},
  {542.8414144690678, 9.898250858794242},
  {545.006579459539, 8.652308003255754},
  {547.6538323087792, 7.24836246669777},
  {550.5436742662602, 5.9608034559961},
  {553.916533573133, 4.632775853554222},
  {557.7733238312924, 3.3798046189202324},
  {561.4427594980621, 2.203961245085125},
  {568.1474900067901, 1.1558504298662058},
  {571.5272825770514, 0.7045339828877957},
  {598.1067711015182, 0.19017467190550974},
  {640.8819999882869, 0.17376802492088927},
  {659.9740714092723, 0.20470852528343642},
  {679.790363718535, 0.13636171478746917},
  {697.6740233025794, 0.1586564898707934},
};
const static spectra_entry dufaycolor_photography_its_materials_and_processes_blue3s[] = {
  {401.98120189987145, 34.39766340938526},
  {403.12169483866614, 36.00429986780044},
  {404.58250454600505, 37.36965009372},
  {406.28613374814927, 38.880519226599276},
  {408.4715092013977, 40.190189389236735},
  {411.6240911471642, 41.56709568607503},
  {416.22651596646205, 42.922596073862834},
  {421.0591690649968, 42.831456159977485},
  {424.9148111733634, 41.433301384048114},
  {427.80381783768365, 40.04011955318822},
  {430.21076955560136, 38.80910217207687},
  {432.615623961344, 37.31287966643784},
  {434.779668796449, 35.92529316484479},
  {436.70288022782347, 34.64332897270083},
  {438.6250191700175, 33.22574852369611},
  {440.5460856230311, 31.672551817830637},
  {442.46774790336724, 30.194697476887825},
  {443.67036577098173, 29.470695780843542},
  {457.3322096126915, 15.147495527770971},
  {459.2537527275631, 13.65457271384362},
  {461.1752958424347, 12.161649899916256},
  {463.0976731155577, 10.7742063968806},
  {465.2613366211763, 9.338400781737064},
  {467.666191026919, 7.842178276098039},
  {470.3133008776018, 6.420150571958615},
  {473.4437549315221, 4.998984944836579},
  {476.817090900253, 3.7312312343328244},
  {485.01488867449353, 1.3365486069264563},
  {488.1517353623356, 0.7237315392168426},
  {445.7633661906913, 26.92562990900859},
  {448.9388235459274, 23.46221247862087},
  {452.46804538105727, 19.73231353078944},
  {499.28779161587545, 0.0892249235498781},
  {519.2172258968702, 0.16618975533627633},
  {539.8576987059052, 0.15397645781615665},
  {559.7864310732494, 0.14218430848634966},
  {580.0710336614391, 0.13018158506137922},
  {599.6445977215883, 0.2073569909429267},
  {619.5733300889326, 0.19556484161314813},
  {639.8579326771221, 0.1835621181881777},
  {659.4307948236208, 0.17198054295356258},
  {679.7153974118105, 0.15997781952863477},
  {700.0000000000001, 0.1479750961036217},
};
const static spectra_entry dufaycolor_harrison_horner_narrow_cut_red[] = {
  {401.2469682153842, 0.08988909013010016},
  {404.2529551789895, -0.09764255667209909},
  {407.2559280702626, -0.1218401885175524},
  {410.25856606460985, -0.12788959647889442},
  {413.2620971174259, -0.18233426813117148},
  {416.2635071563785, -0.1218401885175524},
  {419.2660335184172, -0.1218401885175524},
  {422.2685598804559, -0.1218401885175524},
  {425.27108624249456, -0.1218401885175524},
  {428.2732777076074, -0.10369196463346952},
  {431.27513427579447, -0.06739551686530376},
  {434.2774373732159, -0.05529670094256289},
  {435.91517902523697, -0.05529670094256289},
  {441.1009143940694, -0.031099069097138},
  {444.10243606533066, 0.023345602555139067},
  {447.10518569198655, 0.011246786632398198},
  {450.1078236863338, 0.005197378671056185},
  {453.1094569899036, 0.053592642361934395},
  {456.1119833519423, 0.053592642361934395},
  {459.11450971398096, 0.053592642361934395},
  {462.1162546498594, 0.09593849809147059},
  {465.11788795342926, 0.14433376178237722},
  {468.1207492123937, 0.12618553789829434},
  {471.12294067750656, 0.14433376178237722},
  {474.1255786718539, 0.1382843538210068},
  {477.1292213569785, 0.07779027420738771},
  {480.1317477190172, 0.07779027420738771},
  {483.1342740810559, 0.07779027420738771},
  {486.13382358153183, 0.23910781984369578},
  {489.12830710152696, 0.6749532601074861},
  {492.13336911171814, 0.537545279270887},
  {495.1357838414482, 0.543594687232229},
  {498.13831020348687, 0.543594687232229},
  {501.1373759639589, 0.7311263340344567},
  {504.14191170755237, 0.622236990729931},
  {507.1435450111222, 0.6706322544208376},
  {510.1459597408523, 0.6766816623821796},
  {513.148486102891, 0.6766816623821796},
  {516.1510124649296, 0.6766816623821796},
  {519.1535388269683, 0.6766816623821796},
  {522.156065189007, 0.6766816623821796},
  {525.1598195064403, 0.6101381748072185},
  {528.162345868479, 0.6101381748072185},
  {531.1647605982089, 0.6161875827685606},
  {534.1670636956304, 0.6282863986913014},
  {537.1690318961261, 0.6585334384980968},
  {540.1713349935476, 0.6706322544208376},
  {543.1738613555862, 0.6706322544208376},
  {546.1762760853163, 0.6766816623821796},
  {549.1795838735152, 0.6343358066526434},
  {552.1825567647882, 0.6101381748072185},
  {555.1859761852957, 0.5617429111163119},
  {558.1887258119516, 0.5496440951935995},
  {561.1921452324591, 0.5012488315026928},
  {564.1938901683375, 0.543594687232229},
  {567.1970863242277, 0.5072982394640633},
  {570.1989428924148, 0.543594687232229},
  {573.2014692544535, 0.543594687232229},
  {576.2038839841836, 0.5496440951935995},
  {579.2052940231362, 0.6101381748072185},
  {582.2078203851748, 0.6101381748072185},
  {585.2103467472135, 0.6101381748072185},
  {587.2575238122399, 0.6101381748072185},
  {591.1845889541169, 2.2797747721430426},
  {593.6169293787639, 3.5950889031705344},
  {596.4287718102385, 6.532508568980319},
  {597.8990905153134, 8.209404455869773},
  {599.0969434605427, 9.85968294772924},
  {600.1589933102373, 11.473362521422473},
  {601.0880438958816, 12.89850221365326},
  {602.0440013231845, 14.3447140102828},
  {602.9391457214208, 16.128079477292218},
  {603.728586549807, 17.722905062839217},
  {604.3817126345773, 19.308858183376202},
  {605.0348387193478, 20.894811303913187},
  {605.821168727401, 22.65821372465011},
  {606.499093663736, 24.379471936589567},
  {607.3564721685092, 26.09629391602401},
  {608.1801587515605, 27.94842098686091},
  {608.969967966565, 29.523283526135415},
  {609.5561851008455, 31.037147868466178},
  {610.4118799701779, 32.73955209225937},
  {611.1996425928581, 34.42532044415884},
  {611.9609690901143, 36.0645083547558},
  {612.640121981844, 37.71922307912028},
  {613.4258380121998, 39.5158972436447},
  {614.212168020253, 41.27929966438164},
  {615.0003399613981, 42.94288685375609},
  {615.7877341974599, 44.64861825192804},
  {616.3508569992116, 46.18133658240505},
  {617.2767353667531, 47.77838028420453},
  {618.048961429988, 49.31997107969154},
  {618.8902512130603, 51.063410454155985},
  {619.5334542487609, 52.44751499571554},
  {620.2546149097998, 54.04455869751503},
  {621.179879299644, 55.674874143102},
  {622.3037216190177, 57.637907026563866},
  {622.8933156306332, 58.96877677806344},
  {623.8509103317956, 60.32626392459301},
  {624.7069472744166, 61.763603256212534},
  {625.6761695436849, 63.47709806126824},
  {626.7376054156821, 65.12404937874896},
  {627.7990412876793, 66.77100069622968},
  {628.8623190927685, 68.31813678234793},
  {629.9274388309498, 69.76545763710371},
  {630.9916376025849, 71.26268610754073},
  {632.1901659232813, 72.87636568123396},
  {633.5257252949069, 74.46010068551846},
  {634.8634949862428, 75.92405741216798},
  {636.3387255128963, 77.33477934875754},
  {637.9494521462359, 78.79873607540705},
  {639.6954292951825, 80.32923628963157},
  {641.5798145593225, 81.75516816623825},
  {645.625030982235, 84.41796391507191},
  {648.3293590969363, 85.78580227077981},
  {651.3111218495751, 86.91099215159309},
  {654.2982429530268, 87.745810450261},
  {657.2912805688343, 88.26001012697674},
  {660.28844858006, 88.55038170912209},
  {663.2891888251611, 88.64717223650389},
  {666.2899290702621, 88.74396276388569},
  {669.2930135938439, 88.71371572407887},
  {672.295651588191, 88.7076663161175},
  {675.2998524348588, 88.61692519669708},
  {678.3009275768857, 88.69556750019478},
  {681.3031190419986, 88.71371572407887},
  {684.3056454040371, 88.71371572407887},
  {687.3088415599275, 88.6774192763107},
  {690.3119260835091, 88.64717223650389},
  {693.3144524455477, 88.64717223650389},
  {696.3164206460434, 88.6774192763107},
  {698.0899709752147, 88.71371572407887},
};
const static spectra_entry dufaycolor_harrison_horner_narrow_cut_green[] = {
  {401.247861273853, 0.04149382643922195},
  {404.2529551789895, -0.09764255667209909},
  {407.2559280702626, -0.1218401885175524},
  {410.25856606460985, -0.12788959647889442},
  {413.2620971174259, -0.18233426813117148},
  {416.2635071563785, -0.1218401885175524},
  {419.2660335184172, -0.1218401885175524},
  {422.2685598804559, -0.1218401885175524},
  {425.27108624249456, -0.1218401885175524},
  {428.2732777076074, -0.10369196463346952},
  {431.27513427579447, -0.06739551686530376},
  {434.2774373732159, -0.05529670094256289},
  {435.91517902523697, -0.05529670094256289},
  {441.1009143940694, -0.031099069097138},
  {444.10243606533066, 0.023345602555139067},
  {447.10518569198655, 0.011246786632398198},
  {450.1078236863338, 0.005197378671056185},
  {453.1094569899036, 0.053592642361934395},
  {456.1119833519423, 0.053592642361934395},
  {459.11450971398096, 0.053592642361934395},
  {462.1162546498594, 0.09593849809147059},
  {465.11788795342926, 0.14433376178237722},
  {468.1207492123937, 0.12618553789829434},
  {471.12294067750656, 0.14433376178237722},
  {474.1255786718539, 0.1382843538210068},
  {477.1292213569785, 0.07779027420738771},
  {480.1317477190172, 0.07779027420738771},
  {483.1342740810559, 0.07779027420738771},
  {486.1362422815515, 0.10803731401418304},
  {489.1358662035666, 0.26532192100958696},
  {492.1351552286558, 0.4407547518891022},
  {495.13701179684284, 0.47705119965726794},
  {498.13953815888146, 0.47705119965726794},
  {503.0175032528993, 2.3877999143102215},
  {504.76312955744754, 3.937312553556154},
  {506.2359041733117, 5.481121465295644},
  {507.5717091360163, 7.051547772065135},
  {508.7675359548445, 8.811623018423319},
  {510.09988217652096, 10.56948014852901},
  {510.82615931837074, 11.88925931876608},
  {511.81818939724224, 13.599426949443043},
  {512.6102907956501, 15.05007497857757},
  {513.2941917815723, 16.447488217652122},
  {514.0833460870331, 18.0578406169666},
  {514.9414262806032, 19.7366377463582},
  {515.6562516942183, 21.571336760925476},
  {516.5474666351918, 23.567641388174835},
  {517.2446529290023, 25.231228577549288},
  {517.8440998208081, 27.26080494858614},
  {518.5219838252967, 28.98428127677809},
  {519.2802813659127, 30.787609790060003},
  {520.0405436351601, 32.484468723221966},
  {520.6088764762289, 34.227908097686395},
  {521.2854097297834, 36.02458226221083},
  {522.1788349904672, 37.90110861182522},
  {522.9672525226912, 39.55138710368469},
  {523.8662854463437, 41.12403152670667},
  {524.5208441457412, 42.63235057840619},
  {525.5792101292519, 44.44566061482436},
  {526.8121713216258, 46.306501713796095},
  {527.6965560739707, 48.0390089438732},
  {528.895084394667, 49.65268851756643},
  {530.3664673277506, 51.27191338189091},
  {532.2496392550125, 52.76359656169669},
  {534.8175292103791, 54.12925040897409},
  {537.8046503138308, 54.964068707642},
  {540.8060603527834, 55.02456278725562},
  {543.8208662687683, 54.35912791150584},
  {546.7126119172453, 52.96655419880037},
  {549.0602170406747, 51.47788131962298},
  {550.4427193928146, 50.51775385604115},
  {552.3916600262717, 48.44539952870612},
  {554.0579604123275, 46.897788131962315},
  {555.4492689588689, 45.46044880034279},
  {556.9795937508941, 43.88558626106828},
  {558.5095092244545, 42.33290488431879},
  {559.9027824996272, 40.78909597257929},
  {561.434498974433, 39.13881748071982},
  {562.9689169511071, 37.34214331619539},
  {564.6398133987828, 35.54546915167097},
  {565.8954416453289, 34.064876553127704},
  {567.1536485982036, 32.44454263067698},
  {568.4097680269075, 30.937332637103708},
  {569.6682205708612, 29.30369001713798},
  {571.0622306192706, 27.719955012853504},
  {572.4555038944434, 26.176146101113986},
  {573.8512330804053, 24.49925021422453},
  {575.2452431288148, 22.91551520994004},
  {576.6387619950664, 21.358397600685535},
  {577.8956795947768, 19.807934340188538},
  {579.1518604212504, 18.297397172236515},
  {580.5478351982913, 16.607192587832074},
  {581.9403717002272, 15.103309768637544},
  {583.3319258378474, 13.652661739503017},
  {584.8612273337105, 12.133252106541008},
  {586.3894646015649, 10.671513496143987},
  {588.0537651745497, 9.232272922022304},
  {589.9920050538535, 7.739797557840632},
  {591.9253331115789, 6.513496143958889},
  {597.9802695301285, 3.8102749863675456},
  {600.999094209223, 2.927061424008741},
  {604.0118907436529, 2.370515891563457},
  {606.9694839054191, 1.8471340777635135},
  {611.9736579625253, 0.8630034275921332},
  {615.2301403844787, 0.9065591649139435},
  {618.2341179665292, 0.8279168614162415},
  {621.2385420778141, 0.7250769260730863},
  {624.2431894537161, 0.6101381748072185},
  {627.2466088742236, 0.5617429111163119},
  {630.2488003393365, 0.5798911350003948},
  {633.2519964952268, 0.543594687232229},
  {636.2545228572653, 0.543594687232229},
  {639.257607380847, 0.5133476474254337},
  {642.2608035367374, 0.47705119965726794},
  {645.2633298987761, 0.47705119965726794},
  {648.2648515700373, 0.5314958713095166},
  {651.2671546674587, 0.543594687232229},
  {653.450564612408, 0.556903384747244},
  {664.0961309416239, 0.543594687232229},
  {667.0986573036625, 0.543594687232229},
  {670.1027465180217, 0.45890297577318506},
  {673.1049379831345, 0.47705119965726794},
  {675.8345074031697, 0.47705119965726794},
  {683.4630128437672, 1.2513754187115467},
  {686.4554922980317, 1.79582213523409},
  {689.444064621495, 2.5519981304043142},
  {692.427501858763, 3.5864468917971806},
  {695.2695153137579, 4.888884425878331},
  {697.7010161039696, 6.249698746786663},
};
const static spectra_entry dufaycolor_harrison_horner_narrow_cut_blue[] = {
  {402.12044318777356, 56.29753106255359},
  {404.1398158342218, 57.80426574550131},
  {406.5683081337167, 59.328111610968335},
  {409.40883687900725, 60.71100627093561},
  {412.3957347178417, 61.55792338552625},
  {415.39223293521593, 61.88459141543977},
  {418.3959872526492, 61.8180479278648},
  {421.4077790963018, 61.315947067071775},
  {424.4267154077049, 60.426684096751615},
  {427.45223802531547, 59.180506056711096},
  {430.20931860762596, 57.68966307245552},
  {432.55604125993653, 56.24881172343619},
  {434.63038683806883, 54.776537060839786},
  {436.5670479175796, 53.36961760925453},
  {438.3674936593875, 51.9484388389032},
  {440.03347828548476, 50.41793862467868},
  {441.5613880985673, 48.97394494430165},
  {442.9536790094243, 47.483370822622135},
  {444.3457243292024, 46.006105398457606},
  {445.73875201329616, 44.4756051842331},
  {446.9924769289806, 43.098154991431045},
  {448.11101272682754, 41.65083413667526},
  {449.22954852467456, 40.20351328191947},
  {450.48732569316115, 38.60646958011999},
  {451.8828092880442, 36.942882390745524},
  {453.13905151228755, 35.42901804841476},
  {454.25728032128586, 33.99833306555273},
  {455.3773510633761, 32.46783285132821},
  {456.63359328761953, 30.95396850899745},
  {457.8932123891981, 29.2571095758355},
  {459.0132831312883, 27.726609361610997},
  {460.105198610402, 26.242689588688975},
  {460.97709079613014, 24.848603523993162},
  {462.1751805613284, 23.527715295629847},
  {463.49141717770874, 21.721059607969167},
  {464.61210189749636, 20.15728764995717},
  {465.73033070649467, 18.726602667095136},
  {466.85162940397953, 17.129558965295644},
  {467.9686302575833, 15.765417470008586},
  {469.22732839261585, 14.118466152527873},
  {470.4838776057079, 12.587965938303356},
  {471.740181227721, 11.070774421593853},
  {473.1337000939726, 9.513656812339349},
  {474.6607094064324, 8.11846168951729},
  {476.4622661555021, 6.637076906598139},
  {478.5368529391583, 5.1517312017994925},
  {481.15737752803057, 3.6650891952948825},
  {484.18557932104756, 2.273725364181672},
  {487.20429236783343, 1.3965612097842381},
  {490.21519115301726, 0.9428556126821093},
  {493.2200617935365, 0.8158180454935007},
  {496.2226997878838, 0.8097686375321587},
  {498.13339838190836, 0.8097686375321587},
  {505.23362784325786, 0.6282863986913014},
  {508.2352611468277, 0.6766816623821796},
  {511.2377875088664, 0.6766816623821796},
  {514.2403138709051, 0.6766816623821796},
  {517.2428402329438, 0.6766816623821796},
  {520.2453665949823, 0.6766816623821796},
  {523.2483394862554, 0.6524840305367547},
  {526.2516472744543, 0.6101381748072185},
  {529.254173636493, 0.6101381748072185},
  {532.256588366223, 0.6161875827685606},
  {535.2587798313359, 0.6343358066526434},
  {538.2605247672143, 0.6766816623821796},
  {541.263609290796, 0.6464346225753843},
  {544.2652425943659, 0.6948298862662909},
  {547.2681038533303, 0.6766816623821796},
  {550.2718581707636, 0.6101381748072185},
  {553.2744961651108, 0.6040887668458481},
  {556.2779155856183, 0.5556935031549699},
  {559.2812233738173, 0.5133476474254337},
  {562.2835264712387, 0.5254464633481462},
  {565.2859412009688, 0.5314958713095166},
  {568.2886908276246, 0.5193970553868041},
  {571.2907706604288, 0.543594687232229},
  {574.2932970224675, 0.543594687232229},
  {577.2952652229632, 0.5738417270390528},
  {580.2971217911502, 0.6101381748072185},
  {583.2996481531889, 0.6101381748072185},
  {584.9373898052099, 0.6101381748072185},
  {624.5162580280282, 0.6040887668458481},
  {627.5195658162272, 0.5617429111163119},
  {630.5217572813401, 0.5798911350003948},
  {633.5249534372302, 0.543594687232229},
  {636.5274797992689, 0.543594687232229},
  {639.5306759551593, 0.5072982394640633},
  {642.5337604787409, 0.47705119965726794},
  {645.5362868407796, 0.47705119965726794},
  {648.5376968797323, 0.537545279270887},
  {651.5401116094622, 0.543594687232229},
  {653.314331732485, 0.543594687232229},
  {658.6125446259699, 1.86841503077045},
  {661.4560093009767, 3.0922102613539266},
  {663.7499059944082, 4.514022779205959},
  {665.4956784841224, 6.055613574692956},
  {667.1088610282512, 7.386483326192533},
  {668.180836850719, 8.462269708654688},
  {670.8588321441803, 11.257096186803793},
  {672.3347994440704, 12.627892030848344},
  {673.8073284688558, 14.185009640102848},
  {675.279857493641, 15.742127249357353},
  {676.6193463225295, 17.112923093401903},
  {677.9566248317076, 18.603497215081433},
  {679.4295222431113, 20.14065177806343},
  {681.0382022841264, 21.715514317337934},
  {682.648519599001, 23.20165220651245},
  {684.5292867802818, 24.823649716152545},
  {686.6846993422337, 26.354149930377062},
  {689.0690598019571, 27.804243430448466},
  {691.9557437226126, 29.151244936511674},
  {694.9396274891149, 30.16149606605906},
  {697.3840720455089, 30.820881533847498},
};

// https://www.gujinwei.org/research/camspec/db.html
// 400 to 720, 10nm
luminosity_t phase_one_red[] = {0.010464, 0.015837, 0.022809, 0.029193,
	0.032943, 0.042109, 0.048271, 0.054768, 0.055121, 0.048086, 0.037059,
	0.037067, 0.052124, 0.064936, 0.076516, 0.13492, 0.29332, 0.63001,
	0.7694, 0.81813, 0.65358, 0.52142, 0.37956, 0.2838, 0.18967, 0.1305,
	0.078487, 0.042293, 0.023358, 0.012703, 0.0063621, 0.0033125, 0.0017011};
luminosity_t phase_one_green[] = {0.0064171, 0.013114, 0.025186, 0.033325,
	0.045721, 0.073911, 0.11369, 0.17692, 0.26413, 0.41186, 0.5986,
	0.75879, 0.91359, 1, 0.90399, 0.77751, 0.55129, 0.41299, 0.30832,
	0.20757, 0.10815, 0.059445, 0.030895, 0.018277, 0.01124, 0.0068513,
	0.0034711, 0.00181, 0.001035, 0.00060223, 0.00034704, 0.00023128,
	0.00015694};
luminosity_t phase_one_blue[] = {0.086173, 0.15791, 0.26574, 0.37978, 0.42988,
	0.50637, 0.52789, 0.55929, 0.53494, 0.48996, 0.40612, 0.30199, 0.25274,
	0.20297, 0.14868, 0.11294, 0.077274, 0.057152, 0.044852, 0.038781,
	0.027546, 0.021149, 0.015703, 0.012548, 0.0094433, 0.007636, 0.0054527,
	0.0033028, 0.0020177, 0.0012756, 0.00078306, 0.00052376, 0.00031011};
luminosity_t nikon_d3_red[] = {0.0022762, 0.0027981, 0.033777, 0.053485,
	0.040295, 0.030923, 0.026542, 0.028605, 0.033014, 0.028928, 0.031274,
	0.040259, 0.061924, 0.074348, 0.038663, 0.021882, 0.025806, 0.093019,
	0.4662, 0.71759, 0.67238, 0.60074, 0.48987, 0.39157, 0.30163, 0.23531,
	0.15657, 0.069783, 0.014991, 0.0031496, 0.0010609, 0.00047839,
	0.00025838};
luminosity_t nikon_d3_green[] = {0.0016372, 0.0017201, 0.015367, 0.038209,
	0.053617, 0.072599, 0.11985, 0.22829, 0.34829, 0.38695, 0.56813,
	0.79771, 0.90616, 1, 0.92902, 0.87187, 0.73808, 0.6016, 0.41735,
	0.26827, 0.12938, 0.057778, 0.027126, 0.016111, 0.01036, 0.0069106,
	0.0050914, 0.0033023, 0.0011953, 0.00037838, 0.00020989, 0.00012985,
	9.065e-05};
luminosity_t nikon_d3_blue[] = {0.007214, 0.0137, 0.27324, 0.64383, 0.75208,
	0.86078, 0.89124, 0.8552, 0.81283, 0.62369, 0.4505, 0.28966, 0.13296,
	0.064311, 0.031574, 0.015213, 0.0080397, 0.0056782, 0.0042467,
	0.0026458, 0.0016533, 0.0011252, 0.00071852, 0.00047297, 0.00039955,
	0.00034232, 0.000359, 0.00023868, 0.00013739, 4.0654e-05, 4.4266e-05,
	3.9222e-05, 3.7601e-05};
const static spectra_entry kodachrome25_cyan[] = {
   {422.2956821585086, 0.14126821482325203},
   {427.25233888804934, 0.11896284031701998},
   {432.20899561759006, 0.09844695040648976},
   {437.16565234713084, 0.08051587157864004},
   {442.12230907667157, 0.06497077221172676},
   {447.0789658062123, 0.05360113690145063},
   {452.0356225357531, 0.04461748105211116},
   {456.9922792652938, 0.037920388852834774},
   {461.9489359948345, 0.03211803895140952},
   {466.90559272437525, 0.02780692621306935},
   {471.86224945391604, 0.02409230833996312},
   {476.81890618345676, 0.021073601142963305},
   {481.77556291299754, 0.01835314137858024},
   {486.7322196425382, 0.01603034485768684},
   {491.688876372079, 0.014105211580282662},
   {496.6455331016197, 0.014068978709452562},
   {503.40461046008437, 0.014218401870974562},
   {508.3612671896251, 0.015971653595846513},
   {513.3179239191659, 0.017625489509845993},
   {518.2745806487065, 0.01997523609995211},
   {523.2312373782473, 0.023319140798781612},
   {528.187894107788, 0.027259540362844614},
   {532.2433405228669, 0.03099349384116379},
   {543.0578642964103, 0.04792874622267207},
   {548.014521025951, 0.05932533160216025},
   {552.9711777554917, 0.0743008861730523},
   {557.9278344850325, 0.09225891507011452},
   {562.8844912145732, 0.11310000248247376},
   {567.6158453654984, 0.13734275757534142},
   {571.6712917805772, 0.16115302394639275},
   {575.0508304598096, 0.18362469749082044},
   {578.2050665604264, 0.2076602664404874},
   {581.1340000824277, 0.23216615687579778},
   {583.6123284471981, 0.25533180753581064},
   {585.865354233353, 0.279373964280174},
   {588.1183800195079, 0.30516583929589003},
   {590.1461032270473, 0.3310687186522401},
   {591.9485238559712, 0.3551141692939517},
   {593.7509444848951, 0.38107337429495547},
   {595.102759956588, 0.4015680035953293},
   {597.8063908999738, 0.4485719187538528},
   {599.3835089502822, 0.47589973810302544},
   {600.7353244219753, 0.5021356304812763},
   {602.0871398936681, 0.5283715228595274},
   {603.4389553653612, 0.5564300384371044},
   {604.790770837054, 0.5852176032944119},
   {606.1425863087469, 0.6154632667111799},
   {607.4944017804398, 0.6464379794076789},
   {608.8462172521328, 0.6792353153035036},
   {610.1980327238257, 0.7120326511993282},
   {611.7751507741341, 0.744828340146479},
   {612.7214216043192, 0.770192337896667},
   {613.9831160445659, 0.7999283255970934},
   {614.9293868747509, 0.8284636877141086},
   {616.2812023464439, 0.8599851873704052},
   {617.5879573024138, 0.8928557575839379},
   {618.5792886483218, 0.9215001477031778},
   {619.7508620571225, 0.9516742237509123},
   {621.0125564973691, 0.9875342254010745},
   {622.3643719690621, 1.0203315612968993},
   {623.4908848621395, 1.0480727647632682},
   {624.6173977552169, 1.073900213870345},
   {625.9692132269099, 1.1030523033675177},
   {627.3210286986027, 1.1314753435849598},
   {628.6728441702958, 1.1569821866834804},
   {630.2499622206042, 1.184310006032653},
   {632.052382849528, 1.20944903059396},
   {634.0801060570675, 1.2328366899352399},
   {637.6849473149152, 1.2574256935284438},
   {642.641604044456, 1.2626584986338474},
   {647.1476556167657, 1.2442115422465683},
   {650.527194295998, 1.219338408398978},
   {653.0055226607685, 1.1963916921160411},
   {655.2585484469233, 1.1720978816142769},
   {657.5115742330781, 1.1456169232733213},
   {659.5392974406176, 1.1198484349287772},
   {661.3417180695415, 1.0955032396283815},
   {663.1441386984654, 1.0707206147601473},
   {664.9465593273893, 1.045172488148196},
   {667.4248876921597, 1.0204396011299197},
   {668.5514005852372, 0.9904674409896286},
   {670.353821214161, 0.9642084913299404},
   {672.1562418430849, 0.9379495416702522},
   {675.7610831009328, 0.8854316423508758},
   {677.5635037298566, 0.8588992992112887},
   {679.8615900317346, 0.8390341336941521},
   {681.1683449877045, 0.8099355151305981},
   {685.0735896837062, 0.7639768633972303},
   {686.5756068744762, 0.7377201096691075},
   {687.7021197675537, 0.7234954139709937},
   {694.4611971260183, 0.6385846693501489},
   {696.0383151763267, 0.6189981675486682}
};
const static spectra_entry kodachrome25_magenta[] = {
   {422.7462873157396, 0.3120612840045691},
   {427.70294404528033, 0.29502494747457075},
   {432.65960077482106, 0.2788833532424231},
   {437.6162575043618, 0.2641335803624878},
   {442.57291423390257, 0.251173292078255},
   {447.5295709634433, 0.24089723068757474},
   {452.486227692984, 0.23519429659702196},
   {457.4428844225248, 0.23585397440229827},
   {462.3995411520655, 0.2452622435643399},
   {466.90559272437525, 0.2650793281617001},
   {470.51043398222305, 0.28859085372849735},
   {473.4393675042244, 0.3135133437522253},
   {475.91769586899477, 0.3390119521073751},
   {478.1707216551497, 0.36524125669092977},
   {480.42374744130456, 0.39256413519408007},
   {482.00086549161296, 0.41169015014628507},
   {485.8310093280762, 0.4636069131996188},
   {487.8587325356157, 0.4901112582117464},
   {489.66115316453954, 0.5149768892931545},
   {491.46357379346347, 0.5406627008142595},
   {493.2659944223874, 0.5663485123353644},
   {495.06841505131126, 0.5925811108162673},
   {496.8708356802352, 0.6199072832167656},
   {498.6732563091591, 0.6461398816976685},
   {500.475676938083, 0.6742862345378633},
   {502.2780975670069, 0.7016124069383618},
   {504.08051819593084, 0.7292119728187592},
   {505.8829388248547, 0.7570849321790554},
   {507.6853594537786, 0.783864317619756},
   {509.48778008270256, 0.8100969161006587},
   {511.2902007116264, 0.8363295145815616},
   {513.0926213405503, 0.8611951456629697},
   {516.4721600197827, 0.9056242212644213},
   {518.7251858059376, 0.9307599519283802},
   {520.9782115920924, 0.9550208234566627},
   {523.4565399568628, 0.9793165005002575},
   {526.3854734788641, 1.0044733277924702},
   {529.7650121580964, 1.0282533844192712},
   {534.0457611517908, 1.0497083345192462},
   {539.0024178813314, 1.0618008305748405},
   {543.9590746108722, 1.058285044323479},
   {548.915731340413, 1.0397574706303954},
   {552.9711777554917, 1.0144336028166014},
   {555.9001112774931, 0.9898328167672124},
   {558.3784396422634, 0.9656831691727203},
   {560.6314654284183, 0.941170643887037},
   {562.6591886359577, 0.9166050868540478},
   {564.4616092648816, 0.892533285033551},
   {566.2640298938055, 0.8665477288537617},
   {568.0664505227294, 0.8400153857141747},
   {569.6435685730379, 0.815125050402655},
   {571.2206866233463, 0.7891411411715399},
   {573.0231072522702, 0.7596014697530648},
   {574.6002253025786, 0.7330707735621518},
   {575.9520407742715, 0.7100958395585986},
   {577.3038562459644, 0.6874854301949109},
   {578.8809742962728, 0.6611369963239304},
   {580.6833949251968, 0.6313239314255563},
   {582.4858155541207, 0.6020576534869801},
   {584.2882361830445, 0.5741583429478985},
   {586.0906568119685, 0.5457122454490191},
   {587.8930774408924, 0.518633115349634},
   {589.6954980698163, 0.49237416568994585},
   {591.4979186987402, 0.46666200299005545},
   {593.3003393276641, 0.4420434142097609},
   {594.4268522207416, 0.4278187185116469},
   {597.8063908999738, 0.3829574835781142},
   {599.8341141075133, 0.3573530313215092},
   {602.0871398936681, 0.33109078776447287},
   {604.340165679823, 0.3059221181270322},
   {606.593191465978, 0.2827218815448638},
   {609.0715198307483, 0.2585722339503713},
   {611.7751507741341, 0.23449384433517806},
   {614.929386874751, 0.2101843329227211},
   {618.7595307112143, 0.18571799539763112},
   {623.265582283524, 0.16296302053921763},
   {628.2222390130648, 0.1426459622504319},
   {633.1788957426056, 0.12670319964002918},
   {638.1355524721463, 0.11205284257096615},
   {643.092209201687, 0.09839664361062694},
   {648.0488659312277, 0.08513810789377696},
   {653.0055226607685, 0.07327139352913958},
   {657.9621793903093, 0.06379065862543798},
   {662.91883611985, 0.05659648737180012},
   {667.8754928493908, 0.051589463957353754},
   {672.8321495789314, 0.04757659865163055},
   {677.7888063084722, 0.04465730726550299},
   {682.745463038013, 0.042036263311992395},
   {687.7021197675538, 0.03961405098022652},
   {692.6587764970944, 0.03719183864846065},
   {696.4889203335576, 0.03502640058724582}
};
const static spectra_entry kodachrome25_yellow[] = {
   {421.3944718440466, 0.6515477553082332},
   {424.323405366048, 0.6762098705892003},
   {427.25233888804934, 0.7005595361788544},
   {430.63187756728166, 0.7227773443490901},
   {434.9126265609759, 0.7465188580991287},
   {439.8692832905167, 0.7637809763200843},
   {444.82594002005743, 0.7700079395342112},
   {449.78259674959816, 0.7638079263892967},
   {454.5139509005234, 0.7464153398888318},
   {458.5693973156022, 0.7221630324936547},
   {461.9489359948345, 0.6970251843242576},
   {464.87786951683586, 0.6719036487893468},
   {467.5815004602217, 0.6452735866950972},
   {470.0598288249921, 0.6190096961893867},
   {472.312854611147, 0.5931848822001886},
   {474.56588039730184, 0.5656103499396374},
   {476.59360360484123, 0.5394044320272549},
   {478.39602423376516, 0.5150592367268589},
   {480.19844486268903, 0.49071404142646324},
   {482.00086549161296, 0.4663688461260673},
   {483.3526809633059, 0.4505021425998861},
   {486.50691706392274, 0.4064627350547241},
   {488.3093376928466, 0.3826643267141261},
   {490.11175832177054, 0.3596860988132249},
   {491.91417895069446, 0.33698126439222253},
   {493.9419021582338, 0.3119782777913953},
   {496.1949279443887, 0.28549731945043977},
   {498.4479537305436, 0.25923507589340344},
   {500.70097951669845, 0.23494126539163895},
   {502.9540053028534, 0.21108488445771312},
   {505.43233366762377, 0.18569585308767933},
   {508.1359646110096, 0.16143520115255328},
   {511.06489813301096, 0.136756302680336},
   {514.4444368122432, 0.11181373556800978},
   {518.7251858059376, 0.08767410940666154},
   {523.6818425354783, 0.06825179341572718},
   {528.638499265019, 0.05429734702277056},
   {533.3698534159444, 0.04442059582425406},
   {543.9590746108722, 0.03014329758364065},
   {548.915731340413, 0.024224962569530994},
   {553.6846359211074, 0.01208760795737418},
   {558.8290447994945, 0.00895844706621629},
   {563.7857015290352, 0.006221418000021295},
   {568.7423582585759, 0.0037329284610074787},
   {573.6990149881167, 0.0021060426162198276},
   {578.6556717176575, 0.0013407604656594518},
   {583.6123284471981, 0.00031036948610618786},
   {588.5689851767389, 0.0002741366152763103},
   {593.5256419062796, -0.00045800693166020423},
   {597.3557857427429, -0.0008836683026089975},
   {604.790770837054, 0.0001555563107418223},
   {609.7474275665948, 0.00011932343991172267},
   {614.7040842961355, 0.00008309056908184509},
   {619.6607410256763, 0.00004685769825174546},
   {624.617397755217, 0.000010624827421867877},
   {629.5740544847578, 0.00017322357833671198},
   {634.5307112142984, 0.0010317330053575269},
   {639.4873679438392, 0.0009955001345276493},
   {644.44402467338, 0.0009592672636975497},
   {649.4006814029208, 0.0011218660146123938},
   {654.3573381324615, 0.0019803754416334307},
   {659.3139948620021, 0.001944142570803331},
   {664.2706515915429, 0.0022724343398388136},
   {669.2273083210837, 0.002236201469008714},
   {674.1839650506245, 0.0021999685981788364},
   {679.1406217801651, 0.002163735727348959},
   {684.0972785097058, 0.002127502856518859},
   {689.0539352392466, 0.0020912699856889816},
   {694.0105919687874, 0.002055037114858882},
   {698.2350153178277, 0.0032544274867645218}
};
const static spectra_entry dufaycolor_collins_giles_red[] = {
   {399.7403768187472, 0.19742441716989845},
   {413.777152152782, 0},
   {425.7641382575281, 0.05137063916154716},
   {432.39649068025807, 0.06446511581056313},
   {435.1526261980187, 2.241673675569217},
   {443.7849081120283, 4.035616976485315},
   {450.90704432480345, 4.938128597833327},
   {456.77639166586926, 4.8509999647456254},
   {463.41780949551014, 4.469245607054873},
   {470.57394098420104, 3.8910740996287956},
   {478.2583842423083, 2.5242121909577406},
   {483.8953046228539, 1.4494578383033172},
   {490.5661850249551, 0},
   {498.2166330071466, 0},
   {510.4632422931451, 0},
   {522.7075852274158, 0},
   {532.1459329059162, 0},
   {541.582014232689, 0},
   {547.1962710959574, 0},
   {553.2821809354493, 1.4877340008158484},
   {556.3092713931012, 2.97446073419718},
   {560.84424120026, 5.451331355731568},
   {562.3294570324895, 7.428597329733989},
   {564.3112557099473, 9.999143822680608},
   {566.0107676888753, 13.753733184929231},
   {567.4642545969168, 17.112970079120814},
   {567.6513545228827, 20.074839970386307},
   {568.6037258822404, 23.038220762803604},
   {569.050448989459, 25.803169870616458},
   {570.0028203488167, 28.766550663033755},
   {570.4495434560354, 31.531499770846622},
   {571.893964957166, 35.28558549937797},
   {573.6070750464603, 38.44790161011696},
   {574.213701858912, 45.3592671122146},
   {576.1456407983602, 50.1014821940299},
   {578.5809616382198, 55.14084116903455},
   {580.5106342259402, 59.9817684594348},
   {583.435738855845, 65.91054457913845},
   {586.1148184148633, 71.44396823078509},
   {589.3108779846593, 76.68226252411144},
   {593.8050534607191, 80.93595290017474},
   {603.4259683617299, 84.11388165614909},
   {616.1804922515953, 84.13906334201259},
   {622.830975488147, 83.3624601499821},
   {632.0414289095827, 82.19604446078453},
   {639.6986759469573, 82.01372905513276},
   {652.4531998368227, 82.03891074099626},
   {666.182758603323, 84.04035113342765},
   {681.4247294227855, 86.83451099684218},
   {691.5920869070343, 88.43405168289203},
   {699.2448012409535, 88.44916069441014},
};
const static spectra_entry dufaycolor_collins_giles_green[] = {
   {399.5613350322578, 7.995688895380127},
   {406.2503462481806, 5.540978157405647},
   {411.6616387233893, 3.182461459429746},
   {417.0887956606919, 0.1329593013593069},
   {428.31277668377345, 0.15511918491915822},
   {443.110290747745, 0.08561773193594036},
   {451.7425726617546, 1.8795610328519956},
   {457.3069697870133, 3.9635973549156915},
   {467.4131357746138, 8.228367672758992},
   {474.68837663743915, 13.573432314146544},
   {478.1553911471265, 18.121244781095584},
   {481.0940938873976, 23.4577476492896},
   {482.7618769421375, 28.59430793172737},
   {484.4160618865112, 34.32314146567481},
   {485.81515635308756, 40.05147136590497},
   {487.4693412974612, 45.78030489985241},
   {488.6088125827848, 51.70555558353518},
   {490.27206293406937, 57.03954028314285},
   {491.6620919937348, 63.162719017712774},
   {493.5849655262721, 68.29978293386782},
   {494.9976581032147, 73.43583958258836},
   {497.93182814003035, 78.96976686795225},
   {503.72638587408153, 82.14014111816753},
   {513.1058084076612, 84.725292988915},
   {524.8218395725157, 85.53815780858893},
   {534.5696701702786, 83.18820288380664},
   {540.7643648927009, 80.04149941830303},
   {546.4942056940829, 74.91954451366607},
   {550.1878553765418, 69.59613612212107},
   {552.8566104443561, 64.46813761287687},
   {555.511767401804, 59.932412355142326},
   {558.4537437612374, 54.015219810935875},
   {560.6009861148185, 49.379775077181826},
   {563.5361634190687, 43.75871915873021},
   {568.0222807556521, 37.25227516531774},
   {571.6977996242892, 32.71856444245226},
   {576.6759671026456, 27.002825385153855},
   {580.615641855991, 22.07476946166588},
   {586.8760607785171, 16.06541194719901},
   {593.6058663255388, 11.8338814546956},
   {605.1869236541648, 7.414495585650485},
   {615.463066021344, 4.275850259623155},
   {625.7301429816124, 1.532053767935622},
   {630.8659478134742, 0.06144331350688503},
   {639.5390240585828, 0.07856685989412426},
   {651.2777187407144, -0.0956904062813635},
   {656.8171859969682, 3.0741802102166673},
   {660.8261103864381, 6.241029024411091},
   {664.8350347759083, 9.4078778386055},
   {669.3496074175175, 12.77315833740434},
   {673.8551146522157, 16.533287670542933},
   {678.0874005952951, 21.082611038643776},
   {682.55664620235, 26.422135709141415},
   {687.267384176836, 32.354437264865965},
   {690.9668256470436, 37.889875451381684},
   {694.6707998207065, 43.22788922072752},
   {699.9053168611533, 48.56892479237696},
};
const static spectra_entry dufaycolor_collins_giles_blue[] = {
   {398.52485684211587, 86.47340562155954},
   {407.9632045206163, 86.49204006909852},
   {414.855180124599, 86.30821376229494},
   {423.8082767165096, 85.24000664796505},
   {433.7975996817035, 83.48282860840965},
   {444.8208826684529, 81.1353918522137},
   {453.5551504102097, 78.48728576680749},
   {461.2645235373218, 76.0345895637021},
   {470.0169220929003, 72.59678580961635},
   {477.2161142644178, 70.14308233907641},
   {482.6500702569036, 66.7974435552511},
   {488.3413830789144, 63.35359619655814},
   {492.5384146617848, 58.32733169820251},
   {496.21846623387745, 53.596196558167144},
   {499.14457813121675, 48.36998947405528},
   {501.2895541330701, 43.83325694888617},
   {502.41870092718966, 39.09708547167814},
   {503.534249610943, 34.95318724597972},
   {506.1848738649355, 30.614886405415035},
   {507.7970053939171, 27.064268698660797},
   {510.960076955232, 22.628262916945758},
   {513.8635253352942, 18.389177918683274},
   {517.5277124452928, 14.349028238742505},
   {520.6771858962413, 10.505295708537076},
   {526.1428708129151, 5.777686004522593},
   {530.3104398233254, 2.0346802177711822},
   {533.9315662504973, 0},
   {547.4490952220269, 0},
   {563.5197953232573, 0.02719622073254868},
   {575.7641382575281, 0.05137063916151874},
   {589.5390240585828, 0.0785668598941669},
   {600.2550904777974, 0.0010072674345025234},
   {612.7567902415932, 0},
   {627.8048620799066, 0.05539970889964252},
   {639.5412904103105, 0},
   {648.979638088811, 0},
   {653.970396410099, 4.845459993855627},
   {657.4464763266972, 8.998423626464856},
   {660.9452197605726, 12.164265173224777},
   {665.1865711105629, 16.318739706985866},
   {668.1660681819327, 19.878422820650954},
   {673.6511429967214, 25.417386443187567},
   {676.6147756059972, 29.66805501694722},
   {679.5920063256395, 33.326450339197265},
   {682.0431916275932, 37.67482385410736},
   {682.0431916275932, 37.67482385410736},
   {688.0792417290754, 41.437974989549566},
   {692.1244277461888, 43.02542846638494},
   {698.7341166516417, 44.02564502888336},
};
const static spectra_entry debug_red[] = {
   {401.7937115924068, 0.06610688443564405},
   {407.6497301909208, 0.04845279492682897},
   {414.4303833049896, 0.03397321963457478},
   {421.2110364190585, 0.023435727667960427},
   {427.9916895331273, 0.015324133132509132},
   {434.7723426471962, 0.009562626733496948},
   {441.55299576126504, 0.005620543407857115},
   {448.3336488753339, 0.0031188366819701052},
   {455.11430198940275, 0.002209125145284041},
   {461.8949551034716, 0.002209125145284041},
   {468.67560821754046, 0.003194645976694277},
   {475.4562613316093, 0.005165687639514083},
   {482.23691444567817, 0.008198059428467852},
   {489.017567559747, 0.01191271486993628},
   {495.7982206738158, 0.016385463258642874},
   {502.5788737878847, 0.02138887671041667},
   {509.35952690195353, 0.027226192404152583},
   {516.1401800160224, 0.03351836386623175},
   {522.9208331300913, 0.03912825167579603},
   {529.70148624416, 0.038976633086348356},
   {536.4821393582289, 0.03920406097051998},
   {543.2627924722977, 0.040341200391377674},
   {550.0434455863666, 0.04291871641198819},
   {556.8240987004355, 0.04814955774793339},
   {562.6801172989494, 0.059227190939455276},
   {566.6868668663537, 0.07859457050902918},
   {569.1525589078334, 0.10005365486885864},
   {570.693616433758, 0.11937239014098489},
   {572.2346739596828, 0.141679275113476},
   {573.4675199804226, 0.16794719573528794},
   {574.3921544959775, 0.19025408070777894},
   {575.1113146747424, 0.21290842494775442},
   {576.1386863586922, 0.24181703600244675},
   {576.9605837058521, 0.2726714189550513},
   {577.577006716222, 0.3029698670796809},
   {578.1934297265918, 0.33021067365044876},
   {578.3989040633818, 0.3532819690114053},
   {579.0153270737517, 0.39998049456129314},
   {579.6317500841217, 0.45335023804687924},
   {580.2481730944914, 0.5050521770485408},
   {581.2755447784414, 0.5750999653733726},
   {581.4810191152312, 0.6017848371161656},
   {582.0974421256012, 0.6384765357625061},
   {583.124813809551, 0.6921242466620796},
   {583.638499651526, 0.7189481021118664},
   {584.2549226618958, 0.7406295604028857},
   {584.9740828406607, 0.7652296765407731},
   {586.1041916930055, 0.7912891216020944},
   {587.3370377137453, 0.8190163711473404},
   {588.8780952396701, 0.8419486828013031},
   {591.3437872811496, 0.8652979455762471},
   {596.2751713641087, 0.881824371826045},
   {603.0558244781776, 0.879853330163225},
   {609.8364775922464, 0.8737127772905937},
   {616.6171307063153, 0.8671931779443431},
   {623.3977838203841, 0.8605219600086449},
   {630.178436934453, 0.8538507420729465},
   {636.9590900485218, 0.850742560989269},
   {643.7397431625907, 0.8417970642118554},
   {650.2121847714745, 0.8254374184104498},
   {655.7599918648036, 0.8056739352759438},
   {660.0749529373929, 0.7871891022457798},
   {663.7734909996122, 0.7692602040435907},
   {667.1638175566468, 0.7507197775306294},
   {670.2459326084962, 0.7320403673106741},
   {673.3280476603456, 0.7121934939519718},
   {676.1019512070102, 0.6922632303690732},
   {678.2594317433048, 0.6746122995808717},
   {680.1087007744145, 0.6565444176716888},
   {682.2661813107092, 0.6363917801576003},
   {686.5811423832984, 0.6139598098488149},
   {693.0535839921823, 0.6041349252526048},
   {699.8342371062512, 0.6056511111470817},
   {706.61489022032, 0.6155821287559051},
   {712.1626973136491, 0.6343070245526947},
   {717.7105044069781, 0.6509092600972164},
   {724.491157521047, 0.6541690597703418},
   {731.2718106351158, 0.6505302136235973},
   {738.0524637491847, 0.6431009027406605},
   {744.8331168632535, 0.6336247409001801},
   {751.6137699773224, 0.6236179139966326},
   {758.3944230913912, 0.6138385149772568},
   {765.1750762054601, 0.6041349252526048},
   {771.9557293195289, 0.5927635310440281},
   {778.7363824335978, 0.58116470895128},
   {785.5170355476666, 0.5700965519215988},
   {792.2976886617355, 0.5601655343127753},
   {799.0783417758043, 0.5514474654195333},
   {805.8589948898732, 0.5438665359471488},
   {812.639648003942, 0.5353000856433545},
   {819.4203011180109, 0.520972128940548},
   {826.2009542320798, 0.5046731305749215},
   {832.9816073461486, 0.4946663036713741},
   {839.7622604602175, 0.48875317868291435},
   {845.6182790587314, 0.4757613607996156},
   {850.5496631416906, 0.45668584701472836},
   {856.4056817402046, 0.4389464720493489},
   {863.1863348542735, 0.42916707302997303},
   {869.9669879683423, 0.42264747368372246},
   {875.2065835564864, 0.4092924029298719},
   {879.2133331238907, 0.3905693121162902},
   {884.1447172068499, 0.3712571951159256},
   {890.3089473105489, 0.35259968535889064},
   {897.0896004246177, 0.33849915654025575},
   {903.8702535386865, 0.33016013412063283},
   {910.6509066527553, 0.32530833925830693},
   {917.4315597668242, 0.3146192287022449},
   {922.9793668601533, 0.294194038723792},
   {928.5271739534824, 0.27716943710866604},
   {935.3078270675512, 0.26458509418450793},
   {942.0884801816201, 0.2563976903543328},
   {948.5609217905039, 0.24520823845309336},
   {953.800517378648, 0.22605231266630255},
   {958.1154784512373, 0.20758733445142352},
   {962.7386510290115, 0.1897328918065525},
   {968.5946696275256, 0.17429622416840973},
   {975.3753227415943, 0.16489587162265307},
   {982.1559758556632, 0.15860370016057412},
   {988.6284174645472, 0.14647421300475905},
   {994.4844360630611, 0.12794305207226397},
   {997.5665511149107, 0.11812153677804149},
};
const static spectra_entry debug_green[] = {
   {402.7183461079616, 0.04898345998989573},
   {409.6751200821362, 0.0446190105936517},
   {416.27965233609933, 0.04238805134892143},
   {423.0603054501682, 0.04238805134892143},
   {429.84095856423704, 0.046709181148180345},
   {436.6216116783059, 0.057474100998966327},
   {443.4022647923747, 0.0661163605974846},
   {450.18291790644355, 0.06687445354472299},
   {456.3471480101425, 0.07318347151674076},
   {460.0456860723619, 0.09227056727721061},
   {461.8949551034716, 0.11172828625633058},
   {463.4360126293963, 0.13271482601238138},
   {464.97707015532103, 0.1550912028383693},
   {466.20991617606086, 0.17649469371540127},
   {467.4427621968007, 0.20192871209525087},
   {468.67560821754046, 0.2294474860800062},
   {469.9084542382802, 0.25780016230672387},
   {470.93582592223004, 0.28490198517049803},
   {472.0659347745749, 0.31054447911083827},
   {473.29878079531466, 0.3413988620634427},
   {474.5316268160544, 0.37267019613702834},
   {475.7644728367942, 0.40373305465012344},
   {476.997318857534, 0.4345874376027279},
   {478.41509178138483, 0.46869403929898523},
   {479.56574806740855, 0.4994928287687923},
   {480.8807838228644, 0.52740075713313},
   {482.23691444567817, 0.5596727738970703},
   {483.46976046641794, 0.5863576456398634},
   {484.7026064871577, 0.6128340418221658},
   {485.9354525078975, 0.6382680602020154},
   {487.1682985286373, 0.66182579853745},
   {488.1956702125872, 0.6829513220004945},
   {489.42851623332695, 0.7046327802915138},
   {490.55862508567174, 0.7264532222895269},
   {491.7914711064115, 0.7468838272176028},
   {493.02431712715133, 0.7660635787827353},
   {494.2571631478911, 0.7844094281059055},
   {495.7982206738158, 0.8058129189829375},
   {497.64748970492553, 0.8299960839998437},
   {499.4967587360352, 0.8519555097048505},
   {501.3460277671449, 0.8719691635119453},
   {503.5035083034395, 0.8930251951214929},
   {505.9692003449191, 0.9151236045334934},
   {508.74310389158364, 0.9356792947978637},
   {512.1334304486181, 0.9561932899501359},
   {516.4483915212073, 0.976311181537476},
   {522.3044101197213, 0.9931882257753717},
   {529.0850632337902, 0.9999352530057938},
   {535.865716347859, 0.9931124164806479},
   {542.029946451558, 0.9755583531245933},
   {547.885965050072, 0.9580278748824529},
   {552.5091376278463, 0.9396820255592826},
   {555.2830411745108, 0.9199185424247766},
   {557.7487332159903, 0.9005303152991535},
   {560.2144252574699, 0.879891234810587},
   {562.6801172989494, 0.8577928253985865},
   {564.8375978352441, 0.8377791715914917},
   {566.6868668663537, 0.8202672245102838},
   {568.5361358974635, 0.801643407773126},
   {570.3854049285732, 0.7830195910359684},
   {572.2346739596828, 0.7635618720568484},
   {574.0839429907926, 0.7438261856637411},
   {575.9332120219022, 0.723534564442659},
   {577.7824810530119, 0.7032429432215768},
   {579.6317500841217, 0.6821174197585322},
   {581.1728076100463, 0.6639105541423557},
   {583.9467111567109, 0.6298595459288958},
   {585.7959801878205, 0.6062323157399645},
   {587.6452492189303, 0.5817711833090708},
   {589.4945182500398, 0.5567541160502023},
   {591.0355757759646, 0.5354896088801641},
   {592.2684217967044, 0.5171437595569939},
   {593.5012678174442, 0.4987979102338237},
   {594.734113838184, 0.47920120754771},
   {595.9669598589238, 0.45918755374061526},
   {597.1998058796636, 0.43875694881253924},
   {598.4326519004035, 0.41582463715857654},
   {599.5627607527482, 0.39358724403958234},
   {600.590132436698, 0.3699600138506509},
   {601.8229784574378, 0.345151422152273},
   {603.0558244781776, 0.3215936838168385},
   {604.5968820041023, 0.29949527440483803},
   {605.8297280248421, 0.2807324739606867},
   {607.3707855507669, 0.25905101566966726},
   {609.2200545818766, 0.23597972030871073},
   {611.0693236129862, 0.21513216425965365},
   {612.918592644096, 0.19678631493648346},
   {615.0760731803905, 0.17774554707834467},
   {617.5417652218702, 0.15794036883174045},
   {620.6238802737196, 0.13702332092918668},
   {625.8634758618637, 0.11986515055668978},
   {632.6441289759325, 0.10386938936995893},
   {639.4247820900014, 0.09029952561439081},
   {646.2054352040702, 0.07801841986912805},
   {652.9860883181391, 0.06823902084975231},
   {659.7667414322079, 0.06861806732337139},
   {666.5473945462768, 0.07460700160655498},
   {673.3280476603456, 0.08757039100433239},
   {679.4922777640446, 0.10607628217191967},
   {684.7318733521888, 0.1252097058347209},
   {689.6632574351479, 0.14365979293813635},
   {694.902853023292, 0.16176242077406755},
   {700.7588716218061, 0.17949674178646546},
   {707.2313132306899, 0.1956744452805338},
   {714.0119663447588, 0.2082587882046918},
   {720.7926194588276, 0.2175075221610009},
   {727.5732725728965, 0.2250884516333852},
   {734.3539256869653, 0.23251776251632195},
   {741.1345788010342, 0.24138744999901163},
   {747.915231915103, 0.25321369997593135},
   {754.6958850291719, 0.2678448938576331},
   {761.4765381432408, 0.28376484574964045},
   {768.2571912573096, 0.3008977463572291},
   {774.7296328661935, 0.3182580748489894},
   {780.8938629698924, 0.33577002193019734},
   {787.0580930735914, 0.35394909080497505},
   {793.2223231772903, 0.3729620619217152},
   {799.0783417758043, 0.39145616053234533},
   {804.6261488691334, 0.40943138663686574},
   {810.1739559624625, 0.42768458015537336},
   {816.3381860661614, 0.44774035023731473},
   {823.1188391802302, 0.4540325216993939},
   {829.8994922942991, 0.4525163358049169},
   {836.6801454083679, 0.45623099124638533},
   {843.4607985224368, 0.45471480535190845},
   {849.9332401313206, 0.44209255778038836},
   {856.0974702350196, 0.42366331823302195},
   {862.5699118439036, 0.40831951698091595},
   {869.3505649579724, 0.39725135995123473},
   {875.5147950616714, 0.3847849425966471},
   {881.6790251653703, 0.3666244048828018},
   {888.4596782794391, 0.3486576020332508},
   {895.240331393508, 0.33425383603572045},
   {902.0209845075768, 0.32424700913217297},
   {908.8016376216457, 0.3132546613972157},
   {914.9658677253447, 0.29648396075330763},
   {921.1300978290436, 0.2786856230031428},
   {927.9107509431125, 0.2695885076362816},
   {934.6914040571813, 0.25920263425911494},
   {941.1638456660652, 0.24295670239979528},
   {946.7116527593943, 0.22538221265044012},
   {951.6430368423535, 0.20755755222849637},
   {956.2662094201277, 0.1895988718033801},
   {961.8140165134567, 0.17179451744252283},
   {968.5946696275256, 0.16057474182339415},
   {975.3753227415943, 0.1581488443922311},
   {982.0943335546264, 0.15598069856312924},
   {991.4023210112117, 0.14374507839470074},
   {997.2583396097257, 0.1255224191754567},
};
const static spectra_entry debug_blue[] = {
   {400.560865571667, 0.3470277021966881},
   {402.10192309759174, 0.3685701767807138},
   {403.95119212870145, 0.39164147214167033},
   {405.8004611598111, 0.41221106077673986},
   {407.6497301909208, 0.4313908123418724},
   {409.4989992220305, 0.44890275942308033},
   {411.65647975832513, 0.4683604784022003},
   {414.12217179980473, 0.48774870552782346},
   {416.5878638412843, 0.5071369326534465},
   {419.0535558827639, 0.5258997330975979},
   {421.5192479242435, 0.544245582420768},
   {423.984939965723, 0.5627999073044289},
   {426.4506320072026, 0.5817711833090708},
   {428.9163240486822, 0.6011594104346939},
   {431.38201609016176, 0.6217984909232603},
   {433.5394966264564, 0.6415341773163677},
   {435.38876565756607, 0.6593240918115632},
   {437.2380346886758, 0.6773919737207459},
   {439.0873037197855, 0.6954598556299287},
   {441.2447842560801, 0.715195542023036},
   {443.7104762975597, 0.7343752935881687},
   {446.7925913494091, 0.7534160614463074},
   {451.7239754323683, 0.7726514064942374},
   {458.1964170412522, 0.7852433303478679},
   {464.97707015532103, 0.7863046604740016},
   {471.7577232693899, 0.7777382101702073},
   {476.38089584716414, 0.7581415074840936},
   {478.53837638345874, 0.7391007396259549},
   {480.38764541456845, 0.7204769228887973},
   {482.23691444567817, 0.700185301667715},
   {484.0861834767878, 0.6785038433766957},
   {485.6272410027126, 0.6605749451745065},
   {487.47651003382225, 0.6336815978712229},
   {489.6339905701169, 0.6073441853959141},
   {491.48325960122656, 0.5820491507230583},
   {493.3325286323362, 0.5567541160502023},
   {495.18179766344593, 0.5317370487913339},
   {497.03106669455565, 0.5064420141184779},
   {498.8803357256653, 0.48142494685960935},
   {500.72960475677496, 0.45724178184270314},
   {502.5788737878847, 0.43305861682579694},
   {504.4281428189944, 0.40943138663686574},
   {506.27741185010404, 0.38663805868989665},
   {508.1266808812137, 0.36440066557090245},
   {509.9759499123234, 0.3432751421078579},
   {511.82521894343313, 0.32187165123082595},
   {513.6744879745428, 0.302413932251706},
   {515.5237570056524, 0.28323418068657347},
   {517.3730260367622, 0.2648883313634033},
   {519.5305065730568, 0.2440407753143462},
   {521.9961986145364, 0.22194236590234573},
   {524.461890656016, 0.20130328541377918},
   {526.9275826974956, 0.18191505828815613},
   {529.70148624416, 0.16131767291168775},
   {532.7836012960096, 0.14063689731102313},
   {536.173927853044, 0.12062324350392828},
   {539.8724659152633, 0.10074857340382737},
   {543.8792154826676, 0.08202548259024556},
   {548.8105995656268, 0.06299133300386828},
   {554.9748296693258, 0.04519299525370357},
   {561.7554827833947, 0.03200217797175475},
   {568.5361358974635, 0.023435727667960427},
   {575.3167890115324, 0.017750030563672192},
   {582.0974421256012, 0.014186993711651441},
   {588.8780952396701, 0.012064333459383736},
   {595.6587483537389, 0.010927194038526267},
   {602.4394014678078, 0.01001748250183998},
   {609.2200545818766, 0.009714245322944626},
   {616.0007076959455, 0.010320719680735557},
   {622.7813608100143, 0.01191271486993628},
   {629.5620139240832, 0.013959565827479814},
   {636.342667038152, 0.0166128911428145},
   {643.1233201522208, 0.01956945363704432},
   {649.9039732662897, 0.02267763472072204},
   {656.6846263803585, 0.026013243688571164},
   {663.4652794944274, 0.029045615477524933},
   {670.2459326084962, 0.031850559382307075},
   {677.0265857225651, 0.03457969399236549},
   {683.8072388366339, 0.03647492636046157},
   {690.5878919507028, 0.037991112254938564},
   {697.3685450647715, 0.03890082379162463},
   {704.1491981788404, 0.03890082379162463},
   {710.9298512929092, 0.037915302960214614},
   {717.7105044069781, 0.03632330777101389},
   {724.491157521047, 0.034276456813470135},
   {731.2718106351158, 0.0320779872664787},
   {738.0524637491847, 0.030334373487830302},
   {744.8331168632535, 0.029727899130039592},
   {751.6137699773224, 0.030031136308934725},
   {758.3944230913912, 0.03283608021371709},
   {765.1750762054601, 0.03988634462303464},
   {771.6475178143439, 0.052493430335609714},
   {776.8871134024881, 0.0695169489608114},
   {780.8938629698924, 0.08893495830936149},
   {783.9759780217419, 0.10790623431400348},
   {786.4416700632214, 0.127085985879136},
   {788.5991505995162, 0.1461962455907717},
   {790.4484196306257, 0.16426412749995445},
   {792.2976886617355, 0.18399981389306186},
   {794.1469576928451, 0.20512533735610627},
   {795.9962267239548, 0.22652882823313825},
   {797.8454957550646, 0.2490441887661199},
   {799.6947647861742, 0.27155954929910153},
   {801.5440338172839, 0.2940749098320832},
   {803.3933028483937, 0.3171462051930396},
   {805.2425718795032, 0.3393835983120339},
   {807.091840910613, 0.3616209914310281},
   {808.9411099417227, 0.3833024497220474},
   {810.7903789728323, 0.4047059405990794},
   {812.947859509127, 0.42729079298555794},
   {821.8859931594905, 0.4618408790559497},
   {828.6666462735593, 0.47116542230698255},
   {835.4472993876282, 0.475334933516794},
   {842.227952501697, 0.47503169633789855},
   {848.392182605396, 0.4604979715494131},
   {854.24820120391, 0.44000780217548274},
   {860.1042198024239, 0.4217546086569749},
   {865.2997851755416, 0.40629432582186464},
   {872.4326800098219, 0.3858041564479343},
   {879.2133331238907, 0.3685954465456217},
   {885.0693517224047, 0.35369892013238646},
   {903.8702535386865, 0.31944936376607835},
   {913.116598694235, 0.3086302944190612},
   {919.8972518083038, 0.29672823514741764},
   {937.1570960986609, 0.25265776514795646},
   {942.0884801816201, 0.23662831094134806},
   {946.7116527593943, 0.22152541478136456},
   {958.1154784512373, 0.18923065522900706},
   {964.8961315653062, 0.17603983794705824},
   {969.2110926378955, 0.16982347577970303},
   {984.6216678971429, 0.15011305915150353},
   {991.0941095060267, 0.13313177713336255},
   {995.7172820838009, 0.11962256081357359},
};

/* Based on Casella-Tsukada paper.  */
static void
set_dyes_to_autochrome2 (spectrum red, spectrum green, spectrum blue,
			 luminosity_t orange_erythrosine, luminosity_t orange_rose, luminosity_t orange_tartrazine,
			 luminosity_t green_patent, luminosity_t green_tartrazine,
			 luminosity_t violet_crystal, luminosity_t violet_flexo,
			 bool aged)
{
  spectrum tartrazine, rose, erythrosine, patent, flexo, crystal;
  spectrum o2_rose, o2_erythrosine, o2_patent,  o2_flexo,  o2_crystal;
  //compute_spectrum (tartrazine, 400, 700, sizeof tartrazine_data / sizeof (luminosity_t), tartrazine_data, false);
  compute_spectrum (tartrazine,
		    sizeof (tartrazine_paper_data) / sizeof (spectra_entry),
		    tartrazine_paper_data, false, 100);
  //compute_spectrum (rose, 400, 700, sizeof rose_data / sizeof (luminosity_t), rose_data, false);
  compute_spectrum (rose,
		    sizeof (rose_paper_data) / sizeof (spectra_entry),
		    rose_paper_data, false, 100);
  compute_spectrum (o2_rose,
		    sizeof (o2_rose_paper_data) / sizeof (spectra_entry),
		    o2_rose_paper_data, false, 100);
  //compute_spectrum (erythrosine, 400, 700, sizeof erythrosine_data / sizeof (luminosity_t), erythrosine_data, false);
  compute_spectrum (erythrosine,
		    sizeof (erythrosine_paper_data) / sizeof (spectra_entry),
		    erythrosine_paper_data, false, 100);
  compute_spectrum (o2_erythrosine,
		    sizeof (o2_erythrosine_paper_data) / sizeof (spectra_entry),
		    o2_erythrosine_paper_data, false, 100);
  //compute_spectrum (patent, 400, 700, sizeof patent_data / sizeof (luminosity_t), patent_data, false);
  compute_spectrum (patent,
		    sizeof (patent_paper_data) / sizeof (spectra_entry),
		    patent_paper_data, false, 100);
  compute_spectrum (o2_patent,
		    sizeof (o2_patent_paper_data) / sizeof (spectra_entry),
		    o2_patent_paper_data, false, 100);
  //compute_spectrum (flexo, 400, 700, sizeof flexo_data / sizeof (luminosity_t), flexo_data, false);
  compute_spectrum (flexo,
		    sizeof (flexo_paper_data) / sizeof (spectra_entry),
		    flexo_paper_data, false, 100);
  compute_spectrum (o2_flexo,
		    sizeof (o2_flexo_paper_data) / sizeof (spectra_entry),
		    o2_flexo_paper_data, false, 100);
  //compute_spectrum (crystal, 400, 700, sizeof crystal_data / sizeof (luminosity_t), crystal_data, false);
  compute_spectrum (crystal,
		    sizeof (crystal_paper_data) / sizeof (spectra_entry),
		    crystal_paper_data, false, 100);
  compute_spectrum (o2_crystal,
		    sizeof (o2_crystal_paper_data) / sizeof (spectra_entry),
		    o2_crystal_paper_data, false, 100);
  if (false)
    {
      FILE *f;
      f = fopen ("/tmp/tartrazine-trans.dat", "w");
      print_transmitance_spectrum (f, tartrazine);
      fclose (f);
      f = fopen ("/tmp/rose-trans.dat", "w");
      print_transmitance_spectrum (f, rose);
      fclose (f);
      f = fopen ("/tmp/o2_rose-trans.dat", "w");
      print_transmitance_spectrum (f, o2_rose);
      fclose (f);
      f = fopen ("/tmp/erythrosine-trans.dat", "w");
      print_transmitance_spectrum (f, erythrosine);
      fclose (f);
      f = fopen ("/tmp/o2_erythrosine-trans.dat", "w");
      print_transmitance_spectrum (f, o2_erythrosine);
      fclose (f);
      f = fopen ("/tmp/patent-trans.dat", "w");
      print_transmitance_spectrum (f, patent);
      fclose (f);
      f = fopen ("/tmp/o2_patent-trans.dat", "w");
      print_transmitance_spectrum (f, o2_patent);
      fclose (f);
      f = fopen ("/tmp/flexo-trans.dat", "w");
      print_transmitance_spectrum (f, flexo);
      fclose (f);
      f = fopen ("/tmp/o2_flexo-trans.dat", "w");
      print_transmitance_spectrum (f, o2_flexo);
      fclose (f);
      f = fopen ("/tmp/crystal-trans.dat", "w");
      print_transmitance_spectrum (f, crystal);
      fclose (f);
      f = fopen ("/tmp/o2_crystal-trans.dat", "w");
      print_transmitance_spectrum (f, o2_crystal);
      fclose (f);
    }
#define choose(n,m,w) my_pow ((aged ? m : n), w)
  const luminosity_t concentration = 3;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      red[i] = my_pow ((choose (erythrosine[i], o2_erythrosine[i], orange_erythrosine)* choose (rose[i], o2_rose[i], orange_rose) * choose (tartrazine[i], tartrazine[i], orange_tartrazine)), concentration);
      green[i] = my_pow ((choose (patent[i], o2_patent[i], green_patent) * choose (tartrazine[i], tartrazine[i], green_tartrazine)), concentration);
      blue[i] = my_pow ((choose (crystal[i], o2_crystal[i], violet_crystal) * choose (flexo[i], o2_flexo[i], violet_flexo)), concentration);
    }
#undef choose
}
}


#define NORM 100000
#define SCALE 30
#define NORM2 9000000
void
set_synthetic_dufay_red (spectrum red, luminosity_t d1, luminosity_t d2)
{
#if 0
  static bool initialized;
  static spectrum auramine;
  static spectrum rhodamine_b;
  if (!initialized)
    {
      compute_spectrum (auramine, 380.0, 780.0, sizeof (auramine_absorption) / sizeof (luminosity_t), auramine_absorption, true, NORM);
      compute_spectrum (rhodamine_b, 380.0, 780.0, sizeof (rhodamine_b_absorption) / sizeof (luminosity_t), rhodamine_b_absorption, true, NORM);
      initialized = true;
    }
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    red[i] = pow (rhodamine_b[i], d1/SCALE) * pow (auramine[i], d2/SCALE);
#endif
  assert (sizeof (auramine_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);
  assert (sizeof (rhodamine_b_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    red[i] = absorbance_to_transmitance (auramine_absorption[i] * d1/NORM2 + rhodamine_b_absorption[i] * d2/NORM2 );
}

void
set_synthetic_dufay_green (spectrum green, luminosity_t d1, luminosity_t d2)
{
#if 0
  static spectrum malachite;
  static spectrum auramine;
  static spectrum methylene_blue;
  static bool initialized;
  if (!initialized)
    {
      compute_spectrum (malachite, 380.0, 780.0, sizeof (malachite_green_absorption) / sizeof (luminosity_t), malachite_green_absorption, true, NORM);
      compute_spectrum (auramine, 380.0, 780.0, sizeof (auramine_absorption) / sizeof (luminosity_t), auramine_absorption, true, NORM);
      compute_spectrum (methylene_blue, 380.0, 780.0, sizeof (methylene_blue_absorption) / sizeof (luminosity_t), methylene_blue_absorption, true, NORM);
      initialized = true;
    }
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    green[i] = pow (methylene_blue[i], d1/SCALE) * pow (auramine[i], d2/SCALE);
#endif
  assert (sizeof (auramine_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);


  assert (sizeof (methylene_blue_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);

  for (int i = 0; i < SPECTRUM_SIZE; i++)
    green[i] = absorbance_to_transmitance (methylene_blue_absorption[i] * d1/NORM2 + auramine_absorption[i] * d2/NORM2);
}

void
set_synthetic_dufay_blue (spectrum blue, luminosity_t d1, luminosity_t d2)
{
#if 0
  static spectrum malachite;
  static spectrum violet;
  static spectrum methylene_blue;
  static bool initialized;
  if (!initialized)
    {
      compute_spectrum (malachite, 380.0, 780.0, sizeof (malachite_green_absorption) / sizeof (luminosity_t), malachite_green_absorption, true, NORM);
      compute_spectrum (violet, 380.0, 780.0, sizeof (crystal_violet_absorption) / sizeof (luminosity_t), crystal_violet_absorption, true, NORM);
      compute_spectrum (methylene_blue, 380.0, 780.0, sizeof (methylene_blue_absorption) / sizeof (luminosity_t), methylene_blue_absorption, true, NORM);
      initialized = true;
    }
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    blue[i] = pow (/*malachite[i]*/ methylene_blue[i], d1/SCALE) * pow (violet[i], d2/SCALE);
#endif
  assert (sizeof (crystal_violet_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);
  assert (sizeof (methylene_blue_absorption) / sizeof (luminosity_t) == SPECTRUM_SIZE);
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    blue[i] = absorbance_to_transmitance (methylene_blue_absorption[i] * d1/NORM2 + crystal_violet_absorption[i] * d2/NORM2);
}

bool
set_dyes_to (spectrum red, spectrum green, spectrum blue, spectrum cyan, spectrum magenta, spectrum yellow, enum spectrum_dyes_to_xyz::dyes dyes)
{
  switch (dyes)
    {
      case spectrum_dyes_to_xyz::dufaycolor_color_cinematography:
	compute_spectrum (red, sizeof (color_cinematography_dufay_red) / sizeof (spectra_entry), color_cinematography_dufay_red, false, 100, 0, 100);
	compute_spectrum (green, sizeof (color_cinematography_dufay_green) / sizeof (spectra_entry), color_cinematography_dufay_green, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (color_cinematography_dufay_blue) / sizeof (spectra_entry), color_cinematography_dufay_blue, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_harrison_horner:
	compute_spectrum (red, sizeof (harrison_horner_dufay_red) / sizeof (spectra_entry), harrison_horner_dufay_red, false, 100, 0, 100);
	compute_spectrum (green, sizeof (harrison_horner_dufay_green) / sizeof (spectra_entry), harrison_horner_dufay_green, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (harrison_horner_dufay_blue) / sizeof (spectra_entry), harrison_horner_dufay_blue, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_collins_giles:
	compute_spectrum (red, sizeof (dufaycolor_collins_giles_red) / sizeof (spectra_entry), dufaycolor_collins_giles_red, false, 100, 0, 100);
	compute_spectrum (green, sizeof (dufaycolor_collins_giles_green) / sizeof (spectra_entry), dufaycolor_collins_giles_green, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (dufaycolor_collins_giles_blue) / sizeof (spectra_entry), dufaycolor_collins_giles_blue, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_photography_its_materials_and_processes:
	compute_spectrum (red, sizeof (dufaycolor_photography_its_materials_and_processes_red) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_red, false, 100, 0, 100);
	compute_spectrum (green, sizeof (dufaycolor_photography_its_materials_and_processes_green) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_green, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (dufaycolor_photography_its_materials_and_processes_blue) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_blue, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_separation_filters_photography_its_materials_and_processes:
	compute_spectrum (red, sizeof (dufaycolor_photography_its_materials_and_processes_red1s) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_red1s, false, 100, 0, 100);
	compute_spectrum (green, sizeof (dufaycolor_photography_its_materials_and_processes_green2s) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_green2s, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (dufaycolor_photography_its_materials_and_processes_blue3s) / sizeof (spectra_entry), dufaycolor_photography_its_materials_and_processes_blue3s, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_narrow_cut_filters_harrison_horner:
	compute_spectrum (red, sizeof (dufaycolor_harrison_horner_narrow_cut_red) / sizeof (spectra_entry), dufaycolor_harrison_horner_narrow_cut_red, false, 100, 0, 100);
	compute_spectrum (green, sizeof (dufaycolor_harrison_horner_narrow_cut_green) / sizeof (spectra_entry), dufaycolor_harrison_horner_narrow_cut_green, false, 100, 0, 100);
	compute_spectrum (blue, sizeof (dufaycolor_harrison_horner_narrow_cut_blue) / sizeof (spectra_entry), dufaycolor_harrison_horner_narrow_cut_blue, false, 100, 0, 100);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_dufaycolor_manual:
	compute_spectrum (red, sizeof (manual_dufay_red) / sizeof (spectra_entry), manual_dufay_red, false);
	compute_spectrum (green, sizeof (manual_dufay_green) / sizeof (spectra_entry), manual_dufay_green, false);
	compute_spectrum (blue, sizeof (manual_dufay_blue) / sizeof (spectra_entry), manual_dufay_blue, false);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_aged_DC_MSI_NSMM11948_spicer_dufaycolor:
	compute_spectrum (red, sizeof (real_dufay_red) / sizeof (spectra_entry), real_dufay_red, true);
	compute_spectrum (green, sizeof (real_dufay_green) / sizeof (spectra_entry), real_dufay_green, true);
	compute_spectrum (blue, sizeof (real_dufay_blue) / sizeof (spectra_entry), real_dufay_blue, true);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_aged_DC_MSI_NSMM11951:
	compute_spectrum (red, sizeof (real_dufay_red2) / sizeof (spectra_entry), real_dufay_red2, true);
	compute_spectrum (green, sizeof (real_dufay_green2) / sizeof (spectra_entry), real_dufay_green2, true);
	compute_spectrum (blue, sizeof (real_dufay_blue2) / sizeof (spectra_entry), real_dufay_blue2, true);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_aged_DC_MSI_NSMM11960:
	compute_spectrum (red, sizeof (real_dufay_red3) / sizeof (spectra_entry), real_dufay_red3, true);
	compute_spectrum (green, sizeof (real_dufay_green3) / sizeof (spectra_entry), real_dufay_green3, true);
	compute_spectrum (blue, sizeof (real_dufay_blue3) / sizeof (spectra_entry), real_dufay_blue3, true);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_aged_DC_MSI_NSMM11967:
	compute_spectrum (red, sizeof (real_dufay_red4) / sizeof (spectra_entry), real_dufay_red4, true);
	compute_spectrum (green, sizeof (real_dufay_green4) / sizeof (spectra_entry), real_dufay_green4, true);
	compute_spectrum (blue, sizeof (real_dufay_blue4) / sizeof (spectra_entry), real_dufay_blue4, true);
	break;
      case spectrum_dyes_to_xyz::dufaycolor_aged_DC_MSI_NSMM12075:
	compute_spectrum (red, sizeof (real_dufay_red5) / sizeof (spectra_entry), real_dufay_red5, true);
	compute_spectrum (green, sizeof (real_dufay_green5) / sizeof (spectra_entry), real_dufay_green5, true);
	compute_spectrum (blue, sizeof (real_dufay_blue5) / sizeof (spectra_entry), real_dufay_blue5, true);
	break;
      case spectrum_dyes_to_xyz::cinecolor:
	compute_spectrum (red,
			  sizeof (autochrome_orange) / sizeof (spectra_entry),
			  autochrome_orange, false, 1);
	compute_spectrum (green,
			  sizeof (autochrome_green) / sizeof (spectra_entry),
			  autochrome_green, false, 1);
	compute_spectrum (blue,
			  sizeof (autochrome_violet) / sizeof (spectra_entry),
			  autochrome_violet, false, 1);
	break;
      case spectrum_dyes_to_xyz::autochrome_reconstructed:
	set_dyes_to_autochrome2 (red, green, blue, 1, 1, 19.7 / (20.35),
							   1, 21 / (20.35),
							   1,1, false);
	break;
      case spectrum_dyes_to_xyz::autochrome_reconstructed_aged:
	set_dyes_to_autochrome2 (red, green, blue, 1, 1, 19.7 / (20.35),
							   1, 21 / (20.35),
							   1,1, true);
	break;
      case spectrum_dyes_to_xyz::wratten_25_58_47_color_cinematography:
	compute_spectrum (red, 400.0, 700.0, sizeof (wratten_filter_red_25_kodak) / sizeof (luminosity_t), wratten_filter_red_25_kodak, false, 100);
	compute_spectrum (green, 400.0, 700.0, sizeof (wratten_filter_green_58_kodak) / sizeof (luminosity_t), wratten_filter_green_58_kodak, false, 100);
	compute_spectrum (blue, 400.0, 700.0, sizeof (wratten_filter_blue_47_kodak) / sizeof (luminosity_t), wratten_filter_blue_47_kodak, false, 100);
	break;
      case spectrum_dyes_to_xyz::wratten_25_58_47_kodak_1945:
	compute_spectrum (red, 400.0, 700.0, sizeof (wratten_filter_red_25_kodak) / sizeof (luminosity_t), wratten_filter_red_25_kodak, false, 100);
	compute_spectrum (green, 400.0, 700.0, sizeof (wratten_filter_green_58_kodak) / sizeof (luminosity_t), wratten_filter_green_58_kodak, false, 100);
	compute_spectrum (blue, 400.0, 700.0, sizeof (wratten_filter_blue_47_kodak) / sizeof (luminosity_t), wratten_filter_blue_47_kodak, false, 100);
	break;
      case spectrum_dyes_to_xyz::kodachrome_25_sensitivity:
	/* It is best to clamp missing data to 0 for spectral response.
	   We make sure it remans zero in log_sensitivity_to_reversal_transmiatance  */
	compute_log_sensitivity (red, sizeof (kodachrome_25_spectral_response_red) / sizeof (spectra_entry), kodachrome_25_spectral_response_red);
	compute_log_sensitivity (green, sizeof (kodachrome_25_spectral_response_green) / sizeof (spectra_entry), kodachrome_25_spectral_response_green);
	compute_log_sensitivity (blue, sizeof (kodachrome_25_spectral_response_blue) / sizeof (spectra_entry), kodachrome_25_spectral_response_blue);
	log_sensitivity_to_reversal_transmitance (red);
	log_sensitivity_to_reversal_transmitance (green);
	log_sensitivity_to_reversal_transmitance (blue);
	compute_spectrum (cyan, sizeof (kodachrome25_cyan) / sizeof (spectra_entry), kodachrome25_cyan, false, 1.0, 0, 1.3);
	compute_spectrum (magenta, sizeof (kodachrome25_magenta) / sizeof (spectra_entry), kodachrome25_magenta, false, 1.0, 0, 1.3);
	compute_spectrum (yellow, sizeof (kodachrome25_yellow) / sizeof (spectra_entry), kodachrome25_yellow, false, 1.0, 0, 1.3);
	return true;
	break;
      case spectrum_dyes_to_xyz::phase_one_sensitivity:
	compute_spectrum (red, 400, 720, sizeof (phase_one_red) / sizeof (luminosity_t), phase_one_red, false);
	compute_spectrum (green, 400, 720, sizeof (phase_one_green) / sizeof (luminosity_t), phase_one_green, false);
	compute_spectrum (blue, 400, 720, sizeof (phase_one_blue) / sizeof (luminosity_t), phase_one_blue, false);
	break;
      case spectrum_dyes_to_xyz::nikon_d3_sensitivity:
	compute_spectrum (red, 400, 720, sizeof (nikon_d3_red) / sizeof (luminosity_t), nikon_d3_red, false);
	compute_spectrum (green, 400, 720, sizeof (nikon_d3_green) / sizeof (luminosity_t), nikon_d3_green, false);
	compute_spectrum (blue, 400, 720, sizeof (nikon_d3_blue) / sizeof (luminosity_t), nikon_d3_blue, false);
	break;
      case spectrum_dyes_to_xyz::nikon_coolscan_9000ED_sensitivity:
	{
	  set_illuminant_to (red, spectrum_dyes_to_xyz::il_nikon_coolscan_9000ED_LED_red);
	  set_illuminant_to (green, spectrum_dyes_to_xyz::il_nikon_coolscan_9000ED_LED_green);
	  set_illuminant_to (blue, spectrum_dyes_to_xyz::il_nikon_coolscan_9000ED_LED_blue);
	  spectrum response;
	  set_response (response, spectrum_dyes_to_xyz::/*monochromatic_ccd*/response_even);
	  luminosity_t rsum = 0, gsum = 0, bsum = 0;
	  for (int i = 0; i < SPECTRUM_SIZE; i++)
	    {
	      red[i] *= response[i];
	      green[i] *= response[i];
	      blue[i] *= response[i];
	      rsum += red[i];
	      gsum += green[i];
	      bsum += blue[i];
	    }
	  printf ("sums: %f %f %f\n", rsum, gsum, bsum);
	  /* I do not know actual intensities of the LED lights, but they ought to look
	     gray to calibrated scanner.  */
	  for (int i = 0; i < SPECTRUM_SIZE; i++)
	    {
	      red[i] /= rsum;
	      green[i] /= gsum;
	      blue[i] /= bsum;
	    }
	}
	break;
      case spectrum_dyes_to_xyz::debug_dyes:
	compute_spectrum (red, sizeof (debug_red) / sizeof (spectra_entry), debug_red, false, 1, 0, 1);
	compute_spectrum (green, sizeof (debug_green) / sizeof (spectra_entry), debug_green, false, 1, 0, 1);
	compute_spectrum (blue, sizeof (debug_blue) / sizeof (spectra_entry), debug_blue, false, 1, 0, 1);
	break;
      default:
	abort ();
    }
  return false;
}
}

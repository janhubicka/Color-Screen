#include <string>
#include "include/spectrum-to-xyz.h"
#include "include/scr-to-img.h"
#include "include/render.h"
#include "include/tiff-writer.h"
#include "include/solver.h"
#include "icc.h"
#include "dufaycolor.h"
#include "spectrum.h"
#include "spectrum-dyes.h"

constexpr const char *spectrum_dyes_to_xyz::dyes_names[spectrum_dyes_to_xyz::dyes_max];
constexpr const char *spectrum_dyes_to_xyz::illuminants_names[spectrum_dyes_to_xyz::illuminants_max];
constexpr const char *spectrum_dyes_to_xyz::responses_names[spectrum_dyes_to_xyz::responses_max];
constexpr const char *spectrum_dyes_to_xyz::characteristic_curve_names[spectrum_dyes_to_xyz::characteristic_curves_max];

/* EBU TLCI ColorChecker samples */
static xspect TLCI_2012_TCS[] = {

  /* 1 Dark skin */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.05400, 0.05700, 0.06300, 0.06600, 0.07500,
    0.07800, 0.07800, 0.07600, 0.07400, 0.07000,
    0.06600, 0.06400, 0.06200, 0.06000, 0.05900,
    0.06000, 0.05800, 0.06000, 0.06000, 0.06200,
    0.05800, 0.06300, 0.06300, 0.06700, 0.06800,
    0.07000, 0.07200, 0.07700, 0.07900, 0.08100,
    0.08100, 0.08300, 0.08300, 0.08400, 0.08400,
    0.08800, 0.09300, 0.09800, 0.10400, 0.11100,
    0.12100, 0.12700, 0.13300, 0.14000, 0.14400,
    0.14900, 0.15100, 0.15400, 0.16000, 0.16400,
    0.17000, 0.17500, 0.17900, 0.18400, 0.19300,
    0.20300, 0.21300, 0.22000, 0.23600, 0.24100,
    0.24800, 0.25700, 0.26900, 0.28000, 0.28900,
    0.30000, 0.31400, 0.33700, 0.34600, 0.36100,
    0.38200, 0.40400, 0.42500, 0.43900, 0.46400,
    0.47600, 0.49000}
   },
  /* 2 Light skin */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.09200, 0.10900, 0.13400, 0.16100, 0.18600,
    0.20000, 0.20500, 0.20600, 0.20700, 0.20900,
    0.21100, 0.21300, 0.21600, 0.22100, 0.22700,
    0.23700, 0.24600, 0.25900, 0.27300, 0.28500,
    0.29400, 0.30400, 0.30500, 0.30900, 0.31400,
    0.32300, 0.33400, 0.34000, 0.33200, 0.31600,
    0.30000, 0.29200, 0.29000, 0.29500, 0.30000,
    0.30200, 0.29700, 0.29500, 0.30400, 0.32800,
    0.36500, 0.40900, 0.45000, 0.48800, 0.52000,
    0.54000, 0.55600, 0.56600, 0.57400, 0.58200,
    0.59300, 0.60200, 0.60700, 0.62500, 0.63100,
    0.63900, 0.65500, 0.66100, 0.68700, 0.69300,
    0.71100, 0.72200, 0.73700, 0.75700, 0.76800,
    0.78600, 0.79800, 0.81500, 0.82200, 0.82300,
    0.83500, 0.84500, 0.85500, 0.84800, 0.86200,
    0.86100, 0.86800}
   },
  /* 3 Blue sky */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.10500, 0.12700, 0.16400, 0.21300, 0.27100,
    0.31400, 0.33300, 0.34400, 0.34500, 0.34400,
    0.34600, 0.34600, 0.34700, 0.34300, 0.33700,
    0.33300, 0.32700, 0.32400, 0.31900, 0.30600,
    0.29000, 0.28800, 0.28000, 0.27400, 0.26500,
    0.25800, 0.25000, 0.24000, 0.22900, 0.22000,
    0.21200, 0.20700, 0.20300, 0.19800, 0.19300,
    0.19100, 0.18700, 0.18100, 0.17400, 0.17000,
    0.16700, 0.16200, 0.15800, 0.16100, 0.15600,
    0.15200, 0.15000, 0.14500, 0.14200, 0.13700,
    0.13300, 0.13200, 0.12600, 0.12700, 0.12100,
    0.11800, 0.11500, 0.11500, 0.11200, 0.11000,
    0.11000, 0.10900, 0.10800, 0.10800, 0.10600,
    0.10500, 0.10500, 0.10600, 0.10600, 0.10500,
    0.10700, 0.10500, 0.10600, 0.10500, 0.10800,
    0.10700, 0.11000}
   },
  /* 4 Foliage */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.05000, 0.05200, 0.05200, 0.05000, 0.05200,
    0.05200, 0.05200, 0.05300, 0.05100, 0.05300,
    0.05300, 0.05300, 0.05500, 0.05800, 0.05900,
    0.06100, 0.06000, 0.06300, 0.06300, 0.06700,
    0.06500, 0.06700, 0.06900, 0.07200, 0.07700,
    0.08800, 0.10500, 0.13200, 0.15900, 0.18200,
    0.19500, 0.19900, 0.19100, 0.18000, 0.16700,
    0.15600, 0.14400, 0.13300, 0.13100, 0.13000,
    0.12900, 0.12300, 0.11800, 0.11400, 0.11000,
    0.10200, 0.10100, 0.10300, 0.10400, 0.10500,
    0.10500, 0.10600, 0.10200, 0.10200, 0.10100,
    0.10100, 0.10100, 0.10100, 0.10700, 0.11500,
    0.13200, 0.15200, 0.18500, 0.23300, 0.28300,
    0.33900, 0.38300, 0.41900, 0.44400, 0.44500,
    0.46500, 0.47300, 0.47700, 0.48000, 0.48900,
    0.49200, 0.49800}
   },
  /* 5 Blue flower */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.10100, 0.12700, 0.17000, 0.23300, 0.31000,
    0.37300, 0.40900, 0.42400, 0.43200, 0.43700,
    0.43700, 0.43800, 0.43700, 0.43200, 0.42800,
    0.42300, 0.41700, 0.41200, 0.40500, 0.39500,
    0.38000, 0.37300, 0.36400, 0.35500, 0.34200,
    0.33300, 0.31600, 0.29600, 0.26700, 0.24500,
    0.22700, 0.21200, 0.20600, 0.20300, 0.20300,
    0.20400, 0.19600, 0.19000, 0.19000, 0.19400,
    0.20100, 0.21000, 0.21600, 0.22500, 0.22800,
    0.23200, 0.23800, 0.24000, 0.23600, 0.23600,
    0.24000, 0.24800, 0.26100, 0.28900, 0.32200,
    0.36200, 0.40700, 0.44600, 0.48800, 0.51200,
    0.54600, 0.54600, 0.55500, 0.56300, 0.56400,
    0.57500, 0.57800, 0.58600, 0.59000, 0.58900,
    0.60100, 0.60400, 0.60600, 0.60500, 0.61400,
    0.61600, 0.61700}
   },
  /* 6 Bluish green */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.10800, 0.13200, 0.16800, 0.21300, 0.26000,
    0.29200, 0.30800, 0.31700, 0.32000, 0.32800,
    0.33600, 0.34200, 0.35200, 0.36000, 0.37100,
    0.38600, 0.40500, 0.43300, 0.46500, 0.49700,
    0.52800, 0.55700, 0.57600, 0.59100, 0.58600,
    0.59100, 0.58600, 0.58200, 0.56700, 0.55900,
    0.54500, 0.53300, 0.51200, 0.49200, 0.47200,
    0.44500, 0.42900, 0.40200, 0.38000, 0.35500,
    0.33200, 0.30900, 0.28400, 0.26200, 0.24700,
    0.23300, 0.22400, 0.21700, 0.21200, 0.20900,
    0.20700, 0.20500, 0.20000, 0.19800, 0.19900,
    0.19700, 0.19900, 0.20300, 0.21000, 0.21600,
    0.21800, 0.22600, 0.23200, 0.23600, 0.23800,
    0.24200, 0.24200, 0.23900, 0.23200, 0.22700,
    0.22900, 0.23000, 0.23700, 0.24800, 0.25600,
    0.26900, 0.27400}
   },
  /* 7 Orange */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.05200, 0.05400, 0.05200, 0.05000, 0.05200,
    0.05200, 0.05200, 0.05100, 0.05000, 0.05000,
    0.05200, 0.05000, 0.05100, 0.05100, 0.05200,
    0.05100, 0.05100, 0.05300, 0.05300, 0.05400,
    0.05500, 0.05600, 0.05500, 0.05800, 0.06100,
    0.06300, 0.06800, 0.07700, 0.08600, 0.09800,
    0.12000, 0.14500, 0.17500, 0.20600, 0.23600,
    0.27000, 0.30200, 0.34100, 0.37500, 0.41000,
    0.44000, 0.46700, 0.48800, 0.50900, 0.51800,
    0.53200, 0.54000, 0.55100, 0.55700, 0.56200,
    0.56800, 0.57500, 0.58100, 0.58400, 0.58500,
    0.59000, 0.60100, 0.59600, 0.60000, 0.59600,
    0.60400, 0.60300, 0.60600, 0.60700, 0.60800,
    0.61500, 0.61700, 0.62100, 0.62200, 0.61900,
    0.62500, 0.62800, 0.63000, 0.62700, 0.63500,
    0.63900, 0.64000}
   },
  /* 8 Purplish blue */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.09400, 0.11300, 0.14100, 0.18600, 0.23500,
    0.27500, 0.29700, 0.31600, 0.31700, 0.33300,
    0.34600, 0.35500, 0.36800, 0.37800, 0.38100,
    0.37700, 0.36800, 0.35600, 0.34000, 0.32200,
    0.29600, 0.26900, 0.24100, 0.22000, 0.19700,
    0.18200, 0.16600, 0.15100, 0.13800, 0.12700,
    0.12000, 0.11500, 0.10800, 0.10400, 0.10100,
    0.09500, 0.09000, 0.08400, 0.08200, 0.08100,
    0.08100, 0.08100, 0.08100, 0.08300, 0.08300,
    0.08000, 0.07900, 0.08000, 0.08100, 0.08100,
    0.08400, 0.08900, 0.09200, 0.09600, 0.10300,
    0.10700, 0.11200, 0.11100, 0.11200, 0.10900,
    0.10400, 0.10200, 0.09900, 0.09900, 0.10000,
    0.10000, 0.10300, 0.10600, 0.10900, 0.11300,
    0.12200, 0.12700, 0.13800, 0.15300, 0.17300,
    0.19300, 0.21500}
   },
  /* 9 Moderate red */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.08800, 0.10200, 0.12100, 0.13600, 0.15100,
    0.15300, 0.15100, 0.14400, 0.14200, 0.14100,
    0.13900, 0.13500, 0.13600, 0.13500, 0.13300,
    0.13200, 0.12900, 0.13000, 0.12900, 0.12700,
    0.12100, 0.11800, 0.10900, 0.10500, 0.10500,
    0.10400, 0.10100, 0.10000, 0.09400, 0.09100,
    0.08900, 0.09200, 0.09500, 0.09700, 0.10400,
    0.10900, 0.11100, 0.11300, 0.11600, 0.13400,
    0.16700, 0.22300, 0.29100, 0.36200, 0.42600,
    0.47400, 0.51100, 0.53700, 0.55100, 0.56200,
    0.56500, 0.57000, 0.57500, 0.57400, 0.57900,
    0.57700, 0.57900, 0.57700, 0.58000, 0.58100,
    0.57900, 0.58100, 0.58100, 0.58300, 0.58100,
    0.58100, 0.58000, 0.58600, 0.58500, 0.58400,
    0.58900, 0.58700, 0.59000, 0.58200, 0.58900,
    0.59200, 0.59000}
   },
  /* 10 Purple */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.08300, 0.10000, 0.12500, 0.15400, 0.18300,
    0.19800, 0.20600, 0.20700, 0.20700, 0.20100,
    0.19400, 0.18400, 0.17500, 0.16300, 0.15400,
    0.14200, 0.12900, 0.12000, 0.10900, 0.10200,
    0.09500, 0.09000, 0.08100, 0.07700, 0.07000,
    0.06700, 0.06500, 0.06300, 0.05900, 0.05800,
    0.05600, 0.05300, 0.05200, 0.05200, 0.05100,
    0.05300, 0.05500, 0.05600, 0.05400, 0.05200,
    0.05300, 0.04900, 0.05100, 0.05500, 0.05800,
    0.06300, 0.07300, 0.08700, 0.10300, 0.12000,
    0.13700, 0.14900, 0.16100, 0.17500, 0.18800,
    0.19700, 0.20800, 0.21800, 0.22900, 0.24100,
    0.24900, 0.26200, 0.27200, 0.28400, 0.29200,
    0.30400, 0.31200, 0.32500, 0.32900, 0.33300,
    0.34300, 0.34600, 0.35000, 0.35000, 0.35900,
    0.36000, 0.36200}
   },
  /* 11 Yellow green */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.04500, 0.04800, 0.05000, 0.05000, 0.05400,
    0.05300, 0.05300, 0.05500, 0.05300, 0.05700,
    0.05900, 0.05900, 0.06200, 0.06500, 0.07000,
    0.07500, 0.08100, 0.09200, 0.10200, 0.11600,
    0.13600, 0.15800, 0.18500, 0.22500, 0.27400,
    0.32800, 0.39000, 0.44600, 0.48500, 0.51100,
    0.52900, 0.53800, 0.53900, 0.53500, 0.52600,
    0.52100, 0.51100, 0.50000, 0.48400, 0.46700,
    0.45000, 0.43500, 0.41200, 0.39500, 0.37700,
    0.36300, 0.35200, 0.34600, 0.33900, 0.33700,
    0.33700, 0.33100, 0.32600, 0.32200, 0.32300,
    0.32000, 0.32500, 0.32700, 0.33400, 0.34000,
    0.34700, 0.35500, 0.36200, 0.36900, 0.37300,
    0.37600, 0.37500, 0.37900, 0.37200, 0.36500,
    0.36700, 0.37500, 0.37900, 0.38800, 0.40300,
    0.41500, 0.43000}
   },
  /* 12 Orange yellow */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.04900, 0.05200, 0.05400, 0.05500, 0.05400,
    0.05700, 0.05700, 0.05900, 0.05700, 0.05700,
    0.05900, 0.05700, 0.05800, 0.06000, 0.06100,
    0.06100, 0.06200, 0.06700, 0.07200, 0.08100,
    0.08800, 0.09800, 0.10600, 0.11200, 0.12000,
    0.13000, 0.14300, 0.16300, 0.18800, 0.21800,
    0.25600, 0.30400, 0.35100, 0.39900, 0.44200,
    0.47600, 0.50500, 0.53200, 0.54400, 0.56100,
    0.57900, 0.53900, 0.59700, 0.60400, 0.61700,
    0.61700, 0.61800, 0.62400, 0.62500, 0.63000,
    0.64700, 0.63500, 0.63800, 0.64200, 0.64900,
    0.65000, 0.64900, 0.65000, 0.67700, 0.65700,
    0.65300, 0.65900, 0.65800, 0.66200, 0.66100,
    0.66600, 0.66800, 0.67200, 0.67100, 0.66700,
    0.67700, 0.67800, 0.68200, 0.67800, 0.68600,
    0.69300, 0.69000}
   },
  /* 13 Blue */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.06800, 0.08400, 0.10400, 0.12700, 0.15600,
    0.17800, 0.19400, 0.20900, 0.22100, 0.23400,
    0.25000, 0.26400, 0.28700, 0.30800, 0.31800,
    0.32300, 0.31700, 0.30300, 0.27600, 0.25500,
    0.22500, 0.19300, 0.16000, 0.13900, 0.11700,
    0.10400, 0.08700, 0.07700, 0.06600, 0.06000,
    0.05600, 0.05300, 0.05000, 0.04700, 0.04500,
    0.04200, 0.04300, 0.04000, 0.04000, 0.03800,
    0.03800, 0.03700, 0.03600, 0.03700, 0.03800,
    0.03600, 0.03700, 0.03700, 0.03700, 0.03900,
    0.03900, 0.04200, 0.04000, 0.04200, 0.04400,
    0.04500, 0.04700, 0.04800, 0.05000, 0.04800,
    0.04600, 0.05000, 0.04800, 0.05100, 0.04900,
    0.05200, 0.05400, 0.05700, 0.06000, 0.06500,
    0.06900, 0.07600, 0.08700, 0.10200, 0.12300,
    0.14700, 0.17400}
   },
  /* 14 Green */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.04500, 0.04800, 0.05400, 0.05400, 0.05700,
    0.05900, 0.06000, 0.06000, 0.06000, 0.06200,
    0.05400, 0.06400, 0.06900, 0.07000, 0.07500,
    0.07900, 0.08300, 0.09000, 0.09900, 0.10900,
    0.12000, 0.13200, 0.14400, 0.15800, 0.17500,
    0.19600, 0.23100, 0.27200, 0.30700, 0.33800,
    0.35200, 0.35700, 0.35300, 0.34100, 0.32300,
    0.30500, 0.28600, 0.26500, 0.24400, 0.22400,
    0.20300, 0.18000, 0.16100, 0.14400, 0.12400,
    0.10800, 0.09800, 0.08900, 0.08400, 0.08000,
    0.07600, 0.07500, 0.07100, 0.07100, 0.07000,
    0.06700, 0.06700, 0.06700, 0.06800, 0.07000,
    0.07000, 0.07400, 0.07600, 0.07900, 0.08000,
    0.08200, 0.08600, 0.08500, 0.08300, 0.08100,
    0.08100, 0.08100, 0.08300, 0.08600, 0.09100,
    0.09400, 0.09800}
   },
  /* 15 Red */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.04300, 0.04500, 0.04600, 0.04500, 0.04700,
    0.04600, 0.04800, 0.04600, 0.04600, 0.04600,
    0.04800, 0.04400, 0.04600, 0.04700, 0.04700,
    0.04700, 0.04600, 0.04600, 0.04400, 0.04400,
    0.04000, 0.04200, 0.03900, 0.04000, 0.04000,
    0.03900, 0.04000, 0.04000, 0.03800, 0.03800,
    0.03900, 0.03800, 0.04000, 0.04000, 0.04100,
    0.04200, 0.04400, 0.04600, 0.04700, 0.05400,
    0.06400, 0.08100, 0.11200, 0.15600, 0.21600,
    0.28300, 0.35800, 0.43400, 0.49900, 0.54900,
    0.58500, 0.60700, 0.62400, 0.63300, 0.65000,
    0.65200, 0.65200, 0.65600, 0.66100, 0.66600,
    0.66400, 0.67100, 0.67100, 0.67700, 0.67300,
    0.67800, 0.68000, 0.68900, 0.68800, 0.68500,
    0.69100, 0.69400, 0.69600, 0.69200, 0.69800,
    0.70400, 0.70000}
   },
  /* 16 Yellow */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.04700, 0.04700, 0.04800, 0.04700, 0.05000,
    0.05200, 0.05200, 0.05100, 0.05100, 0.05300,
    0.05300, 0.05300, 0.05700, 0.05600, 0.05800,
    0.06000, 0.06200, 0.06700, 0.07600, 0.09000,
    0.10900, 0.14200, 0.18300, 0.22800, 0.27400,
    0.31900, 0.36000, 0.40500, 0.44300, 0.47500,
    0.51000, 0.54400, 0.57100, 0.59400, 0.61200,
    0.63000, 0.64600, 0.65600, 0.66800, 0.67700,
    0.69100, 0.69600, 0.70100, 0.70200, 0.72900,
    0.70100, 0.70400, 0.70700, 0.70800, 0.71300,
    0.72100, 0.71600, 0.71700, 0.71800, 0.72600,
    0.72900, 0.73000, 0.72800, 0.74700, 0.73900,
    0.73700, 0.74300, 0.74000, 0.75600, 0.74200,
    0.74900, 0.75100, 0.75300, 0.75400, 0.75000,
    0.76000, 0.76200, 0.76900, 0.76200, 0.77400,
    0.77600, 0.77900}
   },
  /* 17 Magenta */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.10600, 0.12900, 0.16800, 0.22900, 0.29700,
    0.34600, 0.36700, 0.37200, 0.37700, 0.37300,
    0.36200, 0.35100, 0.34000, 0.32300, 0.30600,
    0.29300, 0.27600, 0.25900, 0.25000, 0.23400,
    0.22000, 0.20600, 0.19000, 0.17900, 0.16900,
    0.16300, 0.15200, 0.14000, 0.12600, 0.11300,
    0.10400, 0.09800, 0.09800, 0.10200, 0.10400,
    0.10300, 0.10400, 0.10300, 0.10600, 0.11800,
    0.14000, 0.17000, 0.21200, 0.25700, 0.31300,
    0.35400, 0.40300, 0.45700, 0.50100, 0.54600,
    0.58700, 0.61200, 0.63700, 0.65500, 0.67700,
    0.68400, 0.69300, 0.69500, 0.71400, 0.71000,
    0.72000, 0.71500, 0.71400, 0.73900, 0.71900,
    0.72600, 0.72800, 0.73300, 0.73700, 0.73200,
    0.74300, 0.74200, 0.74800, 0.74100, 0.75300,
    0.75400, 0.76100}
   },
  /* 18 Cyan */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.08500, 0.10200, 0.13000, 0.16300, 0.20100,
    0.22800, 0.24700, 0.25400, 0.26200, 0.27800,
    0.28200, 0.30000, 0.31900, 0.33200, 0.34800,
    0.36300, 0.38200, 0.40100, 0.41900, 0.43100,
    0.43800, 0.44100, 0.43800, 0.42900, 0.41500,
    0.40400, 0.38100, 0.35800, 0.33900, 0.31600,
    0.28800, 0.26200, 0.23600, 0.21000, 0.18600,
    0.16200, 0.14200, 0.12900, 0.11600, 0.10500,
    0.09900, 0.09200, 0.08800, 0.08600, 0.08100,
    0.07700, 0.07800, 0.07600, 0.07600, 0.07600,
    0.07600, 0.07600, 0.07600, 0.07700, 0.07800,
    0.07700, 0.08100, 0.08000, 0.08100, 0.07900,
    0.07900, 0.07900, 0.07700, 0.07600, 0.07500,
    0.07400, 0.07400, 0.07600, 0.07700, 0.08100,
    0.08400, 0.09000, 0.09800, 0.11100, 0.13000,
    0.15100, 0.17900}
   },
  /* 19 White */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.12600, 0.16900, 0.21200, 0.26400, 0.31800,
    0.49100, 0.66400, 0.75700, 0.85100, 0.86800,
    0.88700, 0.88800, 0.89000, 0.89300, 0.89500,
    0.89600, 0.89800, 0.90000, 0.90200, 0.90000,
    0.89700, 0.90400, 0.90100, 0.90000, 0.90000,
    0.89800, 0.89700, 0.90000, 0.90200, 0.90200,
    0.90100, 0.90000, 0.89900, 0.89600, 0.89300,
    0.89500, 0.89800, 0.90000, 0.90200, 0.90400,
    0.90500, 0.90600, 0.90700, 0.90500, 0.90300,
    0.90400, 0.90500, 0.90700, 0.89800, 0.89700,
    0.89600, 0.89800, 0.90000, 0.90000, 0.89900,
    0.90100, 0.90400, 0.90400, 0.90500, 0.90200,
    0.89900, 0.89900, 0.90000, 0.89900, 0.89800,
    0.89800, 0.89900, 0.89800, 0.89800, 0.89900,
    0.90100, 0.89800, 0.89600, 0.89500, 0.89800,
    0.89900, 0.89800}
   },
  /* 20 Neutral 8 */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.08400, 0.11300, 0.14100, 0.17600, 0.21100,
    0.32700, 0.44200, 0.50400, 0.56700, 0.57800,
    0.59000, 0.59100, 0.59200, 0.59400, 0.59500,
    0.59600, 0.59700, 0.59900, 0.60000, 0.59900,
    0.59700, 0.60200, 0.59900, 0.59900, 0.59900,
    0.59700, 0.59700, 0.59900, 0.60000, 0.60000,
    0.59900, 0.59900, 0.59800, 0.59600, 0.59400,
    0.59500, 0.59700, 0.59900, 0.60000, 0.60200,
    0.60200, 0.60300, 0.60400, 0.60200, 0.60100,
    0.60200, 0.60200, 0.60400, 0.59700, 0.59700,
    0.59600, 0.59700, 0.59900, 0.59900, 0.59800,
    0.59900, 0.60200, 0.60200, 0.60200, 0.60000,
    0.59800, 0.59800, 0.59900, 0.59800, 0.59700,
    0.59700, 0.59800, 0.59700, 0.59700, 0.59800,
    0.59900, 0.59700, 0.59600, 0.59500, 0.59700,
    0.59800, 0.59700}
   },
  /* 21 Neutral 6.5 */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.05100, 0.06800, 0.08500, 0.10600, 0.12800,
    0.19800, 0.26700, 0.30500, 0.34200, 0.34900,
    0.35700, 0.35700, 0.35800, 0.35900, 0.36000,
    0.36000, 0.36100, 0.36200, 0.36300, 0.36200,
    0.36100, 0.36400, 0.36200, 0.36200, 0.36200,
    0.36100, 0.36100, 0.36200, 0.36300, 0.36300,
    0.36200, 0.36200, 0.36100, 0.36000, 0.35900,
    0.36000, 0.36100, 0.36200, 0.36300, 0.36400,
    0.36400, 0.36400, 0.36500, 0.36400, 0.36300,
    0.36400, 0.36400, 0.36500, 0.36100, 0.36100,
    0.36000, 0.36100, 0.36200, 0.36200, 0.36100,
    0.36200, 0.36400, 0.36400, 0.36400, 0.36300,
    0.36100, 0.36100, 0.36200, 0.36100, 0.36100,
    0.36100, 0.36100, 0.36100, 0.36100, 0.36100,
    0.36200, 0.36100, 0.36000, 0.36000, 0.36100,
    0.36100, 0.36100}
   },
  /* 22 Neutral 5 */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.02770, 0.03720, 0.04650, 0.05800, 0.06980,
    0.10790, 0.14570, 0.16630, 0.18690, 0.19070,
    0.19470, 0.19490, 0.19540, 0.19600, 0.19650,
    0.19670, 0.19710, 0.19760, 0.19800, 0.19760,
    0.19690, 0.19850, 0.19780, 0.19760, 0.19760,
    0.19710, 0.19690, 0.19760, 0.19800, 0.19800,
    0.19780, 0.19760, 0.19740, 0.19670, 0.19600,
    0.19650, 0.19710, 0.19760, 0.19800, 0.19850,
    0.19870, 0.19890, 0.19910, 0.19870, 0.19820,
    0.19850, 0.19870, 0.19910, 0.19710, 0.19690,
    0.19670, 0.19710, 0.19760, 0.19760, 0.19740,
    0.19780, 0.19850, 0.19850, 0.19870, 0.19800,
    0.19740, 0.19740, 0.19760, 0.19740, 0.19710,
    0.19710, 0.19740, 0.19710, 0.19710, 0.19740,
    0.19780, 0.19710, 0.19670, 0.19650, 0.19710,
    0.19740, 0.19710}
   },
  /* 23 Neutral 3.5 */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.01260, 0.01690, 0.02120, 0.02640, 0.03180,
    0.04910, 0.06640, 0.07570, 0.08510, 0.08680,
    0.08860, 0.08870, 0.08890, 0.08930, 0.08950,
    0.08960, 0.08980, 0.09000, 0.09020, 0.09000,
    0.08970, 0.09040, 0.09010, 0.09000, 0.09000,
    0.08980, 0.08970, 0.09000, 0.09020, 0.09020,
    0.09010, 0.09000, 0.08990, 0.08960, 0.08930,
    0.08950, 0.08980, 0.09000, 0.09020, 0.09040,
    0.09050, 0.09060, 0.09070, 0.09050, 0.09030,
    0.09040, 0.09050, 0.09070, 0.08980, 0.08970,
    0.08960, 0.08980, 0.09000, 0.09000, 0.08990,
    0.09010, 0.09040, 0.09040, 0.09050, 0.09020,
    0.08990, 0.08990, 0.09000, 0.08990, 0.08980,
    0.08980, 0.08990, 0.08980, 0.08980, 0.08990,
    0.09010, 0.08980, 0.08960, 0.08950, 0.08980,
    0.08990, 0.08980}
   },
  /* 24 Black */
  {
   77, 380.0, 760.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {
    0.00439, 0.00589, 0.00737, 0.00919, 0.01105,
    0.01708, 0.02308, 0.02635, 0.02961, 0.03020,
    0.03084, 0.03087, 0.03094, 0.03105, 0.03112,
    0.03115, 0.03122, 0.03129, 0.03136, 0.03129,
    0.03119, 0.03143, 0.03133, 0.03129, 0.03129,
    0.03122, 0.03119, 0.03129, 0.03136, 0.03136,
    0.03133, 0.03129, 0.03126, 0.03115, 0.03105,
    0.03112, 0.03122, 0.03129, 0.03136, 0.03143,
    0.03147, 0.03150, 0.03154, 0.03147, 0.03140,
    0.03143, 0.03147, 0.03154, 0.03122, 0.03119,
    0.03115, 0.03122, 0.03129, 0.03129, 0.03126,
    0.03133, 0.03143, 0.03143, 0.03147, 0.03136,
    0.03126, 0.03126, 0.03129, 0.03126, 0.03122,
    0.03122, 0.03126, 0.03122, 0.03122, 0.03126,
    0.03133, 0.03122, 0.03115, 0.03112, 0.03122,
    0.03126, 0.03122}
   },
  /* 30 added backlight white.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {1, 1}
   },
  /* 26 added gray.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {4 / 5.0, 4 / 5.0}
   },
  /* 27 added gray.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {3 / 5.0, 3 / 5.0}
   },
  /* 28 added gray.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {2 / 5.0, 2 / 5.0}
   },
  /* 29 added gray.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {1 / 5.0, 1 / 5.0}
   },
  /* 25 added black.  */
  {
   2, 380.0, 780.0,		/* 77 bands from 380 to 760 nm in 5nm steps */
   1.0,				/* Scale factor */
   {0, 0}
   },
  /* 26 my skin try 2.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   50,				/* Scale factor.  */
   {11.05781, 12.29471, 12.77711, 12.84787, 12.91089, 13.61572, 15.31931,
    17.30442, 19.05421, 20.32610, 21.11653, 21.71328, 22.47914, 23.01395,
    22.98638, 22.24767, 21.56637, 21.33456, 21.43618, 21.75184, 22.18575,
    24.94142, 28.16140, 30.05566, 30.97144, 31.21856, 31.30698, 31.36347,
    31.47188, 31.38079, 31.47548, 31.33909, 31.45063, 31.24354, 30.10174,
    28.23979}
   },
  /* 27 paprika.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   20,				/* Scale factor.  */
   {1.906835, 1.938999, 1.889491, 1.828394, 1.783566, 1.721460, 1.668272,
    1.644804, 1.627632, 1.605743, 1.576768, 1.563838, 1.562760, 1.566539,
    1.580958, 1.611949, 1.674046, 1.808827, 2.073560, 2.626282, 3.622958,
    5.143784, 6.974639, 8.666264, 9.972983, 10.79505, 11.26441, 11.49941,
    11.60748, 11.54034, 11.53023, 11.42045, 11.42383, 11.24037, 10.59212,
    9.657345}
   },
#if 0
  /* 26 my skin try 1.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   20,				/* Scale factor.  */
   {5.394621, 6.099174, 6.514502, 6.529451, 6.779758, 7.363187, 8.084518,
    8.737588, 9.519582, 10.22716, 10.68055, 10.79956, 11.20590, 11.56449,
    11.77895, 11.64186, 11.38929, 11.22360, 11.21184, 11.34279, 11.56265,
    12.96909, 14.72412, 15.77141, 16.29990, 16.43326, 16.48844, 16.55361,
    16.67534, 16.63674, 16.77187, 16.71653, 16.87816, 16.69063, 15.62913,
    13.98665}
   },
#endif
  /* 26 lemon.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   50,				/* Scale factor.  */
   //100,                  /* Scale factor.  */
   {3.289540, 3.257631, 3.111730, 3.164866, 3.303574, 3.359016, 3.472269,
    3.842140, 4.332043, 4.857711, 5.375723, 6.292153, 8.312763, 11.80561,
    16.82850, 21.85183, 25.46601, 27.60164, 28.77972, 30.41682, 31.65333,
    32.49346, 33.22311, 33.65060, 33.85559, 33.83316, 33.91016, 34.05925,
    34.24132, 34.14090, 34.30626, 34.51846, 34.94987, 34.89717, 33.79895,
    31.98493}
   },
#if 0
  /* 28 cameraback.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   50,				/* Scale factor.  */
   //100,                  /* Scale factor.  */
   {0.770405, 0.765791, 0.793526, 0.811531, 0.877929, 0.952244, 1.011818,
    1.055026, 1.145591, 1.246965, 1.357303, 1.494646, 1.705871, 1.993166,
    2.364005, 2.819393, 3.373086, 4.039928, 4.799112, 5.689959, 6.661289,
    7.745727, 8.933324, 10.21910, 11.58699, 13.04088, 14.61079, 16.25992,
    18.03257, 19.80185, 21.66983, 23.52554, 25.52820, 27.49729, 29.06403,
    30.18065}
   },
#endif
  /* 28 dufay red.  */
  {
   65, 400, 720,		/* 38 bands from 380 to 730 nm in 10nm steps */
   1,				/* Scale factor.  */
   //100,                  /* Scale factor.  */
   {0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.002696, 0.010334,
    0.013055, 0.014041, 0.012851, 0.010568, 0.006736, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000000, 0.000000, 0.004001, 0.013760, 0.033045,
    0.083378, 0.190017, 0.367571, 0.516993, 0.618965, 0.689137, 0.732547,
    0.755899, 0.756910, 0.745196, 0.729635, 0.717315, 0.712176, 0.718364,
    0.728261, 0.737378, 0.746320, 0.753330, 0.759521, 0.764271, 0.768694,
    0.770658, 0.772585, 0.773816, 0.774378, 0.774643, 0.774987, 0.774631,
    0.774050, 0.772958}
   },
  /* 28 dufay green.  */
  {
   65, 400, 720,		/* 38 bands from 380 to 730 nm in 10nm steps */
   1,				/* Scale factor.  */
   //100,                  /* Scale factor.  */
   {0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.002439, 0.020093, 0.059809, 0.145953, 0.256214, 0.386163,
    0.505990, 0.594740, 0.663598, 0.709551, 0.743586, 0.756088, 0.752206,
    0.731717, 0.695169, 0.651583, 0.604720, 0.553163, 0.496591, 0.435238,
    0.369605, 0.309213, 0.253598, 0.206198, 0.164608, 0.131160, 0.104012,
    0.079996, 0.061624, 0.046459, 0.033809, 0.024319, 0.016887, 0.011850,
    0.008767, 0.005510, 0.002365, 0.001923, 0.001431, 0.001478, 0.005615,
    0.012184, 0.020263, 0.031950, 0.047929, 0.071303, 0.104594, 0.131432,
    0.154813, 0.170212}
   },
  /* 28 dufay blue.  */
  {
   65, 400, 720,		/* 38 bands from 380 to 730 nm in 10nm steps */
   1,				/* Scale factor.  */
   //100,                  /* Scale factor.  */
   {0.832491, 0.832456, 0.831930, 0.831256, 0.829771, 0.827719, 0.824506,
    0.819455, 0.812202, 0.801174, 0.787632, 0.770413, 0.749097, 0.722185,
    0.687022, 0.644162, 0.598425, 0.548207, 0.494298, 0.435497, 0.374322,
    0.311315, 0.242828, 0.180848, 0.127324, 0.083722, 0.051398, 0.029365,
    0.016829, 0.008442, 0.002156, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
    0.000000, 0.000000, 0.000512, 0.003074, 0.005060, 0.008763, 0.013179,
    0.019340, 0.027843, 0.041467, 0.063377, 0.096691, 0.144813, 0.212883,
    0.294723, 0.398689, 0.511248, 0.610764, 0.701393, 0.780466, 0.850278,
    0.910583, 0.958122}
   },
#if 0
  /* 26 apple - red side.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   //40,                   /* Scale factor.  */
   100,				/* Scale factor.  */
   {12.29320, 14.91417, 16.94740, 18.00284, 18.31063, 18.58714, 19.09704,
    19.57142, 20.98749, 22.28574, 21.87497, 22.98576, 27.17269, 31.23415,
    33.92229, 35.20855, 35.73557, 36.04229, 36.49577, 37.67225, 38.65415,
    39.43871, 40.08702, 40.22320, 39.96641, 39.58092, 38.86267, 37.56768,
    36.25365, 34.02495, 34.42090, 38.70321, 42.06588, 42.83562, 41.83832,
    39.83841}
   },
  /* 26 apple.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   //40,                   /* Scale factor.  */
   100,				/* Scale factor.  */
   {5.017156, 5.799308, 6.651679, 7.197589, 7.515764, 7.651249, 7.758853,
    8.186890, 8.988460, 9.449025, 9.181721, 9.730423, 11.98186, 14.53065,
    16.54406, 17.69502, 18.26621, 18.80229, 19.68748, 21.23705, 22.82158,
    24.28686, 25.50317, 25.88684, 25.51061, 25.07344, 23.98048, 21.94753,
    19.95180, 17.16765, 17.79104, 24.27627, 30.61135, 32.78469, 32.25073,
    30.39502}
   },
  /* 28 leek.  */
  {
   36, 380, 730,		/* 38 bands from 380 to 730 nm in 10nm steps */
   //40,                   /* Scale factor.  */
   100,				/* Scale factor.  */
   {22.33790, 23.18203, 22.87664, 22.51028, 22.86318, 23.18963, 23.67381,
    24.72237, 25.90513, 26.54361, 26.78424, 27.59191, 30.46119, 34.59954,
    38.69026, 41.35623, 42.38198, 42.54165, 42.20121, 41.80285, 40.99451,
    40.38363, 40.04041, 39.51755, 38.75554, 38.15305, 36.91506, 34.75365,
    33.19346, 31.01460, 31.57473, 37.57588, 43.73461, 46.06924, 45.86260,
    44.34373}
   },
#endif
// http://www2.uef.fi/sv/spectral/natural-colors retrieved April 2015,
// taken from dcamprof.
//green leaf (leskenlehti)
#define KUOPIO_NATURAL_SCALE 3000
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
    525, 273, 0, 378, 318, 164, 224, 276, 316, 266, 303, 290, 305, 286, 290,
    303, 323, 323, 352, 383, 405, 482, 614, 743, 920, 1015, 1139, 1192, 1175,
    1216,
    1195, 1145, 1116, 1009, 947, 867, 802, 754, 741, 709, 675, 625, 574, 579,
    561,
    565, 557, 511, 471, 419, 399, 372, 365, 395, 375, 382, 458, 555, 716,
    1002,
    1407,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (keltano)
    0, 658, 45, 0, 0, 131, 98, 84, 123, 104, 131, 112, 121, 121, 139,
    128, 148, 199, 296, 389, 476, 689, 945, 1132, 1326, 1490, 1674, 1741,
    1775, 1868,
    1914, 1928, 1961, 1972, 1992, 2045, 2064, 2053, 2048, 2072, 2086, 2081,
    2069, 2056, 2073,
    2096, 2114, 2067, 2089, 2100, 2061, 2019, 1983, 1971, 1961, 2016, 1956,
    1946, 1922, 1983,
    1991,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (keltano)
    472, 439, 315, 333, 222, 179, 167, 140, 149, 153, 148, 134, 149, 157, 171,
    165, 156, 181, 189, 198, 223, 263, 312, 361, 405, 449, 495, 504, 525, 535,
    522, 519, 507, 489, 463, 463, 444, 428, 427, 417, 400, 389, 349, 352, 347,
    353, 351, 329, 296, 286, 259, 251, 225, 203, 212, 204, 236, 296, 358, 466,
    549,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (kannusruoho)
    1732, 951, 720, 999, 691, 930, 1014, 1097, 1332, 1423, 1469, 1629, 1763,
    1848, 1922,
    1937, 2021, 2076, 2159, 2240, 2282, 2376, 2442, 2544, 2576, 2631, 2717,
    2731, 2715, 2833,
    2812, 2801, 2797, 2810, 2797, 2829, 2830, 2819, 2817, 2847, 2816, 2814,
    2808, 2763, 2788,
    2810, 2821, 2790, 2835, 2828, 2774, 2755, 2663, 2651, 2616, 2668, 2615,
    2681, 2706, 2738,
    2754,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (kannusruoho)
    630, 439, 585, 0, 123, 261, 98, 154, 216, 205, 200, 249, 253, 285, 319,
    315, 371, 435, 501, 564, 653, 756, 985, 1169, 1388, 1630, 1881, 2022,
    2169, 2329,
    2357, 2417, 2439, 2485, 2520, 2562, 2616, 2589, 2568, 2598, 2604, 2595,
    2583, 2521, 2562,
    2587, 2633, 2606, 2571, 2550, 2529, 2457, 2445, 2398, 2346, 2389, 2402,
    2366, 2380, 2484,
    2515,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//gray dry flower (pelto-ohake)
    945, 1389, 1530, 1132, 1061, 995, 866, 908, 941, 944, 928, 946, 923, 967,
    996,
    989, 997, 987, 1037, 1038, 1030, 1042, 1073, 1064, 1113, 1126, 1175, 1157,
    1175, 1214,
    1224, 1219, 1221, 1237, 1231, 1260, 1285, 1273, 1279, 1317, 1308, 1327,
    1312, 1306, 1347,
    1376, 1414, 1376, 1380, 1430, 1392, 1374, 1372, 1386, 1435, 1493, 1421,
    1464, 1444, 1458,
    1476,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (pelto-ohake)
    315, 439, 945, 932, 765, 914, 886, 908, 905, 908, 889, 817, 800, 786, 746,
    691, 630, 571, 521, 487, 456, 424, 386, 342, 322, 312, 291, 286, 273, 274,
    262, 263, 279, 276, 289, 320, 357, 398, 431, 506, 616, 694, 790, 863, 954,
    1084, 1204, 1351, 1498, 1633, 1704, 1798, 1890, 1955, 2008, 2091, 2092,
    2081, 2077, 2112,
    2145,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (pelto-ohake)
    0, 366, 360, 233, 173, 179, 157, 175, 206, 205, 180, 179, 173, 178, 187,
    189, 184, 171, 195, 204, 193, 219, 253, 297, 365, 431, 467, 489, 493, 516,
    500, 466, 426, 406, 380, 343, 316, 295, 276, 282, 265, 253, 239, 228, 226,
    229, 238, 237, 216, 221, 219, 217, 212, 219, 229, 258, 284, 309, 375, 487,
    732,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (alsikeapila)
    1260, 585, 765, 1065, 937, 881, 847, 943, 1075, 1053, 1020, 994, 1008,
    1026, 1015,
    980, 962, 949, 925, 908, 880, 864, 843, 814, 802, 749, 698, 691, 677, 660,
    653, 660, 631, 633, 644, 692, 743, 809, 889, 1005, 1160, 1325, 1396, 1450,
    1526,
    1583, 1655, 1674, 1689, 1707, 1675, 1674, 1624, 1576, 1564, 1591, 1613,
    1717, 1851, 1962,
    2033,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (alsikeapila)
    1732, 292, 315, 533, 469, 359, 404, 356, 345, 374, 348, 336, 332, 333,
    342,
    330, 350, 343, 354, 371, 399, 426, 497, 541, 616, 701, 750, 764, 783, 794,
    784, 732, 708, 652, 612, 595, 570, 531, 507, 501, 488, 458, 437, 420, 436,
    424, 417, 389, 380, 378, 371, 350, 333, 350, 394, 379, 446, 491, 575, 734,
    953,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (hevonhierakka)
    1732, 731, 405, 366, 370, 424, 335, 335, 319, 346, 357, 327, 349, 352,
    353,
    348, 367, 378, 382, 385, 372, 411, 406, 410, 420, 420, 438, 438, 450, 471,
    485, 487, 482, 497, 486, 493, 525, 523, 521, 533, 564, 574, 578, 574, 570,
    611, 593, 604, 615, 583, 573, 596, 591, 559, 573, 577, 585, 642, 714, 772,
    848,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry flower (hevonhierakka)
    1102, 366, 315, 233, 222, 179, 118, 161, 118, 141, 138, 154, 171, 171,
    166,
    176, 173, 203, 205, 222, 231, 228, 244, 248, 270, 278, 310, 312, 341, 355,
    376, 379, 379, 398, 422, 451, 470, 486, 510, 536, 560, 596, 608, 616, 636,
    664, 693, 700, 698, 723, 728, 739, 748, 759, 763, 821, 807, 840, 898, 950,
    945,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koristeherukka)
    945, 292, 315, 433, 321, 294, 295, 321, 278, 261, 282, 272, 270, 278, 285,
    274, 277, 268, 269, 283, 275, 309, 325, 389, 450, 493, 551, 557, 587, 585,
    567, 554, 515, 487, 460, 424, 409, 387, 353, 349, 353, 333, 309, 309, 312,
    315, 321, 298, 304, 304, 281, 273, 293, 311, 314, 333, 355, 392, 439, 595,
    811,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red berry (koristeherukka)
    157, 73, 90, 166, 197, 114, 59, 56, 36, 28, 39, 34, 42, 31, 43,
    39, 40, 45, 44, 41, 42, 44, 49, 49, 56, 60, 65, 66, 72, 69,
    72, 65, 72, 75, 78, 97, 119, 138, 170, 184, 230, 263, 283, 284, 301,
    307, 315, 325, 322, 329, 314, 320, 306, 292, 317, 296, 301, 318, 320, 331,
    325,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (koristeherukka)
    945, 585, 450, 566, 518, 408, 453, 363, 396, 394, 370, 355, 369, 361, 360,
    370, 365, 370, 342, 356, 345, 351, 333, 342, 341, 336, 328, 325, 339, 358,
    346, 346, 361, 368, 390, 432, 474, 511, 568, 636, 737, 810, 874, 903, 952,
    1014, 1090, 1087, 1071, 1050, 983, 958, 927, 864, 845, 882, 942, 1136,
    1453, 1872,
    2201,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (hiidenvirna)
    315, 512, 675, 832, 765, 865, 807, 867, 911, 904, 852, 826, 780, 753, 711,
    661, 595, 528, 513, 476, 431, 391, 361, 331, 305, 276, 240, 229, 237, 223,
    212, 208, 215, 205, 203, 195, 209, 212, 222, 266, 296, 322, 356, 352, 388,
    391, 411, 425, 473, 532, 550, 630, 669, 748, 823, 879, 904, 917, 930, 950,
    942,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (voikukka)
    1260, 585, 495, 533, 518, 179, 138, 133, 149, 121, 138, 129, 141, 119,
    137,
    133, 142, 189, 281, 377, 485, 706, 998, 1235, 1427, 1629, 1807, 1891,
    1948, 2033,
    2075, 2097, 2105, 2128, 2159, 2178, 2212, 2218, 2201, 2185, 2199, 2197,
    2156, 2141, 2209,
    2199, 2206, 2140, 2109, 2105, 2077, 2044, 2041, 1987, 1997, 2030, 1980,
    1964, 1947, 1969,
    1991,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green rod (voikukka)
    2205, 1755, 1710, 1365, 1159, 1207, 1024, 1118, 1127, 1141, 1134, 1125,
    1149, 1140, 1120,
    1128, 1139, 1156, 1212, 1273, 1262, 1359, 1461, 1519, 1568, 1599, 1660,
    1668, 1680, 1718,
    1697, 1690, 1672, 1675, 1663, 1644, 1642, 1652, 1626, 1623, 1653, 1621,
    1614, 1590, 1625,
    1609, 1615, 1576, 1509, 1483, 1418, 1391, 1324, 1294, 1267, 1220, 1315,
    1417, 1650, 1861,
    2006,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (voikukka)
    0, 292, 450, 200, 247, 310, 335, 252, 257, 265, 272, 255, 257, 268, 269,
    270, 261, 264, 287, 291, 308, 336, 410, 470, 564, 657, 738, 752, 778, 788,
    772, 743, 672, 639, 599, 551, 509, 480, 476, 465, 446, 407, 383, 388, 382,
    368, 371, 356, 347, 329, 328, 308, 316, 316, 339, 362, 378, 426, 517, 696,
    971,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (niittyleinikki)
    630, 585, 45, 300, 148, 131, 69, 119, 129, 117, 134, 109, 111, 140, 128,
    126, 181, 227, 322, 401, 516, 685, 958, 1154, 1396, 1619, 1778, 1898,
    1990, 2069,
    2099, 2146, 2180, 2220, 2223, 2277, 2331, 2285, 2306, 2324, 2362, 2305,
    2281, 2293, 2331,
    2310, 2342, 2296, 2309, 2273, 2201, 2216, 2114, 2050, 1997, 1993, 1980,
    2060, 2125, 2248,
    2287,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (ojakaersaemoe)
    1732, 951, 1800, 1365, 1801, 1697, 1762, 2103, 2243, 2218, 2200, 2206,
    2255, 2254, 2269,
    2261, 2272, 2251, 2254, 2260, 2256, 2266, 2247, 2269, 2310, 2273, 2345,
    2312, 2301, 2323,
    2302, 2314, 2362, 2355, 2348, 2362, 2396, 2374, 2362, 2381, 2396, 2440,
    2383, 2347, 2422,
    2419, 2472, 2423, 2406, 2425, 2377, 2381, 2380, 2398, 2390, 2404, 2370,
    2375, 2364, 2411,
    2417,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (petunia)
    4095, 4022, 4410, 4095, 4095, 4095, 4193, 4207, 4388, 4328, 4223, 4168,
    4221, 4304, 4245,
    4210, 4212, 4192, 4181, 4233, 4207, 4224, 4197, 4262, 4243, 4241, 4274,
    4257, 4204, 4285,
    4265, 4241, 4267, 4275, 4245, 4276, 4260, 4217, 4217, 4244, 4240, 4186,
    4160, 4156, 4227,
    4286, 4237, 4137, 4202, 4187, 4100, 4112, 4103, 4090, 4125, 4115, 4098,
    4036, 4047, 4105,
    4050,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green rod (petunia)
    1732, 658, 945, 899, 740, 848, 778, 713, 833, 856, 869, 854, 871, 879,
    914,
    898, 943, 1005, 1100, 1185, 1273, 1458, 1659, 1878, 2070, 2238, 2392,
    2457, 2555, 2605,
    2589, 2538, 2490, 2495, 2463, 2381, 2321, 2250, 2248, 2213, 2158, 2122,
    2004, 1999, 2027,
    2018, 2003, 1878, 1818, 1810, 1701, 1569, 1455, 1333, 1278, 1212, 1276,
    1526, 1867, 2268,
    2544,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (petunia)
    1890, 1097, 855, 899, 987, 881, 807, 804, 787, 691, 643, 549, 465, 404,
    385,
    302, 244, 195, 165, 159, 123, 129, 108, 111, 114, 126, 126, 134, 162, 170,
    213, 248, 279, 351, 412, 566, 752, 909, 1069, 1270, 1526, 1707, 1858,
    1999, 2112,
    2293, 2422, 2471, 2611, 2718, 2710, 2778, 2807, 2825, 2856, 2909, 2901,
    2974, 3042, 3044,
    3075,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (pietaryrtti)
    0, 0, 45, 333, 296, 196, 167, 238, 324, 289, 298, 305, 332, 352, 360,
    359, 378, 388, 466, 523, 561, 697, 854, 966, 1062, 1168, 1272, 1310, 1317,
    1356,
    1345, 1352, 1352, 1350, 1329, 1364, 1353, 1307, 1287, 1314, 1290, 1285,
    1213, 1195, 1230,
    1243, 1226, 1205, 1151, 1135, 1102, 1042, 962, 875, 815, 816, 886, 964,
    1143, 1322,
    1390,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (peltosaunio)
    4095, 3583, 3555, 3662, 3626, 3703, 3298, 3340, 3514, 3484, 3456, 3448,
    3501, 3489, 3548,
    3510, 3500, 3553, 3568, 3635, 3585, 3671, 3640, 3678, 3717, 3640, 3689,
    3676, 3754, 3754,
    3727, 3699, 3711, 3727, 3718, 3757, 3776, 3702, 3721, 3711, 3747, 3752,
    3691, 3645, 3781,
    3770, 3750, 3693, 3697, 3779, 3693, 3664, 3671, 3663, 3641, 3730, 3684,
    3681, 3665, 3737,
    3733,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (peltosaunio)
    1732, 731, 360, 266, 419, 163, 187, 91, 185, 113, 121, 118, 134, 147, 146,
    172, 154, 173, 195, 222, 260, 347, 506, 662, 849, 1032, 1253, 1328, 1426,
    1508,
    1541, 1593, 1574, 1604, 1645, 1607, 1629, 1620, 1643, 1623, 1653, 1611,
    1537, 1549, 1568,
    1577, 1601, 1530, 1520, 1522, 1454, 1404, 1306, 1233, 1162, 1186, 1208,
    1346, 1492, 1684,
    1808,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (poimulehti)
    1102, 146, 630, 266, 247, 261, 285, 238, 273, 281, 272, 260, 262, 254,
    274,
    263, 273, 278, 296, 309, 322, 388, 493, 607, 712, 840, 953, 986, 1006,
    1034,
    999, 981, 918, 855, 794, 711, 649, 627, 604, 563, 531, 515, 467, 450, 448,
    466, 445, 421, 402, 385, 369, 345, 346, 319, 330, 359, 378, 439, 578, 835,
    1177,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (poimulehti)
    1260, 292, 315, 433, 222, 359, 285, 273, 257, 277, 259, 258, 287, 268,
    292,
    267, 273, 264, 271, 273, 260, 280, 287, 282, 285, 278, 284, 286, 283, 291,
    289, 298, 315, 328, 326, 378, 401, 442, 521, 590, 729, 839, 990, 1080,
    1171,
    1338, 1481, 1601, 1791, 1976, 2015, 2125, 2213, 2322, 2379, 2473, 2476,
    2545, 2597, 2630,
    2612,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (harakankello)
    2520, 1462, 1890, 1898, 1751, 1713, 1555, 1516, 1471, 1403, 1282, 1209,
    1144, 1135, 1069,
    976, 895, 823, 782, 762, 713, 685, 661, 635, 603, 559, 551, 550, 541, 567,
    562, 574, 580, 589, 586, 620, 670, 690, 718, 801, 786, 769, 773, 739, 800,
    806, 837, 845, 971, 1043, 1102, 1241, 1359, 1502, 1611, 1726, 1793, 1859,
    1909, 1969,
    2014,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (siankaersaemoe)
    2520, 2194, 2295, 2330, 2072, 2235, 2126, 2215, 2217, 2258, 2180, 2217,
    2228, 2259, 2237,
    2234, 2288, 2324, 2394, 2417, 2383, 2472, 2527, 2574, 2653, 2640, 2668,
    2676, 2710, 2737,
    2708, 2703, 2711, 2696, 2699, 2731, 2740, 2703, 2682, 2724, 2707, 2676,
    2669, 2618, 2731,
    2713, 2739, 2652, 2635, 2662, 2625, 2595, 2579, 2543, 2525, 2593, 2544,
    2588, 2616, 2675,
    2791,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (niittyhumala)
    0, 658, 675, 732, 617, 653, 551, 622, 586, 575, 528, 512, 448, 444, 404,
    372, 300, 276, 253, 234, 216, 198, 185, 173, 155, 146, 149, 145, 138, 142,
    138, 145, 149, 143, 150, 157, 167, 180, 193, 235, 261, 256, 284, 276, 294,
    321, 337, 375, 440, 504, 557, 633, 722, 851, 912, 982, 1055, 1115, 1143,
    1218,
    1267,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (niittyhumala)
    1417, 292, 495, 333, 345, 294, 285, 287, 247, 265, 289, 291, 280, 273,
    290,
    296, 302, 299, 340, 365, 393, 455, 580, 713, 860, 1026, 1161, 1235, 1277,
    1349,
    1328, 1302, 1241, 1221, 1139, 1077, 1012, 981, 961, 931, 882, 823, 783,
    750, 759,
    750, 723, 664, 595, 553, 516, 488, 457, 382, 375, 414, 455, 571, 794,
    1193,
    1633,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (paju)
    1102, 804, 765, 633, 740, 832, 660, 650, 674, 647, 620, 602, 609, 615,
    627,
    604, 601, 617, 599, 627, 614, 645, 694, 741, 781, 891, 935, 944, 947, 956,
    955, 931, 902, 857, 821, 781, 747, 726, 714, 698, 686, 677, 657, 639, 671,
    672, 673, 629, 607, 629, 600, 611, 627, 606, 625, 643, 671, 723, 752, 908,
    1162,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (hopeapaju)
    787, 512, 1260, 1032, 765, 881, 994, 908, 983, 985, 941, 985, 971, 967,
    964,
    937, 928, 959, 973, 992, 1004, 1017, 1053, 1102, 1180, 1227, 1281, 1309,
    1317, 1328,
    1318, 1271, 1238, 1222, 1179, 1152, 1131, 1092, 1086, 1078, 1083, 1020,
    1015, 1000, 1027,
    1037, 1028, 970, 962, 977, 952, 963, 955, 935, 980, 979, 963, 1028, 1059,
    1228,
    1401,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (maitohorsma)
    1732, 585, 585, 599, 518, 375, 335, 370, 381, 362, 344, 322, 305, 314,
    292,
    265, 238, 215, 189, 177, 170, 150, 146, 132, 126, 113, 109, 108, 97, 98,
    96, 103, 97, 107, 107, 129, 149, 165, 203, 262, 366, 470, 569, 641, 708,
    804, 904, 1008, 1082, 1170, 1194, 1199, 1261, 1212, 1231, 1223, 1285,
    1362, 1534, 1691,
    1760,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (maitohorsma)
    1417, 366, 675, 499, 296, 326, 266, 280, 257, 269, 259, 260, 257, 259,
    267,
    256, 244, 262, 245, 261, 264, 297, 329, 384, 457, 520, 599, 607, 617, 643,
    615, 590, 546, 523, 486, 443, 417, 392, 370, 371, 356, 328, 316, 321, 322,
    317, 323, 300, 291, 292, 283, 276, 278, 282, 289, 304, 310, 340, 397, 588,
    818,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (lehmus)
    2362, 1024, 945, 666, 617, 604, 591, 580, 648, 631, 656, 607, 616, 653,
    643,
    626, 643, 656, 710, 753, 801, 929, 1105, 1277, 1437, 1601, 1742, 1774,
    1798, 1848,
    1832, 1820, 1787, 1730, 1663, 1593, 1541, 1461, 1446, 1419, 1335, 1298,
    1247, 1192, 1197,
    1199, 1156, 1072, 1007, 942, 899, 832, 824, 793, 755, 801, 860, 1031,
    1305, 1809,
    2260,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green flower (lehmus=linden) 
    2677, 1682, 1170, 1032, 1085, 816, 728, 755, 833, 832, 813, 845, 857, 884,
    855,
    882, 914, 997, 1084, 1179, 1231, 1437, 1661, 1873, 2048, 2209, 2378, 2408,
    2442, 2509,
    2503, 2452, 2457, 2418, 2383, 2348, 2277, 2213, 2221, 2169, 2146, 2048,
    1977, 1960, 2000,
    1993, 1961, 1899, 1784, 1748, 1625, 1517, 1389, 1260, 1165, 1143, 1244,
    1522, 1870, 2324,
    2586,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow petal (lehmus)
    1890, 1097, 900, 832, 814, 799, 758, 853, 803, 808, 833, 862, 916, 943,
    960,
    969, 1039, 1162, 1283, 1370, 1427, 1529, 1689, 1781, 1894, 1950, 2105,
    2118, 2140, 2185,
    2191, 2199, 2234, 2266, 2263, 2297, 2328, 2312, 2298, 2332, 2344, 2312,
    2288, 2347, 2384,
    2390, 2358, 2280, 2306, 2315, 2310, 2253, 2274, 2271, 2242, 2292, 2254,
    2208, 2319, 2314,
    2264,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (pihlaja)
    315, 585, 270, 400, 345, 326, 315, 280, 304, 285, 266, 269, 260, 273, 255,
    276, 265, 258, 283, 275, 306, 309, 357, 432, 489, 573, 616, 626, 641, 667,
    658, 632, 605, 575, 527, 470, 446, 440, 420, 404, 389, 381, 355, 348, 355,
    338, 337, 323, 324, 313, 314, 288, 291, 287, 311, 330, 340, 374, 475, 637,
    949,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange berry (pihlaja)
    945, 731, 585, 433, 247, 408, 266, 314, 293, 305, 289, 288, 280, 297, 262,
    298, 277, 274, 291, 293, 285, 303, 300, 310, 324, 336, 364, 377, 426, 465,
    499, 561, 602, 667, 741, 890, 1028, 1164, 1275, 1465, 1602, 1640, 1695,
    1744, 1812,
    1837, 1859, 1805, 1791, 1822, 1796, 1751, 1715, 1655, 1575, 1600, 1560,
    1618, 1666, 1740,
    1838,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (kehaekukka)
    1325, 1266, 1098, 557, 814, 672, 632, 644, 624, 597, 554, 600, 592, 590,
    574,
    583, 597, 616, 645, 672, 721, 814, 942, 1061, 1200, 1311, 1454, 1488,
    1520, 1506,
    1507, 1451, 1404, 1331, 1246, 1204, 1114, 1060, 1076, 1027, 1009, 944,
    893, 906, 867,
    859, 860, 832, 788, 721, 719, 707, 666, 629, 641, 654, 697, 801, 1005,
    1287,
    1661,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange flower (kehaekukka)
    0, 0, 0, 0, 0, 0, 102, 58, 128, 125, 137, 122, 122, 134, 123,
    136, 159, 138, 163, 151, 167, 178, 192, 177, 206, 226, 315, 451, 707,
    1045,
    1446, 1707, 1944, 2131, 2276, 2524, 2719, 2841, 2968, 3052, 3199, 3264,
    3282, 3429, 3451,
    3454, 3477, 3556, 3478, 3565, 3595, 3569, 3582, 3582, 3559, 3610, 3626,
    3668, 3733, 3692,
    3722,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown rod (uuden guinean liisa)
    361, 372, 338, 167, 339, 260, 306, 304, 302, 327, 310, 307, 303, 290, 302,
    298, 298, 298, 287, 286, 276, 296, 278, 282, 296, 309, 295, 290, 299, 293,
    302, 288, 301, 302, 291, 306, 312, 324, 350, 362, 406, 416, 449, 482, 498,
    484, 494, 495, 471, 452, 443, 451, 426, 416, 391, 423, 462, 538, 665, 825,
    916,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (uuden guinean liisa)
    1204, 1042, 633, 390, 588, 443, 469, 369, 420, 403, 367, 418, 390, 389,
    398,
    374, 383, 380, 370, 375, 388, 401, 425, 465, 528, 591, 631, 656, 664, 673,
    649, 651, 601, 573, 510, 497, 467, 441, 449, 409, 401, 394, 385, 388, 368,
    371, 372, 352, 347, 358, 337, 339, 344, 358, 346, 355, 397, 417, 504, 636,
    916,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (uuden guinean liisa)
    2288, 1861, 2364, 2229, 2783, 2842, 2842, 2923, 2902, 2990, 2828, 2871,
    2772, 2723, 2639,
    2558, 2424, 2315, 2169, 2094, 2064, 1964, 1865, 1739, 1680, 1624, 1548,
    1457, 1424, 1408,
    1434, 1451, 1492, 1528, 1597, 1755, 1951, 2147, 2367, 2648, 2986, 3236,
    3393, 3596, 3665,
    3786, 3879, 3915, 3926, 3994, 3987, 4017, 4026, 4112, 4067, 4125, 4139,
    4121, 4050, 4040,
    4095,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (orvokki)
    1084, 1191, 1055, 1142, 1222, 1390, 1477, 1534, 1520, 1533, 1524, 1470,
    1413, 1363, 1262,
    1203, 1084, 945, 870, 813, 776, 719, 650, 584, 549, 482, 425, 412, 408,
    401,
    404, 387, 402, 407, 400, 426, 456, 487, 510, 574, 638, 683, 716, 757, 794,
    829, 856, 925, 1051, 1147, 1233, 1393, 1591, 1759, 1892, 2015, 2165, 2369,
    2526, 2634,
    2747,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (orvokki)
    0, 0, 296, 418, 294, 336, 336, 412, 404, 412, 420, 429, 436, 444, 444,
    445, 455, 449, 432, 460, 479, 506, 568, 640, 732, 859, 924, 949, 958, 972,
    968, 906, 875, 828, 770, 725, 676, 632, 638, 614, 601, 559, 527, 543, 522,
    526, 523, 515, 487, 483, 477, 466, 489, 466, 485, 533, 565, 607, 731, 958,
    1245,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (akilleija)
    843, 1340, 1393, 1254, 1290, 1452, 1508, 1519, 1454, 1384, 1301, 1256,
    1178, 1113, 1056,
    985, 884, 827, 743, 720, 691, 664, 605, 578, 540, 507, 499, 475, 485, 494,
    492, 479, 487, 493, 471, 495, 559, 595, 645, 689, 720, 732, 716, 723, 734,
    750, 804, 849, 948, 1041, 1169, 1362, 1525, 1693, 1761, 1935, 2071, 2235,
    2376, 2493,
    2604,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (akilleija)
    1204, 670, 844, 474, 407, 504, 418, 441, 471, 460, 447, 432, 436, 444,
    444,
    463, 455, 455, 484, 500, 518, 565, 664, 744, 833, 951, 1012, 1022, 1005,
    1021,
    1016, 983, 970, 900, 845, 796, 752, 718, 701, 674, 655, 652, 604, 615,
    595,
    594, 590, 563, 516, 518, 492, 477, 481, 474, 493, 497, 562, 666, 779,
    1021,
    1332,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (suikeroalpi)
    2048, 1666, 1140, 1210, 699, 680, 615, 566, 567, 561, 609, 585, 614, 572,
    599,
    575, 636, 730, 982, 1194, 1360, 1766, 2222, 2558, 2849, 3048, 3201, 3395,
    3395, 3484,
    3576, 3623, 3606, 3672, 3651, 3634, 3647, 3669, 3715, 3660, 3720, 3692,
    3704, 3784, 3683,
    3731, 3681, 3697, 3635, 3694, 3617, 3610, 3632, 3663, 3616, 3595, 3599,
    3584, 3588, 3613,
    3527,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (suikeroalpi)
    431, 694, 802, 341, 400, 453, 490, 439, 440, 439, 447, 401, 426, 435, 453,
    444, 434, 440, 457, 518, 548, 635, 815, 975, 1125, 1261, 1396, 1501, 1505,
    1522,
    1529, 1429, 1390, 1316, 1248, 1159, 1081, 1016, 1002, 960, 929, 847, 814,
    820, 763,
    786, 750, 696, 663, 615, 594, 558, 511, 498, 474, 491, 561, 680, 939,
    1315,
    1719,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (kissankello)
    1792, 1694, 1684, 2014, 1702, 1647, 1621, 1616, 1539, 1527, 1469, 1425,
    1370, 1317, 1282,
    1222, 1126, 1053, 1024, 984, 998, 966, 899, 875, 871, 827, 823, 800, 809,
    843,
    812, 778, 785, 805, 775, 765, 791, 814, 855, 887, 911, 916, 894, 910, 900,
    911, 940, 984, 1103, 1183, 1296, 1433, 1602, 1704, 1865, 1972, 2014, 2031,
    2118, 2126,
    2112,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry flower (kissankello)
    1536, 0, 421, 297, 276, 416, 400, 439, 426, 417, 437, 465, 458, 474, 496,
    502, 518, 533, 580, 561, 580, 619, 632, 653, 670, 698, 729, 744, 757, 804,
    841, 848, 864, 886, 883, 910, 960, 980, 995, 1015, 1055, 1110, 1139, 1162,
    1158,
    1194, 1223, 1264, 1279, 1287, 1321, 1379, 1420, 1417, 1469, 1489, 1510,
    1539, 1549, 1566,
    1559,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//light red flower (lupiini)
    1792, 1553, 1684, 1882, 1909, 1847, 2053, 2084, 2045, 2052, 2039, 2084,
    2041, 2044, 2007,
    1984, 1906, 1876, 1886, 1855, 1859, 1875, 1816, 1800, 1811, 1780, 1802,
    1816, 1838, 1915,
    1973, 2018, 2083, 2114, 2133, 2226, 2304, 2385, 2458, 2494, 2571, 2689,
    2738, 2774, 2734,
    2759, 2781, 2831, 2844, 2857, 2878, 2876, 2884, 2920, 2932, 2860, 2894,
    2934, 2925, 2928,
    2921,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry flower (lupiini)
    256, 424, 574, 594, 552, 508, 579, 570, 556, 574, 564, 588, 614, 594, 628,
    620, 625, 640, 666, 691, 672, 701, 730, 728, 761, 758, 792, 832, 834, 868,
    880, 897, 900, 911, 919, 946, 955, 957, 987, 994, 1020, 1047, 1074, 1102,
    1085,
    1122, 1135, 1126, 1158, 1178, 1178, 1204, 1253, 1246, 1293, 1291, 1322,
    1356, 1397, 1438,
    1381,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (lupiini)
    1920, 1483, 1339, 1321, 1426, 1447, 1326, 1324, 1238, 1313, 1243, 1188,
    1164, 1123, 1094,
    1050, 946, 890, 839, 780, 765, 701, 628, 561, 538, 479, 451, 415, 399,
    406,
    392, 399, 385, 391, 413, 436, 449, 483, 547, 599, 674, 754, 812, 843, 847,
    883, 922, 949, 1012, 1069, 1090, 1149, 1248, 1285, 1325, 1309, 1387, 1435,
    1459, 1475,
    1517,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (lupiini)
    640, 424, 383, 561, 483, 431, 516, 439, 361, 392, 359, 357, 321, 319, 313,
    287, 256, 233, 218, 209, 195, 186, 169, 147, 141, 140, 129, 126, 123, 124,
    128, 130, 125, 127, 132, 126, 128, 140, 153, 164, 191, 197, 213, 226, 234,
    241, 272, 294, 334, 354, 396, 446, 489, 574, 633, 678, 744, 779, 835, 853,
    883,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (kurkkuyrtti)
    2687, 1553, 2181, 2246, 2209, 2263, 2442, 2347, 2261, 2353, 2292, 2230,
    2095, 2008, 1896,
    1782, 1569, 1443, 1333, 1223, 1177, 1074, 992, 902, 813, 755, 701, 626,
    577, 548,
    525, 498, 469, 445, 456, 448, 428, 441, 448, 447, 455, 467, 496, 534, 527,
    586, 668, 798, 966, 1126, 1289, 1469, 1679, 1870, 2013, 2040, 2060, 2077,
    2104, 2155,
    2119,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (kurkkuyrtti)
    896, 918, 651, 561, 529, 523, 484, 453, 491, 512, 505, 515, 494, 519, 510,
    510, 516, 522, 522, 543, 537, 605, 696, 755, 830, 898, 951, 978, 966, 976,
    981, 959, 922, 876, 840, 802, 751, 725, 714, 693, 670, 670, 649, 637, 608,
    614, 620, 600, 571, 565, 561, 541, 516, 527, 547, 554, 596, 678, 735, 897,
    1132,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (hevosminttu)
    1280, 706, 612, 462, 391, 339, 253, 285, 261, 264, 239, 208, 201, 186,
    185,
    161, 156, 149, 146, 148, 161, 144, 143, 151, 147, 146, 139, 148, 173, 185,
    185, 197, 222, 238, 283, 322, 384, 439, 519, 633, 792, 922, 1061, 1186,
    1235,
    1342, 1538, 1691, 1839, 1974, 2024, 2098, 2128, 2187, 2204, 2217, 2267,
    2299, 2339, 2331,
    2322,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (hevosminttu)
    0, 282, 191, 396, 230, 262, 232, 271, 251, 260, 270, 275, 270, 254, 250,
    237, 234, 239, 232, 235, 239, 218, 245, 235, 244, 238, 240, 249, 240, 254,
    276, 294, 281, 294, 311, 333, 363, 388, 424, 455, 510, 536, 547, 579, 582,
    598, 607, 592, 590, 568, 551, 513, 497, 452, 468, 475, 540, 665, 845,
    1123,
    1439,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green rod (hevosminttu)
    896, 706, 383, 627, 598, 431, 526, 563, 581, 594, 632, 621, 599, 623, 637,
    627, 659, 681, 747, 798, 833, 928, 1022, 1128, 1169, 1231, 1298, 1323,
    1358, 1406,
    1359, 1401, 1416, 1401, 1384, 1343, 1362, 1369, 1371, 1349, 1372, 1341,
    1337, 1349, 1307,
    1338, 1306, 1266, 1202, 1121, 1129, 1082, 1020, 954, 891, 884, 973, 1141,
    1411, 1632,
    1801,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (nukkajaekkaerae)
    256, 353, 498, 561, 322, 477, 421, 453, 446, 462, 464, 483, 460, 469, 466,
    493, 475, 497, 518, 549, 555, 603, 700, 798, 894, 1004, 1113, 1155, 1173,
    1182,
    1156, 1135, 1095, 1048, 974, 938, 877, 833, 824, 792, 771, 737, 712, 706,
    679,
    691, 680, 662, 634, 622, 607, 577, 555, 571, 567, 554, 618, 665, 831,
    1069,
    1334,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green rod (nukkajaekkaerae)
    1408, 1483, 1148, 1057, 920, 908, 1032, 1031, 997, 1102, 1151, 1206, 1206,
    1249, 1231,
    1252, 1264, 1284, 1335, 1373, 1403, 1442, 1527, 1540, 1550, 1627, 1687,
    1669, 1684, 1732,
    1706, 1711, 1743, 1718, 1703, 1711, 1697, 1671, 1697, 1676, 1695, 1690,
    1675, 1707, 1677,
    1693, 1670, 1650, 1604, 1625, 1631, 1569, 1562, 1519, 1524, 1453, 1550,
    1624, 1718, 1841,
    1886,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (nukkajaekkaerae)
    1920, 1059, 651, 892, 966, 1078, 1295, 1433, 1519, 1635, 1663, 1706, 1753,
    1756, 1796,
    1784, 1825, 1792, 1831, 1863, 1886, 1901, 1903, 1895, 1914, 1952, 1979,
    1949, 1959, 2016,
    2027, 2018, 1998, 2005, 1976, 1982, 1970, 1949, 1923, 1956, 1964, 1938,
    1948, 1975, 1909,
    1942, 1877, 1873, 1899, 1872, 1881, 1886, 1882, 1867, 1831, 1837, 1865,
    1865, 1915, 1925,
    1941,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (maksaruoho) 
    0, 0, 372, 278, 268, 535, 492, 454, 567, 570, 571, 569, 612, 602, 585,
    580, 604, 616, 623, 638, 674, 779, 895, 1008, 1090, 1170, 1203, 1150,
    1141, 1152,
    1144, 1099, 1038, 1013, 947, 891, 825, 799, 774, 750, 694, 663, 647, 620,
    604,
    577, 556, 526, 494, 447, 397, 385, 341, 343, 321, 325, 365, 475, 614, 810,
    1087,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green rod (maksaruoho)
    1157, 1365, 1024, 972, 883, 996, 1018, 972, 1004, 1016, 1036, 1067, 1039,
    1052, 1040,
    1060, 1054, 1122, 1206, 1285, 1372, 1459, 1616, 1721, 1793, 1853, 1894,
    1894, 1884, 1897,
    1925, 1884, 1882, 1833, 1834, 1823, 1795, 1772, 1729, 1740, 1711, 1658,
    1687, 1659, 1647,
    1598, 1599, 1637, 1543, 1478, 1418, 1397, 1324, 1244, 1179, 1207, 1290,
    1503, 1687, 1911,
    2022,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white rod, inner part (maksaruoho)
    0, 427, 651, 937, 937, 941, 961, 1044, 1144, 1163, 1202, 1255, 1256, 1253,
    1247,
    1270, 1298, 1323, 1338, 1418, 1454, 1483, 1498, 1561, 1573, 1619, 1624,
    1618, 1639, 1659,
    1664, 1671, 1681, 1661, 1690, 1700, 1719, 1712, 1725, 1710, 1717, 1707,
    1773, 1755, 1713,
    1695, 1729, 1699, 1676, 1681, 1644, 1656, 1643, 1617, 1584, 1606, 1635,
    1722, 1790, 1853,
    1871,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (ukonhattu)
    801, 682, 1070, 1319, 1311, 1420, 1453, 1394, 1318, 1292, 1268, 1179,
    1132, 1054, 1015,
    948, 846, 780, 731, 709, 705, 667, 621, 598, 555, 522, 505, 493, 498, 500,
    494, 471, 479, 463, 450, 461, 487, 515, 546, 574, 555, 562, 539, 558, 546,
    552, 567, 626, 715, 807, 862, 978, 1086, 1199, 1313, 1323, 1350, 1366,
    1358, 1320,
    1365,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (ukonhattu)
    0, 512, 605, 694, 696, 701, 641, 693, 690, 619, 634, 670, 666, 670, 647,
    639, 644, 639, 649, 676, 692, 710, 741, 824, 876, 973, 1032, 1074, 1064,
    1081,
    1042, 1027, 987, 938, 910, 856, 815, 815, 802, 775, 761, 722, 744, 721,
    680,
    694, 705, 681, 675, 674, 657, 658, 659, 668, 691, 744, 729, 761, 792, 954,
    1222,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yelllow flower (pietaryrtti)
    178, 0, 0, 174, 268, 203, 217, 207, 224, 201, 162, 200, 183, 194, 192,
    200, 199, 220, 255, 276, 329, 417, 552, 749, 912, 1116, 1289, 1418, 1527,
    1642,
    1681, 1710, 1779, 1796, 1813, 1867, 1878, 1907, 1944, 1938, 1887, 1901,
    1921, 1897, 1888,
    1885, 1845, 1897, 1829, 1812, 1770, 1759, 1688, 1584, 1565, 1532, 1552,
    1634, 1831, 1977,
    2178,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (sinisievikki)
    801, 1109, 1861, 2325, 2329, 2380, 2562, 2565, 2558, 2611, 2517, 2567,
    2475, 2397, 2337,
    2294, 2195, 2001, 1881, 1892, 1854, 1746, 1668, 1580, 1491, 1362, 1229,
    1178, 1110, 1094,
    1072, 1019, 994, 960, 928, 879, 836, 859, 863, 951, 1046, 1102, 1154,
    1193, 1174,
    1166, 1153, 1199, 1275, 1316, 1376, 1550, 1739, 1918, 2104, 2228, 2364,
    2377, 2423, 2394,
    2334,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (sinisievikki)
    1068, 1877, 1163, 1388, 1740, 1900, 1910, 2103, 2165, 2237, 2215, 2281,
    2269, 2208, 2190,
    2184, 2099, 2103, 2024, 2070, 2040, 2008, 1931, 1904, 1886, 1863, 1816,
    1773, 1753, 1738,
    1691, 1686, 1687, 1667, 1640, 1642, 1619, 1594, 1614, 1598, 1599, 1589,
    1623, 1605, 1643,
    1587, 1619, 1658, 1654, 1666, 1694, 1737, 1719, 1792, 1795, 1829, 1854,
    1859, 1835, 1837,
    1828,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (pensashanhikki)
    356, 1365, 1024, 902, 535, 387, 355, 247, 365, 307, 321, 330, 319, 332,
    317,
    336, 408, 487, 709, 963, 1235, 1631, 2111, 2436, 2718, 2950, 3151, 3262,
    3313, 3420,
    3448, 3475, 3491, 3534, 3520, 3565, 3622, 3631, 3626, 3657, 3640, 3607,
    3641, 3627, 3601,
    3591, 3588, 3667, 3618, 3601, 3630, 3613, 3592, 3609, 3569, 3590, 3568,
    3563, 3588, 3480,
    3471,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow sepal (pensashanhikki)
    1068, 427, 326, 416, 428, 590, 503, 470, 539, 526, 546, 540, 539, 526,
    497,
    546, 555, 603, 753, 903, 1010, 1268, 1563, 1868, 2068, 2226, 2429, 2495,
    2560, 2625,
    2636, 2610, 2655, 2667, 2635, 2630, 2612, 2560, 2597, 2588, 2543, 2478,
    2499, 2472, 2438,
    2431, 2379, 2406, 2361, 2319, 2264, 2174, 2128, 2010, 1942, 1912, 1930,
    2148, 2334, 2585,
    2764,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (iisoppi)
    623, 85, 605, 833, 776, 756, 755, 781, 774, 775, 697, 724, 697, 654, 617,
    575, 536, 494, 460, 469, 442, 436, 400, 393, 380, 358, 369, 352, 342, 368,
    357, 360, 342, 342, 341, 335, 355, 353, 365, 376, 382, 392, 412, 412, 407,
    414, 420, 449, 487, 504, 517, 571, 651, 734, 806, 885, 968, 1088, 1210,
    1296,
    1411,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (kurttulehtiruusu)
    979, 1536, 745, 1145, 937, 996, 972, 924, 875, 878, 826, 766, 658, 599,
    545,
    509, 443, 381, 356, 327, 318, 304, 295, 288, 285, 271, 281, 282, 278, 280,
    296, 309, 324, 342, 343, 376, 419, 464, 520, 634, 747, 905, 1093, 1167,
    1264,
    1439, 1650, 1928, 2183, 2380, 2537, 2754, 2893, 3009, 3115, 3213, 3173,
    3222, 3237, 3192,
    3210,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (pajuangervo)
    356, 427, 419, 347, 375, 332, 320, 366, 320, 370, 376, 372, 364, 361, 355,
    349, 361, 369, 378, 391, 415, 441, 531, 596, 699, 814, 874, 916, 942, 956,
    942, 892, 900, 836, 782, 722, 683, 653, 633, 620, 571, 560, 515, 502, 502,
    492, 468, 487, 439, 422, 431, 407, 381, 412, 420, 409, 474, 525, 644, 888,
    1230,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (pajuangervo)
    445, 1024, 605, 833, 937, 959, 1052, 1028, 1049, 1029, 1017, 975, 948,
    882, 865,
    812, 757, 718, 658, 638, 628, 597, 554, 523, 509, 509, 485, 475, 469, 492,
    479, 477, 490, 525, 555, 597, 641, 704, 756, 846, 948, 1055, 1164, 1221,
    1266,
    1339, 1393, 1491, 1553, 1604, 1608, 1650, 1643, 1652, 1655, 1658, 1651,
    1739, 1813, 1818,
    1938,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (dalia)
    2288, 531, 866, 1048, 1103, 1028, 1097, 1122, 1313, 1489, 1560, 1738,
    1945, 2049, 2217,
    2370, 2522, 2698, 2738, 2836, 2884, 2963, 2921, 2971, 2983, 2901, 2973,
    3011, 3012, 2966,
    2974, 3038, 3062, 3028, 3049, 3170, 3199, 3242, 3323, 3351, 3371, 3468,
    3453, 3521, 3464,
    3463, 3493, 3466, 3458, 3449, 3446, 3468, 3514, 3493, 3468, 3426, 3391,
    3476, 3426, 3403,
    3415,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (dalia)
    120, 152, 512, 571, 589, 506, 565, 505, 486, 488, 441, 500, 489, 459, 470,
    477, 450, 471, 453, 460, 449, 460, 466, 452, 464, 462, 456, 448, 436, 435,
    438, 444, 452, 416, 428, 434, 440, 468, 476, 529, 591, 693, 808, 933, 989,
    1095, 1300, 1432, 1624, 1780, 1928, 2105, 2276, 2455, 2540, 2652, 2695,
    2825, 2841, 2933,
    2896,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (jaloangervo)
    120, 152, 512, 635, 662, 538, 749, 713, 743, 792, 777, 785, 733, 726, 728,
    749, 709, 674, 661, 657, 645, 635, 598, 570, 553, 544, 545, 538, 546, 514,
    540, 567, 585, 577, 602, 651, 690, 765, 836, 907, 980, 1089, 1147, 1188,
    1212,
    1253, 1318, 1371, 1412, 1473, 1459, 1478, 1548, 1582, 1564, 1590, 1595,
    1714, 1728, 1814,
    1837,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (neilikka)
    0, 0, 394, 0, 245, 95, 174, 149, 194, 171, 181, 175, 172, 167, 147,
    137, 107, 108, 100, 87, 93, 87, 83, 77, 80, 67, 72, 64, 83, 84,
    88, 90, 91, 94, 114, 133, 178, 241, 309, 419, 612, 823, 992, 1153, 1222,
    1366, 1503, 1658, 1767, 1841, 1884, 1992, 2035, 2007, 2009, 2045, 2065,
    2229, 2290, 2395,
    2449,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red petal (pelargonia)
    2529, 2048, 2087, 2698, 2452, 2372, 2531, 2475, 2296, 2294, 2159, 2111,
    1986, 1898, 1854,
    1729, 1586, 1501, 1392, 1332, 1343, 1255, 1217, 1182, 1183, 1203, 1230,
    1277, 1381, 1474,
    1615, 1762, 1876, 2028, 2214, 2464, 2657, 2919, 3051, 3172, 3293, 3421,
    3395, 3494, 3438,
    3495, 3506, 3490, 3454, 3487, 3431, 3452, 3484, 3438, 3422, 3368, 3325,
    3441, 3356, 3432,
    3320,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (pelargonia)
    3493, 2882, 2284, 2730, 2869, 2609, 2781, 2869, 2861, 2869, 2795, 2810,
    2740, 2716, 2650,
    2631, 2539, 2554, 2450, 2453, 2447, 2451, 2343, 2408, 2404, 2367, 2343,
    2401, 2474, 2549,
    2668, 2759, 2843, 2883, 2989, 3106, 3209, 3344, 3383, 3404, 3453, 3521,
    3495, 3571, 3521,
    3548, 3582, 3557, 3581, 3539, 3563, 3589, 3597, 3579, 3502, 3546, 3507,
    3554, 3490, 3561,
    3518,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white petal (paeivaenkakkara)
    2168, 1365, 1969, 2095, 2231, 2530, 2944, 3092, 3107, 3148, 3188, 3207,
    3195, 3216, 3225,
    3261, 3211, 3228, 3260, 3237, 3258, 3276, 3265, 3316, 3327, 3291, 3315,
    3324, 3355, 3255,
    3264, 3308, 3324, 3328, 3282, 3253, 3220, 3257, 3289, 3265, 3245, 3297,
    3284, 3292, 3228,
    3312, 3290, 3277, 3278, 3284, 3182, 3244, 3273, 3291, 3212, 3256, 3154,
    3243, 3306, 3234,
    3155,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (paeivaenkakkara)
    1084, 303, 394, 413, 221, 221, 152, 126, 94, 88, 103, 68, 86, 80, 67,
    97, 103, 87, 108, 120, 140, 216, 353, 499, 672, 867, 1026, 1146, 1201,
    1239,
    1278, 1331, 1355, 1334, 1314, 1306, 1286, 1293, 1289, 1276, 1231, 1219,
    1163, 1155, 1118,
    1117, 1136, 1102, 1112, 1051, 1015, 943, 868, 770, 718, 719, 722, 881,
    1026, 1251,
    1425,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (paeivaenkakkara)
    2048, 1289, 1024, 1111, 834, 648, 728, 654, 612, 605, 612, 607, 582, 570,
    568,
    589, 587, 598, 604, 590, 607, 633, 657, 726, 791, 817, 865, 859, 869, 869,
    852, 840, 819, 791, 755, 725, 701, 676, 685, 658, 644, 653, 622, 622, 619,
    628, 616, 601, 595, 582, 588, 594, 608, 599, 590, 607, 633, 674, 719, 850,
    989,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (punataehkae)
    1445, 1213, 787, 1016, 907, 1059, 1075, 1070, 999, 1017, 1033, 1001, 944,
    913, 886,
    830, 762, 719, 659, 626, 605, 573, 527, 509, 471, 426, 393, 364, 363, 365,
    369, 357, 375, 373, 352, 338, 337, 375, 436, 524, 714, 861, 992, 1086,
    1123,
    1208, 1236, 1292, 1354, 1315, 1293, 1350, 1339, 1309, 1328, 1323, 1334,
    1377, 1404, 1553,
    1677,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (talvio)
    3131, 2199, 2559, 2540, 2844, 2530, 2694, 2765, 2594, 2673, 2617, 2629,
    2491, 2384, 2308,
    2256, 2081, 1973, 1857, 1752, 1719, 1652, 1527, 1477, 1459, 1386, 1341,
    1283, 1318, 1334,
    1354, 1424, 1495, 1543, 1634, 1773, 1950, 2129, 2272, 2431, 2642, 2827,
    2941, 3045, 3082,
    3158, 3216, 3307, 3364, 3388, 3387, 3517, 3573, 3501, 3499, 3523, 3495,
    3606, 3493, 3518,
    3522,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (talvio)
    964, 379, 551, 476, 466, 443, 478, 505, 455, 475, 489, 489, 486, 500, 489,
    499, 499, 496, 528, 549, 590, 639, 726, 803, 881, 992, 1028, 1079, 1084,
    1089,
    1073, 1048, 1009, 945, 909, 859, 807, 786, 768, 759, 730, 721, 669, 662,
    644,
    645, 682, 624, 611, 566, 564, 584, 530, 508, 556, 563, 603, 693, 776, 975,
    1207,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (talvio)
    361, 379, 157, 317, 294, 269, 217, 186, 178, 204, 195, 190, 192, 192, 205,
    196, 195, 199, 194, 205, 216, 226, 278, 337, 392, 471, 526, 568, 564, 561,
    550, 529, 494, 446, 425, 372, 345, 322, 316, 298, 270, 261, 239, 241, 225,
    221, 234, 233, 224, 215, 188, 195, 206, 191, 216, 243, 261, 295, 348, 531,
    775,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (lobelia dortmanna)
    0, 660, 1277, 1544, 1612, 1961, 1909, 1950, 1901, 1907, 1809, 1785, 1685,
    1622, 1522,
    1377, 1178, 1054, 931, 898, 850, 732, 610, 508, 434, 370, 343, 329, 303,
    265,
    232, 199, 183, 169, 172, 177, 200, 233, 214, 214, 199, 186, 199, 228, 249,
    321, 435, 684, 1006, 1345, 1703, 2082, 2432, 2661, 2843, 2936, 3079, 3015,
    3003, 3045,
    3038,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (malvikki)
    1062, 528, 749, 571, 512, 538, 455, 445, 431, 384, 353, 299, 249, 212,
    190,
    162, 123, 105, 90, 81, 83, 75, 78, 72, 59, 56, 61, 54, 71, 69,
    70, 62, 63, 65, 70, 74, 78, 73, 76, 87, 90, 104, 119, 119, 131,
    145, 156, 184, 225, 255, 314, 414, 538, 669, 849, 1068, 1247, 1467, 1701,
    1885,
    2032,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (malvikki)
    1820, 859, 484, 336, 461, 382, 333, 320, 293, 320, 318, 284, 291, 296,
    293,
    293, 286, 295, 310, 309, 338, 387, 469, 538, 661, 756, 849, 867, 876, 882,
    882, 845, 778, 754, 694, 632, 568, 537, 536, 510, 482, 462, 440, 425, 417,
    415, 388, 392, 365, 348, 345, 327, 342, 367, 359, 381, 440, 511, 592, 832,
    1140,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (malvikki)
    455, 594, 308, 34, 179, 191, 277, 226, 218, 205, 198, 181, 190, 159, 173,
    150, 128, 133, 127, 102, 121, 108, 104, 96, 107, 107, 112, 107, 125, 128,
    133, 156, 173, 213, 245, 313, 392, 491, 590, 736, 925, 1085, 1254, 1370,
    1418,
    1559, 1692, 1828, 1923, 2043, 2093, 2153, 2168, 2230, 2256, 2318, 2392,
    2400, 2480, 2604,
    2663,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (malvikki)
    1365, 1519, 1321, 1275, 1049, 1076, 1043, 1037, 1049, 1007, 1018, 1003,
    1005, 959, 963,
    933, 933, 910, 889, 894, 907, 871, 866, 858, 815, 810, 822, 838, 811, 819,
    846, 852, 869, 876, 890, 933, 977, 1029, 1105, 1204, 1373, 1498, 1629,
    1788, 1831,
    1958, 2061, 2222, 2300, 2350, 2415, 2517, 2530, 2568, 2513, 2564, 2712,
    2758, 2865, 2964,
    3034,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red, pale flower (ruusu)
    1365, 1915, 1937, 1779, 1715, 2013, 2020, 2067, 1997, 2030, 1957, 1897,
    1817, 1759, 1671,
    1587, 1475, 1376, 1289, 1262, 1252, 1150, 1089, 1022, 1020, 974, 984,
    1018, 996, 1044,
    1092, 1170, 1214, 1270, 1331, 1439, 1537, 1657, 1766, 1931, 2175, 2358,
    2567, 2735, 2796,
    2926, 3004, 3194, 3274, 3333, 3426, 3435, 3484, 3508, 3564, 3577, 3567,
    3480, 3499, 3465,
    3511,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red, dark flower (ruusu)
    910, 925, 969, 738, 717, 833, 766, 819, 714, 717, 707, 604, 518, 453, 398,
    351, 271, 239, 204, 184, 177, 147, 153, 120, 130, 136, 124, 131, 154, 143,
    171, 188, 220, 246, 291, 338, 420, 491, 566, 706, 905, 1084, 1254, 1438,
    1570,
    1720, 1926, 2209, 2333, 2447, 2567, 2654, 2793, 2850, 2881, 2899, 2981,
    2885, 2921, 2887,
    2868,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green sepal (ruusu)
    2427, 1189, 1101, 806, 793, 625, 666, 710, 655, 670, 671, 667, 675, 680,
    658,
    688, 711, 731, 781, 836, 882, 977, 1132, 1228, 1341, 1434, 1518, 1561,
    1531, 1551,
    1532, 1525, 1486, 1444, 1391, 1315, 1272, 1241, 1205, 1181, 1153, 1145,
    1103, 1070, 1062,
    1052, 1039, 1040, 969, 917, 892, 879, 818, 776, 750, 742, 813, 950, 1150,
    1399,
    1657,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (ruusu)
    2730, 2312, 2906, 3021, 3097, 3071, 3163, 3260, 3115, 3169, 3116, 3204,
    3246, 3218, 3221,
    3192, 3153, 3199, 3191, 3276, 3303, 3257, 3305, 3283, 3261, 3302, 3317,
    3311, 3241, 3328,
    3333, 3347, 3385, 3382, 3396, 3409, 3421, 3408, 3404, 3389, 3453, 3491,
    3489, 3534, 3538,
    3547, 3481, 3535, 3468, 3481, 3507, 3554, 3546, 3536, 3520, 3529, 3522,
    3448, 3554, 3550,
    3503,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red flower (unikko)
    1365, 330, 176, 470, 384, 382, 377, 289, 304, 264, 265, 293, 286, 276,
    274,
    266, 280, 237, 237, 211, 213, 241, 231, 212, 225, 203, 219, 223, 218, 244,
    277, 295, 338, 387, 453, 590, 782, 1001, 1178, 1462, 1836, 2132, 2339,
    2536, 2611,
    2738, 2803, 2933, 2988, 2981, 3028, 3084, 3092, 3147, 3126, 3093, 3117,
    3051, 3072, 3012,
    2994,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green lichen (peltigeracaniina nahkajaekaelae)
    0, 315, 172, 142, 142, 48, 112, 98, 93, 82, 91, 81, 94, 92, 86,
    90, 97, 91, 99, 98, 102, 96, 102, 106, 104, 104, 117, 101, 101, 100,
    105, 92, 99, 103, 107, 112, 105, 109, 104, 105, 96, 92, 104, 98, 105,
    106, 111, 124, 119, 137, 141, 142, 127, 141, 135, 152, 135, 168, 229, 326,
    476,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown lichen (peltigeracaniina nahkajaekaelae)
    2303, 504, 345, 392, 260, 286, 274, 224, 214, 216, 205, 209, 215, 220,
    219,
    219, 232, 231, 235, 238, 240, 253, 267, 289, 268, 292, 318, 340, 343, 337,
    355, 356, 374, 357, 382, 403, 396, 392, 388, 379, 374, 373, 372, 354, 355,
    376, 392, 396, 448, 468, 463, 482, 462, 431, 399, 399, 427, 478, 616, 830,
    1084,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white lichen (peltigeracaniina)
    1792, 756, 1336, 1424, 1349, 1365, 1473, 1393, 1451, 1434, 1476, 1466,
    1483, 1461, 1473,
    1470, 1457, 1495, 1464, 1511, 1551, 1550, 1560, 1570, 1598, 1606, 1630,
    1677, 1685, 1656,
    1661, 1703, 1715, 1725, 1727, 1741, 1765, 1743, 1779, 1768, 1783, 1813,
    1797, 1787, 1801,
    1789, 1845, 1882, 1836, 1846, 1864, 1831, 1831, 1818, 1867, 1854, 1832,
    1860, 1889, 1860,
    1987,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//reddish brown leaf (haapa)
    256, 0, 43, 142, 142, 270, 193, 182, 195, 219, 222, 196, 200, 220, 210,
    198, 203, 199, 207, 197, 209, 203, 206, 214, 229, 235, 212, 225, 239, 227,
    230, 259, 273, 275, 308, 334, 401, 475, 529, 575, 623, 630, 636, 647, 639,
    652, 658, 642, 593, 551, 496, 451, 400, 363, 326, 374, 402, 534, 781,
    1167,
    1661,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (haapa)
    256, 378, 431, 285, 237, 349, 386, 301, 292, 266, 267, 288, 281, 271, 265,
    281, 271, 286, 269, 270, 287, 259, 263, 283, 287, 289, 278, 288, 296, 293,
    286, 301, 317, 323, 368, 421, 496, 582, 697, 854, 995, 1139, 1210, 1251,
    1292,
    1338, 1431, 1454, 1421, 1405, 1380, 1282, 1175, 1067, 989, 983, 1047,
    1230, 1622, 1960,
    2245,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (haapa)
    768, 189, 259, 142, 142, 175, 254, 175, 195, 184, 202, 207, 207, 194, 197,
    198, 188, 187, 201, 199, 214, 210, 206, 217, 206, 216, 216, 227, 216, 227,
    225, 251, 266, 307, 332, 411, 537, 660, 810, 1015, 1242, 1442, 1623, 1691,
    1791,
    1856, 1999, 2112, 2123, 2117, 2105, 2037, 1969, 1891, 1797, 1778, 1901,
    2133, 2434, 2657,
    2854,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (haapa)
    256, 189, 345, 463, 237, 254, 274, 252, 248, 255, 251, 246, 242, 247, 245,
    251, 248, 252, 259, 256, 266, 268, 277, 285, 289, 319, 307, 318, 333, 356,
    357, 374, 379, 379, 398, 405, 411, 415, 434, 455, 468, 474, 498, 494, 497,
    522, 551, 561, 562, 568, 562, 557, 562, 557, 581, 621, 632, 676, 693, 712,
    766,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//reddish yellow leaf (haapa)
    1024, 378, 259, 285, 189, 270, 254, 280, 243, 251, 244, 243, 254, 224,
    239,
    243, 240, 243, 251, 258, 252, 266, 313, 346, 368, 389, 393, 410, 423, 449,
    485, 512, 556, 583, 632, 712, 807, 875, 961, 1037, 1123, 1151, 1164, 1178,
    1171,
    1190, 1221, 1211, 1136, 1065, 1000, 903, 832, 712, 663, 649, 704, 930,
    1288, 1712,
    2201,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (haapa) 
    1536, 630, 388, 499, 189, 333, 285, 231, 205, 212, 235, 215, 205, 203,
    226,
    208, 215, 219, 215, 219, 226, 259, 298, 325, 397, 482, 545, 552, 558, 554,
    550, 517, 481, 460, 423, 370, 357, 329, 320, 313, 297, 282, 285, 273, 253,
    272, 270, 263, 271, 255, 254, 245, 246, 239, 252, 265, 289, 326, 387, 578,
    826,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (takiainen)
    0, 0, 129, 356, 308, 381, 396, 322, 375, 372, 375, 430, 439, 442, 433,
    460, 515, 564, 635, 699, 779, 909, 1099, 1278, 1386, 1619, 1706, 1758,
    1790, 1827,
    1831, 1864, 1853, 1846, 1808, 1765, 1722, 1654, 1653, 1650, 1633, 1572,
    1547, 1496, 1486,
    1452, 1487, 1468, 1398, 1395, 1302, 1153, 1067, 965, 889, 868, 930, 1088,
    1358, 1660,
    1975,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (takiainen)
    512, 189, 172, 320, 166, 238, 203, 210, 219, 208, 205, 229, 234, 245, 219,
    243, 257, 256, 267, 278, 289, 288, 309, 325, 338, 357, 371, 394, 398, 400,
    418, 431, 437, 453, 460, 484, 495, 504, 508, 526, 541, 562, 574, 566, 573,
    579, 594, 619, 569, 561, 564, 580, 551, 546, 531, 542, 600, 650, 735, 819,
    891,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (maitohorsma)
    1536, 630, 388, 249, 260, 238, 234, 175, 185, 212, 222, 201, 210, 203,
    201,
    196, 203, 199, 197, 191, 185, 187, 194, 187, 185, 194, 196, 189, 191, 194,
    183, 183, 198, 187, 192, 199, 197, 211, 220, 244, 288, 316, 354, 384, 420,
    463, 525, 549, 555, 546, 506, 508, 486, 459, 452, 460, 531, 781, 1048,
    1382,
    1685,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//black dry leaf (maitohorsma) 
    256, 0, 172, 356, 213, 270, 203, 203, 195, 208, 202, 201, 210, 210, 203,
    204, 209, 203, 209, 201, 205, 201, 194, 210, 206, 197, 203, 198, 207, 201,
    204, 202, 198, 200, 198, 197, 186, 203, 202, 198, 200, 208, 206, 231, 235,
    223, 244, 254, 278, 289, 297, 309, 338, 335, 338, 368, 412, 524, 686, 926,
    1185,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (piharatamo)
    768, 567, 560, 712, 402, 349, 335, 343, 316, 341, 365, 355, 331, 326, 329,
    363, 337, 335, 362, 376, 394, 448, 515, 616, 703, 841, 949, 972, 997, 998,
    970, 934, 886, 834, 778, 707, 641, 623, 596, 582, 553, 513, 489, 483, 441,
    469, 450, 450, 418, 399, 390, 361, 367, 363, 382, 420, 434, 491, 633, 863,
    1270,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (pihlaja)
    1280, 378, 0, 285, 166, 159, 224, 252, 224, 247, 248, 235, 237, 229, 234,
    234, 240, 229, 223, 225, 230, 234, 231, 237, 236, 243, 238, 230, 234, 246,
    254, 256, 268, 285, 307, 370, 422, 480, 539, 654, 816, 962, 1110, 1181,
    1265,
    1397, 1562, 1704, 1808, 1904, 1932, 2004, 2115, 2161, 2231, 2308, 2288,
    2338, 2350, 2368,
    2459,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//reddish yellow leaf (pihlaja)
    1024, 315, 388, 748, 497, 397, 417, 413, 399, 361, 404, 399, 439, 439,
    420,
    408, 439, 462, 533, 557, 598, 625, 694, 739, 739, 784, 788, 774, 781, 821,
    862, 908, 952, 977, 1075, 1196, 1326, 1406, 1523, 1648, 1773, 1911, 2023,
    2073, 2090,
    2187, 2319, 2391, 2403, 2480, 2458, 2429, 2482, 2513, 2551, 2570, 2564,
    2605, 2642, 2661,
    2721,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange berry (pihlaja)
    0, 0, 0, 0, 0, 0, 10, 28, 19, 39, 26, 31, 42, 42, 40,
    34, 43, 32, 40, 33, 41, 35, 42, 46, 51, 70, 90, 90, 119, 126,
    147, 178, 213, 264, 322, 421, 575, 676, 803, 923, 1083, 1173, 1240, 1257,
    1276,
    1346, 1352, 1405, 1384, 1393, 1320, 1320, 1329, 1264, 1277, 1288, 1273,
    1269, 1323, 1323,
    1358,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (pihlaja)
    1024, 0, 172, 178, 189, 206, 244, 245, 268, 216, 218, 226, 239, 229, 241,
    241, 232, 243, 265, 290, 299, 342, 427, 514, 591, 647, 677, 685, 724, 709,
    698, 711, 686, 665, 643, 605, 590, 556, 571, 550, 527, 491, 461, 439, 425,
    445, 431, 410, 371, 350, 332, 320, 292, 281, 294, 323, 361, 458, 633, 938,
    1338,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koivu)
    2303, 630, 647, 605, 521, 524, 437, 420, 448, 435, 433, 439, 437, 442,
    447,
    447, 460, 454, 446, 449, 447, 446, 505, 520, 606, 676, 717, 727, 742, 741,
    704, 707, 669, 655, 605, 554, 523, 528, 516, 493, 483, 483, 452, 445, 445,
    451, 469, 455, 450, 433, 428, 425, 454, 431, 449, 469, 515, 541, 591, 737,
    975,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koivu)
    2303, 945, 690, 712, 592, 492, 579, 574, 579, 592, 586, 587, 609, 601,
    582,
    567, 580, 596, 641, 634, 675, 708, 771, 847, 901, 991, 1032, 1056, 1068,
    1076,
    1037, 1065, 1029, 964, 927, 883, 858, 822, 832, 817, 792, 751, 758, 714,
    715,
    723, 739, 705, 681, 676, 672, 624, 629, 622, 611, 655, 676, 735, 820,
    1012,
    1221,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koivu)
    4095, 1071, 1466, 1496, 1113, 1000, 1006, 1001, 993, 1011, 1039, 1017,
    1061, 1027, 1075,
    1061, 1054, 1134, 1186, 1235, 1271, 1416, 1580, 1711, 1821, 2029, 2140,
    2307, 2413, 2500,
    2590, 2718, 2749, 2806, 2880, 2937, 3040, 2994, 3090, 3131, 3158, 3261,
    3256, 3171, 3174,
    3252, 3369, 3397, 3339, 3344, 3274, 3270, 3260, 3377, 3370, 3367, 3290,
    3350, 3402, 3406,
    3466,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koristepensas, tuntematon)
    390, 264, 265, 375, 325, 316, 252, 249, 230, 201, 242, 261, 243, 242, 245,
    250, 251, 259, 286, 309, 336, 423, 559, 672, 811, 936, 1022, 1089, 1114,
    1124,
    1126, 1090, 1032, 1008, 941, 867, 832, 781, 797, 746, 697, 653, 606, 599,
    577,
    584, 562, 531, 497, 451, 420, 378, 377, 339, 365, 391, 418, 581, 783,
    1213,
    1680,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koristepensas, tuntematon)
    390, 793, 682, 375, 347, 316, 445, 395, 444, 406, 421, 434, 468, 457, 465,
    447, 504, 588, 709, 830, 961, 1232, 1636, 1958, 2218, 2465, 2722, 2853,
    2854, 2915,
    2985, 3021, 3033, 3049, 2994, 3038, 3098, 3066, 3072, 3052, 3056, 3029,
    2937, 2961, 2947,
    2976, 2996, 2975, 2975, 2910, 2852, 2701, 2657, 2463, 2370, 2277, 2389,
    2581, 2776, 3086,
    3222,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koristepensas, tuntematon)
    390, 330, 531, 781, 672, 443, 697, 686, 679, 694, 716, 721, 776, 739, 749,
    760, 761, 851, 989, 1077, 1149, 1405, 1744, 1972, 2173, 2396, 2581, 2711,
    2732, 2826,
    2865, 2864, 2917, 2892, 2903, 2894, 2926, 2911, 2970, 2948, 2882, 2827,
    2792, 2782, 2734,
    2775, 2786, 2760, 2712, 2659, 2598, 2419, 2328, 2094, 1990, 1933, 2085,
    2343, 2702, 3093,
    3351,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (koristepensas, tuntematon)
    682, 396, 607, 500, 325, 300, 358, 388, 330, 323, 335, 344, 351, 341, 347,
    343, 346, 353, 392, 409, 428, 475, 533, 542, 580, 599, 612, 606, 635, 647,
    690, 783, 825, 893, 987, 1145, 1322, 1468, 1648, 1853, 2014, 2228, 2369,
    2453, 2469,
    2581, 2731, 2798, 2857, 2828, 2813, 2837, 2851, 2826, 2839, 2811, 2833,
    2866, 2889, 3024,
    3056,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koristepensas, tuntematon)
    975, 727, 493, 500, 390, 459, 407, 381, 335, 327, 388, 352, 372, 353, 368,
    383, 388, 425, 511, 558, 628, 749, 888, 1029, 1109, 1190, 1247, 1278,
    1308, 1338,
    1403, 1451, 1521, 1603, 1655, 1796, 1918, 2026, 2150, 2249, 2347, 2470,
    2569, 2602, 2627,
    2677, 2729, 2796, 2833, 2843, 2818, 2759, 2792, 2688, 2623, 2612, 2645,
    2750, 2790, 2967,
    3052,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//pink (siankaersaemoe)
    585, 859, 758, 1094, 780, 1012, 987, 1067, 1059, 1034, 1098, 1110, 1097,
    1040, 1058,
    1048, 1028, 1014, 1068, 1024, 1023, 1025, 1032, 1029, 1011, 1007, 986,
    973, 946, 906,
    949, 923, 943, 949, 956, 998, 1051, 1107, 1166, 1242, 1284, 1355, 1394,
    1438, 1451,
    1543, 1589, 1588, 1612, 1616, 1562, 1534, 1562, 1541, 1494, 1492, 1518,
    1650, 1749, 1907,
    1991,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (petunia)
    292, 66, 227, 313, 325, 332, 310, 319, 300, 268, 229, 193, 164, 137, 127,
    104, 67, 50, 49, 37, 34, 34, 44, 32, 33, 31, 38, 41, 33, 34,
    45, 44, 37, 42, 44, 49, 49, 67, 80, 89, 110, 130, 137, 145, 153,
    171, 194, 223, 275, 321, 391, 464, 580, 720, 907, 1055, 1230, 1436, 1548,
    1777,
    1933,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (petunia)
    3510, 4359, 4209, 4408, 3640, 3510, 3398, 3582, 3591, 3570, 3574, 3567,
    3557, 3572, 3562,
    3592, 3564, 3627, 3640, 3633, 3613, 3632, 3690, 3653, 3664, 3675, 3769,
    3719, 3738, 3740,
    3738, 3674, 3708, 3737, 3718, 3700, 3657, 3692, 3717, 3711, 3663, 3668,
    3609, 3675, 3677,
    3737, 3708, 3732, 3702, 3702, 3634, 3644, 3693, 3636, 3678, 3689, 3671,
    3667, 3661, 3688,
    3750,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (orvokki)
    195, 1255, 1175, 1157, 1018, 1439, 1675, 1996, 2247, 2324, 2391, 2468,
    2460, 2503, 2526,
    2509, 2487, 2537, 2535, 2499, 2478, 2511, 2552, 2486, 2461, 2413, 2425,
    2411, 2371, 2320,
    2373, 2341, 2316, 2282, 2254, 2231, 2261, 2251, 2293, 2329, 2300, 2351,
    2362, 2413, 2398,
    2384, 2439, 2464, 2495, 2517, 2512, 2518, 2578, 2609, 2601, 2615, 2625,
    2652, 2670, 2779,
    2790,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//blue flower (orvokki)
    292, 528, 645, 1000, 932, 1439, 1752, 1947, 2077, 2158, 2169, 2153, 2164,
    2132, 2091,
    1993, 1916, 1876, 1803, 1702, 1659, 1554, 1503, 1425, 1330, 1229, 1186,
    1134, 1065, 1031,
    1014, 993, 989, 980, 939, 936, 945, 995, 1055, 1104, 1180, 1247, 1284,
    1343, 1349,
    1403, 1458, 1538, 1634, 1790, 1880, 2006, 2218, 2396, 2556, 2612, 2735,
    2811, 2765, 2840,
    2877,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//violet flower (orvokki)
    195, 0, 152, 31, 22, 32, 77, 69, 45, 20, 27, 26, 13, 12, 14,
    11, 15, 23, 16, 18, 16, 12, 16, 10, 16, 15, 13, 15, 15, 16,
    14, 20, 14, 17, 15, 17, 15, 17, 17, 17, 23, 24, 29, 38, 36,
    38, 37, 43, 58, 65, 70, 86, 113, 155, 222, 285, 405, 506, 645, 817,
    1035,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (orvokki) 
    651, 1105, 569, 565, 613, 525, 427, 511, 448, 452, 438, 439, 467, 467,
    444,
    456, 487, 498, 527, 589, 615, 654, 819, 920, 1062, 1198, 1370, 1470, 1573,
    1656,
    1768, 1819, 1875, 1931, 2040, 2074, 2160, 2225, 2269, 2344, 2408, 2395,
    2467, 2526, 2519,
    2575, 2564, 2580, 2638, 2663, 2629, 2629, 2581, 2570, 2569, 2653, 2790,
    2836, 2896, 2939,
    2849,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, dead flower (orvokki)
    838, 455, 645, 593, 569, 393, 351, 442, 381, 365, 416, 404, 390, 385, 392,
    394, 402, 437, 469, 545, 570, 621, 695, 746, 771, 822, 865, 891, 903, 920,
    934, 964, 974, 986, 1005, 1015, 1050, 1072, 1094, 1118, 1167, 1200, 1242,
    1245, 1251,
    1287, 1307, 1366, 1377, 1383, 1454, 1451, 1475, 1531, 1498, 1566, 1632,
    1659, 1737, 1723,
    1767,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (orvokki) 
    1024, 1105, 872, 1101, 1401, 1661, 2095, 2569, 2774, 2936, 3107, 3079,
    3265, 3292, 3248,
    3260, 3301, 3364, 3335, 3402, 3330, 3312, 3378, 3391, 3344, 3354, 3409,
    3383, 3363, 3351,
    3404, 3414, 3400, 3365, 3403, 3343, 3361, 3346, 3347, 3401, 3360, 3335,
    3349, 3422, 3383,
    3379, 3311, 3334, 3334, 3323, 3284, 3325, 3283, 3353, 3299, 3298, 3357,
    3347, 3359, 3303,
    3277,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (orvokki)
    279, 65, 379, 282, 416, 408, 351, 407, 367, 373, 390, 399, 397, 397, 386,
    400, 414, 421, 452, 510, 547, 643, 818, 980, 1124, 1286, 1390, 1428, 1461,
    1474,
    1462, 1430, 1363, 1295, 1219, 1124, 1056, 1003, 992, 975, 924, 880, 813,
    803, 781,
    779, 760, 720, 669, 627, 603, 574, 566, 551, 548, 576, 606, 751, 991,
    1286,
    1666,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red berry (puolukka)
    279, 195, 152, 113, 175, 189, 133, 152, 195, 166, 160, 162, 166, 159, 153,
    158, 159, 152, 136, 158, 146, 154, 148, 146, 159, 147, 153, 151, 156, 148,
    156, 161, 165, 186, 184, 204, 238, 278, 330, 410, 488, 581, 674, 736, 776,
    831, 868, 920, 973, 988, 1023, 1040, 1009, 1010, 1022, 1024, 1104, 1118,
    1258, 1345,
    1358,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow petal (auringonkukka)
    838, 780, 455, 537, 416, 102, 209, 228, 224, 166, 173, 186, 176, 163, 155,
    167, 213, 255, 354, 477, 632, 896, 1272, 1581, 1841, 2122, 2392, 2530,
    2663, 2758,
    2850, 2939, 2907, 2989, 3072, 3072, 3115, 3196, 3192, 3214, 3251, 3170,
    3238, 3306, 3222,
    3224, 3175, 3205, 3160, 3182, 3190, 3152, 3076, 3112, 3068, 3040, 3057,
    3087, 3147, 3086,
    3083,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green sepal (auringonkukka)
    279, 130, 265, 311, 350, 306, 313, 276, 253, 256, 275, 253, 257, 261, 258,
    265, 253, 265, 255, 252, 246, 247, 256, 265, 275, 280, 287, 277, 286, 285,
    289, 293, 279, 278, 278, 270, 277, 276, 275, 272, 270, 273, 277, 284, 266,
    271, 257, 244, 257, 265, 265, 255, 256, 240, 248, 267, 270, 254, 267, 277,
    268,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green berry (kataja)
    558, 390, 341, 395, 153, 117, 85, 90, 95, 75, 99, 100, 125, 127, 134,
    167, 207, 235, 285, 348, 395, 504, 660, 818, 898, 1022, 1115, 1140, 1151,
    1157,
    1160, 1163, 1105, 1076, 1031, 961, 877, 869, 844, 830, 797, 741, 718, 711,
    698,
    680, 647, 612, 551, 495, 471, 451, 392, 370, 364, 384, 465, 601, 869,
    1202,
    1503,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white flower (silmaeruoho) 
    558, 1040, 1251, 1130, 964, 1239, 1261, 1250, 1244, 1189, 1256, 1261,
    1258, 1270, 1226,
    1223, 1223, 1210, 1186, 1174, 1173, 1106, 1068, 1087, 1035, 985, 967, 943,
    897, 904,
    906, 906, 867, 884, 900, 867, 927, 943, 983, 1053, 1140, 1212, 1284, 1338,
    1313,
    1364, 1391, 1437, 1506, 1590, 1616, 1701, 1813, 1919, 1922, 2002, 2034,
    2026, 2150, 2081,
    2049,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (maitohorsma)
    838, 975, 720, 508, 438, 437, 493, 456, 434, 444, 435, 458, 467, 458, 463,
    467, 487, 520, 588, 639, 712, 859, 1099, 1286, 1494, 1675, 1861, 1963,
    2070, 2129,
    2205, 2269, 2251, 2305, 2347, 2366, 2409, 2416, 2461, 2507, 2514, 2462,
    2553, 2543, 2501,
    2483, 2491, 2495, 2446, 2380, 2317, 2179, 2072, 1968, 1881, 1873, 1995,
    2232, 2540, 2760,
    2983,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (maitohorsma)
    745, 715, 379, 452, 307, 335, 265, 256, 267, 294, 259, 272, 267, 297, 286,
    290, 300, 322, 328, 337, 332, 349, 378, 402, 416, 438, 459, 483, 486, 520,
    552, 567, 579, 594, 607, 632, 654, 679, 716, 724, 770, 770, 829, 845, 854,
    863, 876, 890, 899, 916, 931, 956, 981, 993, 1005, 1021, 1089, 1140, 1186,
    1258,
    1261,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//light brown dry rod (koiranputki)
    2650, 2405, 2226, 1406, 1930, 1818, 1753, 1705, 1739, 1769, 1822, 1851,
    1870, 1959, 1912,
    1971, 2029, 2082, 2085, 2119, 2212, 2253, 2237, 2310, 2370, 2388, 2416,
    2493, 2527, 2565,
    2591, 2671, 2658, 2703, 2706, 2753, 2793, 2790, 2810, 2847, 2914, 2941,
    2980, 2932, 2966,
    3051, 3062, 3084, 3103, 3098, 3138, 3099, 3105, 3164, 3229, 3201, 3267,
    3191, 3210, 3180,
    3207,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow flower (linnunkaali) 
    1445, 520, 445, 92, 235, 265, 254, 175, 97, 121, 90, 104, 113, 119, 110,
    116, 136, 205, 370, 491, 642, 910, 1200, 1407, 1598, 1808, 1963, 2085,
    2122, 2136,
    2231, 2244, 2264, 2298, 2334, 2326, 2354, 2370, 2348, 2343, 2390, 2405,
    2402, 2385, 2388,
    2365, 2371, 2343, 2320, 2337, 2334, 2248, 2267, 2247, 2241, 2182, 2199,
    2256, 2291, 2354,
    2364,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (linnunkaali)
    602, 0, 267, 306, 339, 335, 300, 247, 292, 289, 295, 298, 292, 318, 312,
    289, 299, 307, 310, 320, 350, 375, 446, 499, 574, 634, 698, 725, 736, 754,
    736, 702, 668, 633, 590, 551, 514, 499, 467, 460, 445, 424, 415, 409, 399,
    412, 393, 380, 370, 362, 366, 343, 342, 350, 333, 350, 364, 418, 494, 670,
    914,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (poimulehti)
    843, 325, 89, 306, 365, 282, 265, 303, 282, 276, 292, 277, 276, 277, 279,
    254, 284, 283, 299, 322, 319, 349, 448, 538, 631, 731, 829, 857, 888, 888,
    868, 841, 797, 735, 675, 607, 554, 547, 522, 492, 480, 427, 419, 396, 395,
    396, 401, 371, 354, 331, 312, 303, 311, 337, 330, 336, 373, 433, 530, 780,
    1079,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (poimulehti)
    1084, 390, 178, 367, 391, 194, 346, 295, 276, 250, 288, 265, 271, 282,
    286,
    282, 304, 317, 351, 384, 428, 510, 654, 822, 958, 1133, 1203, 1296, 1330,
    1336,
    1308, 1301, 1263, 1205, 1137, 1072, 1015, 988, 945, 928, 906, 820, 772,
    751, 749,
    727, 719, 670, 629, 597, 569, 493, 470, 423, 407, 406, 500, 580, 833,
    1252,
    1667,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (poimulehti)
    0, 520, 89, 153, 365, 300, 404, 311, 303, 337, 393, 390, 405, 424, 414,
    409, 429, 475, 527, 604, 675, 832, 1058, 1236, 1396, 1560, 1697, 1790,
    1816, 1892,
    1934, 1977, 1959, 1956, 1976, 1986, 2041, 2061, 2051, 2094, 2105, 2095,
    2088, 2069, 2059,
    2084, 2084, 2042, 2038, 2003, 1932, 1860, 1674, 1525, 1404, 1373, 1498,
    1723, 2024, 2397,
    2521,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown dry leaf (poimulehti)
    964, 520, 223, 244, 261, 247, 196, 199, 200, 207, 202, 198, 209, 204, 207,
    222, 205, 218, 213, 212, 224, 218, 230, 235, 251, 250, 245, 250, 263, 273,
    271, 275, 281, 264, 274, 288, 287, 307, 303, 307, 323, 304, 335, 335, 346,
    345, 347, 348, 370, 364, 380, 393, 384, 407, 419, 421, 419, 433, 431, 461,
    465,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (koristepensas, tuntematon)
    241, 195, 223, 489, 574, 565, 634, 605, 574, 613, 645, 636, 644, 628, 621,
    603, 614, 654, 676, 719, 776, 795, 862, 879, 918, 918, 955, 980, 1013,
    1055,
    1132, 1225, 1258, 1362, 1427, 1579, 1796, 1936, 2079, 2258, 2440, 2597,
    2728, 2790, 2777,
    2857, 2923, 2991, 3031, 3040, 3037, 3094, 3066, 3023, 3093, 3044, 3082,
    3085, 3147, 3226,
    3192,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (kanukka)
    241, 325, 490, 336, 287, 353, 369, 335, 309, 298, 310, 323, 319, 313, 314,
    326, 319, 335, 324, 343, 381, 412, 516, 637, 719, 851, 940, 1030, 1047,
    1074,
    1061, 1040, 1002, 982, 913, 847, 805, 766, 749, 717, 698, 659, 627, 595,
    607,
    578, 576, 565, 525, 472, 472, 438, 410, 388, 379, 386, 419, 496, 691,
    1007,
    1349,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (kanukka)
    723, 195, 445, 397, 522, 441, 450, 462, 412, 393, 393, 378, 368, 396, 376,
    391, 367, 380, 385, 384, 375, 371, 364, 367, 368, 362, 341, 375, 356, 357,
    369, 368, 366, 372, 365, 374, 374, 397, 414, 450, 481, 543, 644, 691, 739,
    848, 985, 1132, 1312, 1453, 1560, 1685, 1779, 1935, 2050, 2097, 2202,
    2210, 2288, 2372,
    2353,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//reddish brown leaf (kanukka)
    723, 390, 623, 611, 835, 512, 634, 645, 612, 552, 569, 582, 604, 588, 571,
    555, 557, 538, 546, 544, 531, 545, 528, 526, 525, 520, 525, 501, 500, 515,
    518, 524, 556, 551, 557, 585, 633, 669, 691, 762, 814, 891, 981, 1013,
    1068,
    1141, 1249, 1351, 1482, 1580, 1644, 1700, 1859, 1973, 2082, 2135, 2193,
    2182, 2245, 2333,
    2353,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (keltano)
    1445, 715, 801, 672, 443, 406, 531, 518, 504, 488, 501, 475, 496, 472,
    471,
    490, 466, 490, 502, 481, 517, 540, 580, 601, 670, 743, 785, 831, 851, 863,
    850, 823, 785, 750, 722, 673, 664, 648, 623, 595, 603, 581, 571, 544, 548,
    527, 536, 548, 546, 522, 518, 493, 491, 518, 521, 529, 540, 570, 662, 812,
    1072,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (korvakeltano)
    361, 585, 534, 367, 339, 318, 265, 287, 292, 293, 335, 301, 309, 328, 305,
    307, 330, 328, 322, 347, 368, 383, 434, 518, 617, 693, 763, 784, 803, 814,
    800, 792, 727, 686, 641, 594, 548, 517, 506, 476, 478, 462, 442, 407, 401,
    390, 397, 384, 356, 327, 334, 333, 321, 326, 333, 350, 382, 446, 533, 730,
    1045,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (keltano)
    843, 780, 1113, 489, 391, 777, 750, 765, 769, 785, 828, 883, 958, 948,
    952,
    941, 992, 1173, 1330, 1485, 1576, 1776, 1938, 1998, 2117, 2147, 2178,
    2284, 2304, 2296,
    2316, 2348, 2332, 2365, 2384, 2389, 2366, 2370, 2365, 2392, 2421, 2431,
    2456, 2439, 2375,
    2399, 2431, 2416, 2440, 2417, 2412, 2343, 2358, 2345, 2369, 2328, 2387,
    2362, 2419, 2475,
    2495,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koiranheisi)
    843, 520, 490, 520, 469, 582, 404, 422, 406, 384, 400, 371, 392, 378, 379,
    377, 385, 400, 437, 454, 494, 589, 718, 822, 946, 1088, 1185, 1257, 1305,
    1287,
    1295, 1291, 1239, 1205, 1180, 1114, 1055, 1028, 1002, 989, 979, 943, 926,
    880, 864,
    858, 835, 814, 744, 682, 651, 608, 595, 535, 555, 575, 634, 767, 994,
    1372,
    1723,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red berry (koiranheisi)
    0, 260, 134, 61, 52, 71, 115, 40, 49, 43, 32, 43, 35, 35, 29,
    28, 29, 32, 33, 21, 27, 22, 32, 34, 39, 48, 44, 46, 39, 53,
    66, 80, 95, 114, 145, 215, 290, 359, 432, 521, 606, 704, 776, 795, 785,
    840, 916, 923, 997, 1011, 1017, 1061, 1068, 1069, 1085, 1087, 1113, 1116,
    1070, 1099,
    1109,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green moss (nuotiosammal)
    120, 65, 134, 31, 209, 124, 104, 96, 97, 95, 76, 79, 83, 93, 83,
    95, 95, 104, 117, 127, 140, 161, 214, 252, 290, 310, 328, 343, 347, 373,
    365, 351, 347, 343, 311, 301, 285, 283, 263, 256, 255, 251, 257, 235, 227,
    224, 233, 208, 194, 186, 165, 160, 151, 149, 157, 161, 185, 243, 309, 425,
    543,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown moss (nuotiosammal)
    482, 260, 178, 92, 104, 88, 92, 40, 43, 52, 58, 64, 70, 63, 67,
    67, 62, 76, 82, 82, 91, 96, 104, 116, 135, 141, 142, 155, 168, 179,
    198, 199, 193, 201, 212, 218, 226, 240, 242, 238, 255, 265, 277, 266, 265,
    283, 289, 275, 289, 277, 291, 288, 277, 252, 262, 260, 264, 299, 375, 411,
    446,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//black soil
    0, 0, 89, 122, 52, 53, 104, 127, 130, 134, 137, 137, 134, 136, 138,
    139, 134, 140, 142, 148, 154, 153, 152, 150, 151, 156, 153, 166, 154, 171,
    163, 163, 166, 166, 169, 169, 166, 174, 174, 170, 170, 168, 176, 177, 176,
    174, 179, 180, 180, 183, 177, 193, 178, 187, 194, 193, 182, 196, 184, 195,
    195,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//gray lichen (nahkajaekaelae)
    1204, 585, 1113, 733, 600, 653, 715, 685, 726, 682, 713, 691, 719, 691,
    683,
    693, 711, 715, 701, 700, 720, 697, 706, 696, 723, 714, 726, 738, 729, 735,
    737, 739, 742, 746, 746, 761, 743, 735, 722, 717, 728, 749, 721, 712, 705,
    737, 733, 758, 780, 785, 775, 771, 755, 744, 743, 742, 755, 779, 849, 940,
    1042,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (tuomi)
    1668, 630, 443, 515, 521, 468, 438, 269, 336, 332, 354, 350, 351, 363,
    367,
    364, 364, 399, 433, 479, 537, 648, 827, 1030, 1240, 1425, 1629, 1743,
    1813, 1874,
    1918, 1952, 1971, 1981, 1976, 1971, 1944, 1974, 1976, 1956, 1955, 1897,
    1854, 1878, 1860,
    1824, 1815, 1792, 1718, 1655, 1602, 1577, 1394, 1255, 1154, 1113, 1200,
    1419, 1771, 2088,
    2361,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//black berry (tuomi)
    0, 0, 0, 0, 25, 17, 21, 7, 0, 0, 3, 0, 5, 5, 7,
    7, 6, 10, 10, 10, 6, 4, 6, 6, 6, 6, 7, 9, 7, 8,
    7, 3, 7, 6, 5, 5, 3, 3, 8, 9, 6, 7, 8, 5, 7,
    10, 8, 10, 11, 14, 23, 24, 23, 24, 21, 27, 34, 54, 101, 144,
    218,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green fruit (maenty)
    758, 394, 295, 200, 273, 167, 160, 131, 124, 117, 118, 106, 104, 93, 105,
    106, 111, 114, 119, 123, 128, 154, 172, 191, 220, 223, 244, 266, 258, 258,
    280, 267, 269, 251, 245, 239, 230, 228, 223, 219, 213, 211, 198, 184, 194,
    192, 184, 181, 162, 156, 141, 145, 146, 144, 139, 145, 187, 242, 304, 399,
    533,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown fruit (maenty)
    758, 315, 0, 200, 298, 234, 160, 160, 227, 227, 229, 227, 234, 229, 221,
    238, 248, 244, 247, 249, 249, 263, 266, 278, 292, 295, 298, 306, 320, 345,
    341, 344, 369, 377, 395, 411, 416, 434, 461, 479, 502, 520, 544, 567, 570,
    588, 634, 647, 676, 682, 696, 729, 765, 790, 807, 837, 853, 866, 892, 933,
    947,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green neadle (maenty)
    303, 157, 332, 229, 323, 301, 396, 385, 357, 356, 330, 350, 357, 361, 355,
    349, 364, 380, 390, 392, 407, 418, 452, 488, 547, 577, 624, 613, 626, 632,
    604, 603, 585, 564, 531, 516, 482, 480, 472, 457, 457, 431, 422, 417, 423,
    411, 414, 400, 383, 379, 364, 369, 379, 358, 358, 375, 388, 430, 506, 668,
    798,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koivu)
    0, 157, 332, 659, 372, 602, 567, 553, 595, 628, 674, 665, 665, 662, 659,
    673, 698, 717, 788, 861, 950, 1072, 1317, 1547, 1766, 1946, 2170, 2331,
    2400, 2528,
    2579, 2625, 2691, 2699, 2746, 2810, 2830, 2885, 2954, 2916, 2969, 2993,
    3008, 2980, 2992,
    3034, 3015, 2967, 3062, 3029, 3033, 3062, 3014, 3007, 3035, 2982, 3021,
    3029, 3029, 3078,
    3141,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koivu)
    1062, 472, 553, 830, 745, 702, 738, 698, 672, 685, 702, 680, 721, 669,
    672,
    684, 713, 750, 774, 815, 856, 982, 1154, 1321, 1542, 1727, 1948, 2079,
    2183, 2287,
    2345, 2380, 2422, 2478, 2433, 2476, 2494, 2501, 2524, 2507, 2534, 2541,
    2505, 2500, 2495,
    2516, 2526, 2480, 2447, 2393, 2363, 2332, 2247, 2157, 2068, 2087, 2220,
    2395, 2650, 2846,
    2985,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koivu)
    1213, 787, 516, 544, 496, 501, 524, 487, 522, 531, 542, 544, 548, 533,
    538,
    527, 569, 552, 574, 600, 640, 696, 839, 971, 1134, 1303, 1468, 1528, 1575,
    1613,
    1598, 1566, 1568, 1515, 1477, 1388, 1333, 1332, 1274, 1257, 1217, 1156,
    1087, 1072, 1065,
    1048, 1024, 1029, 984, 941, 879, 816, 770, 727, 678, 706, 764, 899, 1154,
    1571,
    1995,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, dry leaf (koivu)
    758, 394, 258, 544, 496, 535, 406, 407, 398, 401, 427, 427, 423, 416, 435,
    435, 437, 459, 435, 473, 487, 496, 494, 513, 560, 540, 568, 588, 609, 635,
    619, 669, 687, 688, 690, 714, 726, 763, 771, 794, 816, 841, 855, 855, 892,
    894, 913, 933, 967, 1038, 1009, 1021, 1076, 1067, 1077, 1102, 1114, 1135,
    1145, 1151,
    1168,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, dry leaf (koivu)
    0, 315, 221, 172, 174, 301, 278, 284, 300, 259, 292, 285, 278, 275, 271,
    282, 295, 296, 285, 295, 286, 298, 310, 309, 313, 321, 325, 333, 316, 335,
    336, 341, 334, 340, 333, 342, 339, 353, 354, 351, 361, 377, 379, 373, 381,
    373, 392, 408, 404, 411, 431, 439, 459, 458, 446, 468, 465, 478, 477, 487,
    479,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (lehmus)
    1213, 315, 406, 401, 472, 318, 364, 320, 336, 356, 368, 382, 410, 433,
    428,
    459, 447, 488, 536, 608, 650, 831, 1041, 1229, 1434, 1627, 1845, 1905,
    1969, 2053,
    2105, 2129, 2193, 2196, 2193, 2226, 2252, 2271, 2267, 2234, 2292, 2279,
    2271, 2263, 2263,
    2309, 2304, 2220, 2175, 2115, 2027, 2002, 1954, 1888, 1824, 1877, 2004,
    2231, 2460, 2645,
    2749,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (lehmus)
    1062, 866, 443, 544, 496, 485, 492, 458, 450, 425, 458, 477, 497, 461,
    451,
    481, 454, 500, 515, 538, 529, 593, 638, 670, 686, 711, 718, 729, 741, 760,
    796, 833, 895, 958, 1016, 1128, 1246, 1344, 1450, 1505, 1596, 1636, 1621,
    1631, 1627,
    1628, 1658, 1583, 1486, 1415, 1322, 1265, 1159, 1062, 975, 974, 1063,
    1326, 1736, 2141,
    2568,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, dry leaf (lehmus)
    758, 236, 148, 430, 347, 435, 438, 495, 439, 454, 472, 471, 461, 459, 458,
    479, 492, 482, 499, 513, 520, 545, 567, 594, 623, 647, 698, 717, 744, 792,
    803, 834, 864, 876, 916, 932, 963, 1013, 1025, 1060, 1099, 1118, 1153,
    1175, 1207,
    1242, 1268, 1266, 1284, 1305, 1305, 1304, 1353, 1360, 1330, 1332, 1413,
    1502, 1610, 1682,
    1737,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (lehmus)
    1668, 709, 221, 401, 397, 301, 310, 342, 346, 296, 340, 350, 362, 368,
    365,
    373, 375, 411, 467, 495, 549, 669, 860, 1032, 1204, 1379, 1562, 1657,
    1740, 1822,
    1855, 1882, 1939, 1953, 1992, 2035, 2035, 2079, 2027, 2079, 2067, 2098,
    2081, 2106, 2124,
    2100, 2098, 2025, 1928, 1858, 1772, 1763, 1729, 1679, 1605, 1666, 1915,
    2222, 2485, 2645,
    2724,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (mustikka)
    1062, 236, 369, 344, 124, 267, 364, 364, 398, 429, 441, 424, 438, 440,
    435,
    417, 441, 455, 481, 477, 481, 529, 542, 553, 557, 586, 592, 602, 611, 652,
    676, 739, 793, 858, 923, 1044, 1188, 1307, 1433, 1585, 1650, 1716, 1677,
    1717, 1731,
    1754, 1771, 1747, 1714, 1677, 1579, 1480, 1371, 1242, 1119, 1072, 1226,
    1464, 1799, 2205,
    2405,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (mustikka)
    910, 551, 221, 229, 347, 334, 438, 400, 429, 413, 420, 435, 451, 426, 449,
    441, 488, 494, 534, 580, 640, 726, 877, 1011, 1147, 1257, 1378, 1415,
    1456, 1468,
    1454, 1444, 1435, 1354, 1319, 1297, 1223, 1185, 1192, 1146, 1107, 1061,
    992, 984, 964,
    981, 971, 921, 861, 808, 761, 722, 654, 591, 582, 574, 669, 830, 1104,
    1463,
    1817,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (mustikka)
    758, 236, 295, 86, 298, 267, 246, 240, 274, 251, 267, 244, 257, 253, 258,
    245, 255, 246, 236, 245, 255, 259, 245, 244, 255, 256, 256, 245, 234, 246,
    244, 249, 241, 254, 254, 256, 260, 270, 297, 334, 391, 479, 555, 629, 685,
    774, 886, 990, 1129, 1212, 1227, 1299, 1341, 1336, 1314, 1357, 1433, 1541,
    1651, 1786,
    1875,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (pihlaja)
    1062, 394, 443, 430, 347, 368, 428, 335, 336, 352, 361, 338, 354, 351,
    340,
    335, 383, 397, 437, 469, 512, 638, 817, 1015, 1223, 1441, 1631, 1743,
    1832, 1922,
    2017, 2039, 2130, 2205, 2262, 2338, 2369, 2445, 2523, 2527, 2562, 2593,
    2515, 2533, 2563,
    2587, 2597, 2573, 2575, 2580, 2502, 2415, 2290, 2157, 2030, 1986, 2070,
    2279, 2580, 2773,
    2880,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (pihlaja)
    0, 394, 184, 86, 149, 201, 267, 269, 248, 247, 240, 256, 267, 277, 253,
    256, 263, 263, 269, 283, 294, 321, 362, 396, 446, 461, 480, 486, 513, 515,
    539, 556, 608, 636, 676, 755, 824, 915, 995, 1100, 1256, 1388, 1499, 1593,
    1667,
    1773, 1920, 2027, 2116, 2190, 2219, 2328, 2361, 2432, 2399, 2399, 2441,
    2527, 2565, 2564,
    2633,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (pihlaja)
    0, 236, 221, 172, 248, 167, 182, 189, 202, 166, 195, 191, 188, 182, 180,
    183, 176, 170, 180, 178, 177, 177, 174, 178, 180, 179, 177, 185, 186, 194,
    200, 210, 211, 225, 235, 275, 357, 440, 525, 623, 748, 836, 889, 927, 949,
    985, 1046, 1075, 1050, 1007, 946, 898, 808, 732, 646, 624, 741, 932, 1259,
    1618,
    1962,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (pihlaja)
    910, 709, 295, 344, 323, 234, 225, 233, 212, 227, 222, 206, 204, 201, 214,
    216, 218, 213, 216, 204, 202, 206, 214, 214, 222, 221, 229, 225, 219, 228,
    227, 231, 238, 243, 264, 286, 328, 400, 444, 556, 705, 831, 938, 1039,
    1088,
    1206, 1329, 1422, 1510, 1596, 1625, 1705, 1707, 1752, 1792, 1811, 1844,
    1870, 1951, 1954,
    1962,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (pihlaja)
    455, 394, 295, 258, 248, 167, 246, 218, 233, 194, 219, 197, 191, 201, 180,
    192, 205, 186, 200, 198, 189, 189, 197, 187, 196, 195, 198, 197, 192, 189,
    195, 189, 198, 205, 229, 227, 242, 276, 299, 335, 372, 408, 420, 442, 454,
    464, 493, 495, 449, 440, 403, 372, 341, 288, 286, 287, 319, 436, 651,
    1007,
    1447,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//black, dry leaf (pihlaja)
    0, 79, 111, 172, 174, 201, 214, 211, 207, 207, 191, 200, 196, 206, 196,
    194, 203, 207, 204, 208, 210, 212, 211, 208, 209, 219, 222, 224, 231, 241,
    232, 244, 249, 250, 267, 264, 262, 269, 282, 277, 289, 284, 279, 302, 289,
    308, 313, 315, 310, 325, 313, 319, 356, 340, 331, 347, 356, 352, 364, 373,
    352,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red berry (pihlaja)
    0, 0, 0, 0, 25, 84, 128, 87, 165, 130, 167, 147, 155, 146, 148,
    165, 158, 159, 164, 160, 158, 158, 157, 157, 173, 173, 179, 195, 210, 234,
    264, 302, 349, 386, 461, 572, 735, 886, 1038, 1216, 1376, 1521, 1607,
    1691, 1728,
    1769, 1842, 1843, 1865, 1910, 1881, 1920, 1909, 1909, 1891, 1879, 1915,
    1879, 1878, 1843,
    1832,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, old berry (pihlaja)
    758, 315, 258, 430, 248, 301, 299, 247, 259, 259, 271, 265, 265, 277, 269,
    276, 274, 271, 289, 279, 286, 302, 318, 316, 348, 350, 379, 408, 416, 443,
    457, 467, 487, 486, 504, 511, 535, 559, 580, 598, 615, 641, 635, 620, 643,
    685, 683, 682, 706, 720, 714, 717, 735, 737, 729, 733, 750, 744, 775, 765,
    751,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (terttuselja)
    0, 0, 111, 57, 124, 134, 182, 225, 227, 255, 285, 271, 290, 287, 267,
    267, 274, 277, 299, 287, 294, 305, 304, 320, 323, 308, 328, 333, 335, 353,
    357, 375, 382, 414, 434, 474, 548, 585, 670, 755, 842, 977, 1011, 1056,
    1103,
    1170, 1244, 1270, 1293, 1298, 1245, 1214, 1113, 1036, 927, 908, 1037,
    1314, 1568, 1876,
    2129,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red berry (terttuselja)
    152, 236, 221, 115, 99, 100, 75, 80, 78, 57, 59, 62, 64, 65, 68,
    71, 66, 68, 69, 69, 64, 62, 67, 68, 68, 72, 76, 72, 75, 68,
    72, 75, 70, 74, 74, 91, 96, 113, 124, 153, 184, 223, 230, 249, 260,
    280, 301, 300, 317, 314, 320, 338, 318, 314, 315, 315, 319, 320, 335, 346,
    330,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (paju)
    1668, 551, 516, 773, 993, 819, 962, 895, 936, 915, 986, 974, 935, 947,
    937,
    935, 995, 992, 1069, 1095, 1181, 1317, 1547, 1751, 1996, 2215, 2475, 2581,
    2629, 2678,
    2696, 2669, 2715, 2696, 2612, 2593, 2499, 2447, 2506, 2413, 2408, 2364,
    2235, 2166, 2215,
    2237, 2201, 2171, 2069, 1993, 1885, 1825, 1717, 1525, 1477, 1439, 1548,
    1834, 2223, 2648,
    2956,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (paju)
    2882, 1417, 516, 916, 670, 903, 802, 880, 853, 822, 854, 874, 863, 849,
    852,
    869, 927, 945, 1033, 1091, 1191, 1399, 1667, 1923, 2201, 2464, 2733, 2886,
    2927, 3028,
    3042, 3047, 3123, 3113, 3112, 3137, 3109, 3121, 3109, 3136, 3128, 3090,
    3028, 2977, 3069,
    3051, 3097, 3056, 2975, 2917, 2847, 2820, 2711, 2563, 2433, 2426, 2524,
    2712, 3026, 3259,
    3341,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (paju)
    1668, 1417, 996, 830, 893, 986, 952, 931, 967, 952, 948, 1000, 1008, 1002,
    978,
    1030, 1004, 1071, 1164, 1199, 1283, 1428, 1667, 1893, 2082, 2282, 2489,
    2572, 2650, 2763,
    2808, 2802, 2871, 2894, 2927, 2962, 2987, 3002, 3015, 2978, 3040, 3059,
    3055, 3053, 3091,
    3106, 3180, 3147, 3185, 3194, 3119, 3177, 3184, 3159, 3123, 3105, 3188,
    3148, 3191, 3132,
    3185,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (paju)
    1213, 630, 590, 573, 472, 485, 503, 451, 486, 470, 490, 480, 481, 478,
    494,
    490, 518, 531, 536, 544, 566, 576, 611, 621, 661, 686, 729, 762, 804, 841,
    886, 920, 965, 990, 1008, 1089, 1126, 1162, 1201, 1254, 1306, 1349, 1367,
    1390, 1396,
    1451, 1476, 1494, 1505, 1564, 1577, 1620, 1596, 1608, 1621, 1628, 1697,
    1735, 1780, 1789,
    1814,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//white leaf (vadelma)
    0, 866, 1107, 888, 1439, 1337, 1379, 1418, 1515, 1511, 1525, 1553, 1543,
    1578, 1586,
    1573, 1623, 1575, 1619, 1629, 1608, 1650, 1656, 1645, 1719, 1732, 1762,
    1759, 1757, 1769,
    1773, 1764, 1771, 1776, 1776, 1785, 1766, 1764, 1758, 1742, 1762, 1762,
    1755, 1738, 1744,
    1769, 1765, 1743, 1731, 1722, 1711, 1731, 1734, 1705, 1637, 1655, 1691,
    1700, 1736, 1816,
    1897,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (vadelma) 
    455, 709, 332, 229, 223, 217, 214, 204, 233, 211, 226, 221, 224, 218, 237,
    225, 240, 240, 247, 249, 245, 253, 260, 256, 272, 276, 290, 290, 294, 301,
    305, 302, 306, 314, 314, 331, 336, 338, 342, 351, 346, 349, 366, 352, 379,
    382, 398, 406, 400, 397, 392, 396, 391, 390, 409, 399, 416, 439, 455, 534,
    555,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown, old leaf (voikukka)
    303, 236, 332, 258, 323, 201, 289, 298, 295, 308, 320, 321, 313, 301, 301,
    307, 302, 318, 313, 315, 321, 323, 322, 335, 338, 330, 328, 335, 335, 325,
    334, 344, 342, 356, 355, 374, 381, 400, 426, 459, 494, 503, 520, 511, 539,
    555, 575, 540, 510, 508, 492, 466, 452, 418, 398, 419, 451, 579, 749,
    1020,
    1367,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (voikukka)
    303, 236, 111, 286, 397, 368, 289, 262, 269, 275, 285, 265, 280, 265, 269,
    267, 272, 242, 245, 243, 245, 231, 235, 235, 226, 217, 213, 210, 214, 219,
    215, 216, 234, 235, 234, 256, 282, 306, 322, 368, 443, 523, 598, 677, 727,
    827, 955, 1037, 1146, 1255, 1275, 1376, 1439, 1428, 1445, 1442, 1525,
    1622, 1739, 1843,
    1951,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//gray, dry leaf (kielo)
    1972, 2362, 1918, 1604, 2010, 2106, 2085, 2015, 2068, 2074, 2202, 2250,
    2277, 2269, 2270,
    2299, 2331, 2375, 2399, 2395, 2410, 2510, 2556, 2582, 2693, 2748, 2785,
    2833, 2836, 2846,
    2861, 2877, 2918, 2929, 2927, 2929, 2919, 2957, 2970, 2941, 2986, 3033,
    2923, 2931, 3029,
    3015, 3049, 2987, 3051, 3034, 2938, 2996, 3050, 3065, 3010, 2957, 3024,
    2990, 2988, 3034,
    3032,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//green leaf (koristeviinimarjapensas)
    1972, 945, 701, 601, 496, 535, 385, 349, 357, 340, 340, 338, 331, 320,
    326,
    344, 336, 341, 358, 348, 358, 358, 385, 418, 433, 468, 487, 491, 498, 530,
    533, 529, 534, 528, 525, 533, 519, 519, 520, 510, 510, 523, 510, 521, 519,
    523, 547, 515, 493, 474, 461, 452, 444, 431, 433, 421, 477, 556, 730, 983,
    1255,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (koristeviinimarjapensas)
    1820, 709, 627, 659, 571, 685, 545, 509, 512, 559, 587, 568, 558, 559,
    574,
    576, 589, 581, 623, 671, 691, 772, 863, 903, 988, 1021, 1070, 1099, 1129,
    1155,
    1195, 1221, 1275, 1303, 1343, 1425, 1488, 1565, 1623, 1695, 1776, 1823,
    1846, 1883, 1920,
    1986, 2035, 2025, 1958, 1975, 1913, 1871, 1805, 1697, 1662, 1630, 1729,
    1873, 2131, 2346,
    2535,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (koristeviinimarjapensas)
    1062, 945, 258, 515, 372, 301, 321, 327, 315, 316, 313, 306, 293, 299,
    292,
    291, 280, 285, 307, 269, 272, 272, 283, 265, 285, 273, 280, 275, 286, 270,
    284, 282, 293, 309, 306, 324, 368, 392, 453, 544, 666, 772, 864, 956,
    1041,
    1141, 1300, 1386, 1459, 1560, 1572, 1652, 1669, 1658, 1664, 1625, 1766,
    1959, 2153, 2326,
    2434,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (koristepensas, tuntematon)
    1062, 315, 295, 401, 596, 518, 599, 531, 589, 551, 601, 615, 629, 648,
    615,
    646, 659, 672, 732, 699, 755, 813, 865, 890, 925, 955, 999, 996, 990,
    1021,
    1088, 1123, 1188, 1214, 1294, 1413, 1504, 1605, 1710, 1806, 1954, 2052,
    2119, 2171, 2283,
    2364, 2461, 2449, 2454, 2528, 2518, 2528, 2504, 2523, 2498, 2470, 2516,
    2572, 2647, 2655,
    2680,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koristepensas, tuntematon)
    2730, 1339, 959, 1060, 819, 869, 930, 960, 1029, 1081, 1105, 1124, 1169,
    1171, 1183,
    1233, 1267, 1340, 1459, 1554, 1649, 1831, 2048, 2215, 2334, 2436, 2562,
    2611, 2590, 2651,
    2684, 2700, 2753, 2776, 2803, 2820, 2796, 2869, 2931, 2923, 2947, 2928,
    2872, 2874, 2941,
    2963, 3033, 2979, 2904, 3007, 2915, 2943, 2893, 2916, 2853, 2826, 2814,
    2894, 2950, 2971,
    2996,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (koristepensas, tuntematon)
    910, 551, 996, 945, 1142, 1120, 1165, 1084, 1169, 1183, 1292, 1362, 1431,
    1441, 1486,
    1564, 1629, 1712, 1858, 1957, 2081, 2245, 2470, 2624, 2769, 2866, 2942,
    2988, 2971, 3025,
    3045, 3005, 3084, 3109, 3087, 3101, 3095, 3103, 3126, 3109, 3093, 3090,
    3050, 3039, 3120,
    3148, 3160, 3058, 3060, 3075, 3033, 2994, 2972, 2947, 2949, 2867, 2946,
    2951, 2998, 3004,
    3079,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (vaahtera)
    303, 1024, 590, 487, 546, 351, 406, 407, 445, 429, 417, 468, 463, 459,
    490,
    474, 512, 517, 631, 675, 753, 899, 1133, 1291, 1394, 1559, 1762, 1878,
    1976, 2068,
    2174, 2226, 2319, 2383, 2424, 2495, 2550, 2595, 2657, 2645, 2726, 2780,
    2745, 2763, 2818,
    2874, 2914, 2890, 2870, 2953, 2838, 2888, 2908, 2963, 2912, 2848, 2972,
    2924, 2931, 2947,
    2952,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (vaahtera)
    0, 472, 516, 487, 546, 535, 513, 495, 517, 579, 580, 603, 581, 607, 588,
    602, 614, 659, 748, 784, 891, 1126, 1434, 1681, 1932, 2118, 2349, 2440,
    2499, 2627,
    2698, 2700, 2753, 2783, 2836, 2882, 2895, 2940, 2992, 2952, 3013, 3049,
    2996, 3007, 3093,
    3064, 3156, 3080, 3009, 3088, 3024, 3037, 3067, 3096, 3035, 3020, 3032,
    3026, 3058, 3051,
    3061,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//yellow leaf (vaahtera)
    1062, 787, 627, 974, 844, 1086, 941, 1011, 988, 1057, 1146, 1227, 1291,
    1353, 1422,
    1456, 1537, 1606, 1704, 1724, 1791, 1932, 2020, 2060, 2199, 2243, 2296,
    2410, 2426, 2510,
    2588, 2603, 2689, 2713, 2724, 2806, 2809, 2879, 2928, 2926, 2993, 3021,
    2984, 2971, 3032,
    3096, 3098, 3080, 3081, 3174, 3068, 3112, 3153, 3130, 3136, 3080, 3150,
    3157, 3124, 3138,
    3145,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//orange leaf (vaahtera)
    1517, 551, 664, 659, 521, 585, 460, 385, 424, 389, 375, 374, 359, 380,
    371,
    373, 379, 387, 378, 394, 405, 416, 463, 496, 536, 542, 577, 579, 619, 642,
    678, 710, 777, 829, 894, 1035, 1174, 1334, 1484, 1611, 1798, 1941, 2012,
    2065, 2135,
    2229, 2286, 2317, 2332, 2357, 2323, 2330, 2292, 2236, 2137, 2093, 2180,
    2240, 2368, 2487,
    2528,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (vaahtera)
    758, 551, 516, 659, 596, 719, 652, 611, 620, 612, 643, 641, 624, 600, 597,
    589, 595, 589, 612, 578, 590, 584, 599, 585, 596, 610, 597, 581, 583, 590,
    603, 610, 618, 655, 678, 722, 815, 900, 994, 1084, 1171, 1249, 1243, 1283,
    1290,
    1320, 1357, 1291, 1193, 1147, 1074, 1041, 1020, 968, 860, 864, 942, 1102,
    1448, 1900,
    2271,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (vaahtera)
    3033, 1181, 849, 745, 794, 568, 588, 582, 543, 567, 608, 597, 606, 619,
    618,
    649, 672, 699, 746, 778, 784, 858, 892, 973, 1035, 1050, 1171, 1241, 1238,
    1312,
    1397, 1416, 1450, 1491, 1539, 1605, 1650, 1715, 1749, 1800, 1876, 1897,
    1907, 1920, 1959,
    1995, 2080, 2066, 2062, 2151, 2096, 2183, 2217, 2228, 2233, 2246, 2323,
    2333, 2381, 2363,
    2372,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (vaahtera)
    1820, 1102, 406, 258, 397, 435, 267, 298, 279, 255, 299, 256, 283, 280,
    276,
    276, 298, 308, 317, 331, 368, 391, 433, 473, 519, 568, 657, 694, 727, 812,
    891, 931, 1004, 1018, 1068, 1143, 1196, 1266, 1314, 1350, 1423, 1467,
    1482, 1523, 1579,
    1662, 1710, 1690, 1733, 1777, 1774, 1840, 1843, 1912, 1963, 1967, 2036,
    2016, 2074, 2108,
    2111,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (vaahtera)
    758, 866, 406, 458, 447, 468, 503, 473, 398, 441, 455, 459, 425, 442, 444,
    432, 465, 457, 451, 453, 455, 475, 498, 490, 519, 527, 565, 588, 614, 646,
    691, 695, 718, 750, 793, 842, 883, 915, 981, 1016, 1075, 1133, 1135, 1180,
    1231,
    1271, 1317, 1351, 1382, 1499, 1472, 1526, 1585, 1600, 1686, 1726, 1772,
    1801, 1840, 1896,
    1919,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//brown leaf (vaahtera)
    303, 157, 332, 258, 273, 234, 257, 240, 259, 259, 278, 300, 275, 270, 276,
    278, 278, 273, 285, 297, 298, 294, 314, 331, 348, 348, 379, 370, 381, 404,
    417, 423, 433, 448, 460, 480, 493, 511, 522, 545, 578, 607, 608, 625, 649,
    668, 713, 726, 736, 786, 788, 823, 836, 876, 863, 889, 945, 968, 996,
    1051,
    1085,
    }},
  {
   61, 400, 700,		/* 61 bands from 400 to 700 nm in 5nm steps  */
   KUOPIO_NATURAL_SCALE,			/* Scale factor  */
   {
//red leaf (pihlaja)
    910, 315, 221, 200, 199, 234, 267, 255, 238, 235, 229, 244, 242, 232, 219,
    232, 242, 234, 230, 220, 224, 224, 228, 231, 232, 230, 236, 232, 217, 219,
    232, 228, 228, 229, 232, 253, 262, 287, 306, 337, 378, 410, 428, 429, 462,
    489, 521, 503, 498, 508, 466, 449, 404, 395, 374, 361, 399, 514, 734,
    1061,
    1400}}

};

/*    https://law.resource.org/pub/us/cfr/ibr/003/cie.15.2004.tables.xls
   CIE 1931 standard coloriometric observer
   bands from 380 to 780 by 5nm steps.  */
const spectrum cie_cmf_x = {
  0.001368, 0.002236, 0.004243, 0.007650, 0.014310, 0.023190, 0.043510, 0.077630, 0.134380,
  0.214770, 0.283900, 0.328500, 0.348280, 0.348060, 0.336200, 0.318700, 0.290800, 0.251100,
  0.195360, 0.142100, 0.095640, 0.057950, 0.032010, 0.014700, 0.004900, 0.002400, 0.009300,
  0.029100, 0.063270, 0.109600, 0.165500, 0.225750, 0.290400, 0.359700, 0.433450, 0.512050,
  0.594500, 0.678400, 0.762100, 0.842500, 0.916300, 0.978600, 1.026300, 1.056700, 1.062200,
  1.045600, 1.002600, 0.938400, 0.854450, 0.751400, 0.642400, 0.541900, 0.447900, 0.360800,
  0.283500, 0.218700, 0.164900, 0.121200, 0.087400, 0.063600, 0.046770, 0.032900, 0.022700,
  0.015840, 0.011359, 0.008111, 0.005790, 0.004109, 0.002899, 0.002049, 0.001440, 0.001000,
  0.000690, 0.000476, 0.000332, 0.000235, 0.000166, 0.000117, 0.000083, 0.000059, 0.000042,
};
const spectrum cie_cmf_y = {
  0.000039, 0.000064, 0.000120, 0.000217, 0.000396, 0.000640, 0.001210, 0.002180, 0.004000,
0.007300, 0.011600, 0.016840, 0.023000, 0.029800, 0.038000, 0.048000, 0.060000, 0.073900,
0.090980, 0.112600, 0.139020, 0.169300, 0.208020, 0.258600, 0.323000, 0.407300, 0.503000,
0.608200, 0.710000, 0.793200, 0.862000, 0.914850, 0.954000, 0.980300, 0.994950, 1.000000,
0.995000, 0.978600, 0.952000, 0.915400, 0.870000, 0.816300, 0.757000, 0.694900, 0.631000,
0.566800, 0.503000, 0.441200, 0.381000, 0.321000, 0.265000, 0.217000, 0.175000, 0.138200,
0.107000, 0.081600, 0.061000, 0.044580, 0.032000, 0.023200, 0.017000, 0.011920, 0.008210,
0.005723, 0.004102, 0.002929, 0.002091, 0.001484, 0.001047, 0.000740, 0.000520, 0.000361,
0.000249, 0.000172, 0.000120, 0.000085, 0.000060, 0.000042, 0.000030, 0.000021, 0.000015,

};
const spectrum cie_cmf_z = {
  0.006450, 0.010550, 0.020050, 0.036210, 0.067850, 0.110200, 0.207400, 0.371300, 0.645600,
1.039050, 1.385600, 1.622960, 1.747060, 1.782600, 1.772110, 1.744100, 1.669200, 1.528100,
1.287640, 1.041900, 0.812950, 0.616200, 0.465180, 0.353300, 0.272000, 0.212300, 0.158200,
0.111700, 0.078250, 0.057250, 0.042160, 0.029840, 0.020300, 0.013400, 0.008750, 0.005750,
0.003900, 0.002750, 0.002100, 0.001800, 0.001650, 0.001400, 0.001100, 0.001000, 0.000800,
0.000600, 0.000340, 0.000240, 0.000190, 0.000100, 0.000050, 0.000030, 0.000020, 0.000010,
0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
};

const spectrum cie_cmf1964_x = {
  0.000160, 0.000662, 0.002362, 0.007242, 0.019110, 0.043400, 0.084736, 0.140638, 0.204492,
  0.264737, 0.314679, 0.357719, 0.383734, 0.386726, 0.370702, 0.342957, 0.302273, 0.254085,
  0.195618, 0.132349, 0.080507, 0.041072, 0.016172, 0.005132, 0.003816, 0.015444, 0.037465,
  0.071358, 0.117749, 0.172953, 0.236491, 0.304213, 0.376772, 0.451584, 0.529826, 0.616053,
  0.705224, 0.793832, 0.878655, 0.951162, 1.014160, 1.074300, 1.118520, 1.134300, 1.123990,
  1.089100, 1.030480, 0.950740, 0.856297, 0.754930, 0.647467, 0.535110, 0.431567, 0.343690,
  0.268329, 0.204300, 0.152568, 0.112210, 0.081261, 0.057930, 0.040851, 0.028623, 0.019941,
  0.013842, 0.009577, 0.006605, 0.004553, 0.003145, 0.002175, 0.001506, 0.001045, 0.000727,
  0.000508, 0.000356, 0.000251, 0.000178, 0.000126, 0.000090, 0.000065, 0.000046, 0.000033,
};
const spectrum cie_cmf1964_y = {
  0.000017, 0.000072, 0.000253, 0.000769, 0.002004, 0.004509, 0.008756, 0.014456, 0.021391,
  0.029497, 0.038676, 0.049602, 0.062077, 0.074704, 0.089456, 0.106256, 0.128201, 0.152761,
  0.185190, 0.219940, 0.253589, 0.297665, 0.339133, 0.395379, 0.460777, 0.531360, 0.606741,
  0.685660, 0.761757, 0.823330, 0.875211, 0.923810, 0.961988, 0.982200, 0.991761, 0.999110,
  0.997340, 0.982380, 0.955552, 0.915175, 0.868934, 0.825623, 0.777405, 0.720353, 0.658341,
  0.593878, 0.527963, 0.461834, 0.398057, 0.339554, 0.283493, 0.228254, 0.179828, 0.140211,
  0.107633, 0.081187, 0.060281, 0.044096, 0.031800, 0.022602, 0.015905, 0.011130, 0.007749,
  0.005375, 0.003718, 0.002565, 0.001768, 0.001222, 0.000846, 0.000586, 0.000407, 0.000284,
  0.000199, 0.000140, 0.000098, 0.000070, 0.000050, 0.000036, 0.000025, 0.000018, 0.000013,
};
const spectrum cie_cmf1964_z = {
  0.000705, 0.002928, 0.010482, 0.032344, 0.086011, 0.197120, 0.389366, 0.656760, 0.972542,
  1.282500, 1.553480, 1.798500, 1.967280, 2.027300, 1.994800, 1.900700, 1.745370, 1.554900,
  1.317560, 1.030200, 0.772125, 0.570060, 0.415254, 0.302356, 0.218502, 0.159249, 0.112044,
  0.082248, 0.060709, 0.043050, 0.030451, 0.020584, 0.013676, 0.007918, 0.003988, 0.001091,
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
  0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
};

namespace {




/* Tramsission of lens
   https://www.lensrentals.com/blog/2018/04/looking-at-cine-lens-color-shifts-using-spectrometry/  */
const static spectra_entry zeiss_contact_prime_cp2_tramsmission[] =
{
  {375.42227003765464, 29.687500000000014},
  {382.3883808499193, 39.613970588235304},
  {387.76223776223776, 47.70220588235294},
  {393.1360946745562, 55.422794117647065},
  {400.6993006993007, 63.143382352941174},
  {410.25282409897795, 69.94485294117646},
  {422.19472834857453, 75.45955882352942},
  {435.33082302313073, 79.50367647058823},
  {450.85529854760625, 82.62867647058823},
  {467.17590102205486, 85.20220588235294},
  {485.08875739644975, 86.94852941176471},
  {503.39967724583107, 88.78676470588235},
  {522.108660570199, 90.1654411764706},
  {545.1963421194191, 91.1764705882353},
  {570.2743410435719, 91.26838235294117},
  {594.5562130177515, 90.90073529411765},
  {614.8574502420656, 90.53308823529412},
  {635.1586874663799, 90.34926470588235},
  {653.0715438407747, 89.98161764705883},
  {674.9650349650351, 89.0625},
  {692.8778913394299, 87.13235294117646},
  {708.8004303388919, 84.55882352941177},
  {722.3345884884347, 81.61764705882354},
  {735.0726196880044, 78.30882352941177},
  {749.4029047875204, 74.17279411764706}
};
/* Tramsission of lens
   https://www.lensrentals.com/blog/2018/04/looking-at-cine-lens-color-shifts-using-spectrometry/  */
const static spectra_entry canon_CN_E_85mm_T1_3_tramsmission[] =
{
  {375.23349436392914, 16.337395149854586},
  {380.3972088030059, 12.567763190735292},
  {384.170692431562, 14.585618913977129},
  {388.93719806763283, 24.22615647145173},
  {391.7176596886742, 31.57196181855494},
  {394.69672571121845, 38.36652856120733},
  {396.8813741277509, 44.977990020170424},
  {399.66183574879227, 51.58900776681438},
  {403.2367149758454, 58.199433897032854},
  {406.81159420289856, 64.99355692736614},
  {412.3725174449812, 72.33729161698012},
  {420.51529790660226, 78.57692215252241},
  {433.6231884057971, 84.07806748494613},
  {455.07246376811594, 88.28712254409854},
  {471.358024691358, 91.21414480921294},
  {490.4240472356414, 93.4043088163789},
  {512.667740203972, 94.67362185726884},
  {546.8276972624799, 95.5666668515468},
  {629.447128287708, 96.0562294436402},
  {658.8405797101449, 94.74846133509338},
  {683.4675254965109, 92.52575842452545},
  {699.3558776167472, 90.58510864481013},
  {716.435856146001, 88.09248074011214},
  {730.3381642512077, 85.78591620123092},
  {749.6027911969938, 82.46502530084618},
};

}

/* Adjust xscale, yscale and zscale so dye rgb (1,1,1) results
   in intensity 1  */
void
spectrum_dyes_to_xyz::normalize_brightness ()
{
  xscale = yscale = zscale = 1;
  struct xyz ret = dyes_rgb_to_xyz (1, 1, 1);
  xscale = yscale = zscale = 1 / ret.y;
  if (debug)
    {
      printf ("Normalizing xyz luminosity range\n");
      printf ("Combined xyz %f %f %f\n", ret.x, ret.y, ret.z);
      printf ("rscale %f gscale %f bscale %f\n", rscale, gscale, bscale);
      printf ("xscale %f yscale %f zscale %f\n", xscale, yscale, zscale);
    }
}
/* Adjust xscale, yscale and zscale so dye rgb (1,1,1) results
   in sRGB white  */
void
spectrum_dyes_to_xyz::normalize_xyz_to_backlight_whitepoint ()
{
  xscale = yscale = zscale = 1;
  xyz whitepoint = whitepoint_xyz ();
  xyz dyewhitepoint = dyes_rgb_to_xyz (1, 1, 1);
  xscale = whitepoint.x / whitepoint.y / dyewhitepoint.x;
  yscale = 1 / dyewhitepoint.y;
  zscale = whitepoint.z / whitepoint.y / dyewhitepoint.z;

  if (debug)
    {
      printf ("Normalizing dyes to backlight by scaling xyz\n"
	      "Whitepoint xyz %f %f %f\n", whitepoint.x / whitepoint.y, whitepoint.y / whitepoint.y, whitepoint.z / whitepoint.y);
      printf ("Dye whitepoint xyz %f %f %f\n", dyewhitepoint.x, dyewhitepoint.y, dyewhitepoint.z);
      printf ("rscale %f gscale %f bscale %f\n", rscale, gscale, bscale);
      printf ("xscale %f yscale %f zscale %f\n", xscale, yscale, zscale);
      dyewhitepoint = dyes_rgb_to_xyz (1, 1, 1);
      printf ("Dye whitepoint xyz %f %f %f\n", dyewhitepoint.x, dyewhitepoint.y, dyewhitepoint.z);
    }
}

void
spectrum_dyes_to_xyz::set_backlight (enum illuminants il, luminosity_t temperature)
{
  set_illuminant_to (backlight, il, temperature);
}

/* Autochrome screen was made by mixing dyes to be gray.  Simulate same thing: find
   rscale, gscale and wscale so together they produce a given.  */
void
spectrum_dyes_to_xyz::normalize_dyes (luminosity_t temperature)
{
  spectrum backlight_bck;
  memcpy (backlight_bck, backlight, sizeof (backlight));
  set_backlight (il_D, temperature);
  rscale = gscale = bscale = 1;
  xyz rxyz = get_xyz (red);
  xyz gxyz = get_xyz (green);
  xyz bxyz = get_xyz (blue);
  xyz whitepoint = whitepoint_xyz ();

  color_matrix m (rxyz.x, gxyz.x, bxyz.x, 0,
		  rxyz.y, gxyz.y, bxyz.y, 0,
		  rxyz.z, gxyz.z, bxyz.z, 0, 0, 0, 0, 1);
  color_matrix n = m.invert ();
  n.apply_to_rgb (whitepoint.x, whitepoint.y, whitepoint.z, &rscale, &gscale, &bscale);
  if (debug)
    {
      printf ("Normalizing dyes to be neutral at %fK daylight\n"
	      "Whitepoint xyz %f %f %f\n", temperature, whitepoint.x / whitepoint.y, whitepoint.y / whitepoint.y, whitepoint.z / whitepoint.y);
      printf ("Red dye xyz %f %f %f\n", rxyz.x, rxyz.y, rxyz.z);
      printf ("Green dye xyz %f %f %f\n", gxyz.x, gxyz.y, gxyz.z);
      printf ("Blue dye xyz %f %f %f\n", bxyz.x, bxyz.y, bxyz.z);
      printf ("rscale %f gscale %f bscale %f\n", rscale, gscale, bscale);
      printf ("xscale %f yscale %f zscale %f\n", xscale, yscale, zscale);
      xyz dyewhitepoint = dyes_rgb_to_xyz (1, 1, 1);
      printf ("Adjusted dye whitepoint xyz %f %f %f\n", dyewhitepoint.x, dyewhitepoint.y, dyewhitepoint.z);
    }

  memcpy (backlight, backlight_bck, sizeof (backlight));
}

void
change_concentration (spectrum s, luminosity_t concentration)
{
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    s[i] = pow (s[i], concentration);
}


void
spectrum_dyes_to_xyz::debug_write_spectra ()
{
  FILE *f = fopen ("/tmp/red.dat", "wt");
  print_absorbance_spectrum (f, red);
  fclose (f);
  f = fopen ("/tmp/green.dat", "wt");
  print_absorbance_spectrum (f, green);
  fclose (f);
  f = fopen ("/tmp/blue.dat", "wt");
  print_absorbance_spectrum (f, blue);
  fclose (f);
  f = fopen ("/tmp/red-trans.dat", "wt");
  print_transmitance_spectrum (f, red);
  fclose (f);
  f = fopen ("/tmp/green-trans.dat", "wt");
  print_transmitance_spectrum (f, green);
  fclose (f);
  f = fopen ("/tmp/blue-trans.dat", "wt");
  print_transmitance_spectrum (f, blue);
  fclose (f);
  f = fopen ("/tmp/backlight.dat", "wt");
  print_transmitance_spectrum (f, backlight);
  fclose (f);
  f = fopen ("/tmp/x.dat", "wt");
  print_transmitance_spectrum (f, cie_cmf_x);
  fclose (f);
  f = fopen ("/tmp/y.dat", "wt");
  print_transmitance_spectrum (f, cie_cmf_y);
  fclose (f);
  f = fopen ("/tmp/z.dat", "wt");
  print_transmitance_spectrum (f, cie_cmf_z);
  fclose (f);
}

bool
spectrum_dyes_to_xyz::is_linear ()
{
  const int steps = 16;
  const luminosity_t max_error = (0.5 / 65546);
  for (int r = 0; r < steps; r++)
    for (int g = 0; g < steps; g++)
      for (int b = 0; b < steps; b++)
        {
	  luminosity_t rr = r / (luminosity_t) steps;
	  luminosity_t gg = g / (luminosity_t) steps;
	  luminosity_t bb = b / (luminosity_t) steps;
	  xyz v1 = dyes_rgb_to_xyz (rr, gg, bb);
	  xyz v2 = xyz::from_linear_srgb (rr, gg, bb);
	  if (fabs (v1.x - v2.x) > max_error
	      || fabs (v1.y - v2.y) > max_error
	      || fabs (v1.z - v2.z) > max_error)
	    return false;
        }
  return true;
}

/* Return XYZ of a daylight with given TEMPERATURE.  */
xyz
spectrum_dyes_to_xyz::temperature_xyz (luminosity_t temperature)
{
  spectrum_dyes_to_xyz dyes;
  dyes.set_backlight (il_D, temperature);
  return dyes.whitepoint_xyz ();
}

/* Compute XYZ values.  */
static inline struct xyz
get_xyz_old_observer (spectrum backlight, spectrum s, const char *filename = NULL)
{
  struct xyz ret = { 0, 0, 0 };
  luminosity_t sum = 0;
  FILE *f = NULL;
  if (filename)
     f = fopen(filename, "wt");
  /* TODO: CIE recommends going by 1nm bands and interpolate.
     We can implement that easily if that makes difference.  */
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      ret.x += (cie_cmf_x[i] * s[i] * backlight[i]);
      ret.y += (cie_cmf_y[i] * s[i] * backlight[i]);
      ret.z += (cie_cmf_z[i] * s[i] * backlight[i]);
      sum += cie_cmf_y[i] * backlight[i];
      if (f)
        fprintf (f, "%i %f\n", i * SPECTRUM_STEP + SPECTRUM_START, s[i] * backlight[i]);
    }
  if (f)
    fclose (f);
  luminosity_t scale = 1 / sum;
  ret.x *= scale;
  ret.y *= scale;
  ret.z *= scale;
  /* Argyll scales by backlight.  */
  return ret;
}

xyz
combined_xyz (luminosity_t *dye1, luminosity_t *dye2, luminosity_t *backlight, const char *filename = NULL, const char *filename2 = NULL)
{
  spectrum tmp;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      tmp [i] = (dye1 ? dye1[i] : 1) * (dye2 ? dye2[i] : 1);
    }
  if (filename)
    {
      FILE *f = fopen (filename, "wt");
      print_transmitance_spectrum (f, tmp);
      fclose (f);
    }

  xyz ret = get_xyz_old_observer (backlight, tmp, filename2);
  return ret;
}

void
spectrum_dyes_to_xyz::adjust_film_response_for_zeiss_contact_prime_cp2_lens ()
{
  spectrum s;
  compute_spectrum (s, sizeof (zeiss_contact_prime_cp2_tramsmission) / sizeof (spectra_entry), zeiss_contact_prime_cp2_tramsmission, false, 100/* norm */, 0/*min*/);
  for (int i = 0 ; i < SPECTRUM_SIZE; i++)
    film_response[i] *= s[i];
}

void
spectrum_dyes_to_xyz::adjust_film_response_for_canon_CN_E_85mm_T1_3_lens ()
{
  spectrum s;
  compute_spectrum (s, sizeof (canon_CN_E_85mm_T1_3_tramsmission) / sizeof (spectra_entry), canon_CN_E_85mm_T1_3_tramsmission, false, 100/* norm */, 0/*min*/);
  for (int i = 0 ; i < SPECTRUM_SIZE; i++)
    film_response[i] *= s[i];
}


void
spectrum_dyes_to_xyz::set_film_response (enum responses film)
{
  set_response (film_response, film);
}

void
spectrum_dyes_to_xyz::set_response_to_kodachrome_25 ()
{
  subtractive = set_dyes_to (red, green, blue, cyan, magenta, yellow, kodachrome_25_sensitivity);
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    film_response[i] = 1;
}

/* Simulate density of recording BACKLIGHT filtred by FILTER1 and FILTER2
   on film with sensitivity RESPONSE.

   RESPONSE is not wedge histogram, but transmitance loss computed by
   log_sensitivity_to_reversal_transmitance

   BACKLIGHT may be NULL if film response is already relative to some backlight.
   FILTER2 may be NULL if filter is missing.  */

static luminosity_t
simulated_response (luminosity_t *backlight, luminosity_t *response, luminosity_t *filter1 = NULL, luminosity_t *filter2 = NULL)
{
  luminosity_t sum = 0;
  luminosity_t rsum = 0;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      luminosity_t val = response[i];
      if (val < 0)
	 if (backlight[i] < 0)
	   printf ("Negative response %i %f\n", i, response[i]);
      assert (val >= 0);
      if (backlight)
	{
	   if (backlight[i] < 0)
	     printf ("Negative backlight %i %f\n", i, backlight[i]);
	   assert (backlight[i]>=0);
	   val *= backlight[i];
	}
      rsum += val;
      if (filter1)
	{
#if 0
	  if (filter1[i] < 0 || filter1[i] > 1)
	     printf ("Wrong filter1 %i %f\n", i, filter1[i]);
	  assert (filter1[i] >= 0 && filter1[i] <= 1);
#endif
	  val *= filter1[i];
	}
      if (filter2)
        {
#if 0
	  if (filter2[i] < 0 || filter2[i] > 1)
	     printf ("Wrong filter2 %i %f\n", i, filter2[i]);
          assert (filter2[i] >= 0 && filter2[i] <= 1);
#endif
	  val *= filter2[i];
        }
      sum += val;
    }
  if (!rsum)
    return 0;
  return sum / rsum;
}

/* Increase/decrease concentration of filter S to reach luminosity Y.
   NORM is base for no filter, i.e. estimated density of film base.  */

luminosity_t
adjust_concentration_to_y (spectrum backlight, spectrum s, luminosity_t y, luminosity_t norm = 1)
{
  luminosity_t bestc = 0, bestc_y = 1;
  luminosity_t sum = 0;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    sum += cie_cmf_y[i] * backlight[i];
  for (luminosity_t c = 0.001 ; c < 10; c+=0.001)
    {
      luminosity_t ysum = 0;
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	ysum += (cie_cmf_y[i] * my_pow (s[i] / norm, c) * norm * backlight[i]) ;
      ysum /= sum;
      //printf ("%f %f %f\n",y, ysum, bestc_y);
      if (fabs (ysum - y) < fabs (bestc_y - y))
	{
	  bestc_y = ysum;
	  bestc = c;
	}
    }
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    s[i] = my_pow (s[i]/norm, bestc) * norm;
  return bestc;
}

rgbdata
spectrum_dyes_to_xyz::determine_patch_weights_by_simulated_response (int observer)
{
  xyz half_whitepoint = whitepoint_xyz (observer) * 0.5;
  rgbdata white = xyz_to_dyes_rgb (half_whitepoint, observer);
  rgbdata res = /*linear_*/film_rgb_response (NULL) * 0.5;
#if 0
  if (red_characteristic_curve)
    return {red_characteristic_curve->unapply (white.red) / red_characteristic_curve->unapply (res.red),
	    green_characteristic_curve->unapply (white.green) / green_characteristic_curve->unapply (res.green),
	    blue_characteristic_curve->unapply (white.blue) / blue_characteristic_curve->unapply (res.blue)};
#endif
  return {white.red / res.red, white.green / res.green, white.blue / res.blue};
}

bool
spectrum_dyes_to_xyz::generate_simulated_argyll_ti3_file (FILE *f)
{
  adjust_exposure ();
  rgbdata res = film_rgb_response (NULL);
  luminosity_t sum = res.red + res.green + res.blue;
  rgbdata scale = {1/sum, 1/sum, 1/sum};
  int nsamples = sizeof (TLCI_2012_TCS) / sizeof (xspect);
  fprintf (f, "CTI3\n\n");
  fprintf (f, "DESCRIPTOR \"Colorscreen produced Argyll Calibration Target chart information 3\"\n");
  fprintf (f, "ORIGINATOR \"Argyll target\"\n");
  fprintf (f, "DEVICE_CLASS \"INPUT\"\n");
  fprintf (f, "COLOR_REP \"XYZ_RGB\"\n\n");
  fprintf (f, "NUMBER_OF_FIELDS 10\n");
  fprintf (f, "BEGIN_DATA_FORMAT\n");
  fprintf (f, "SAMPLE_ID XYZ_X XYZ_Y XYZ_Z RGB_R RGB_G RGB_B STDEV_R STDEV_G STDEV_B\n");
  fprintf (f, "END_DATA_FORMAT\n\n");
  fprintf (f, "NUMBER_OF_SETS %i\n", nsamples);
  fprintf (f, "BEGIN_DATA\n");

  for (int y = 0; y < (nsamples + 5) / 6; y++)
    {
      for (int x = 0; x < 6; x++)
	{
	  if (y * 6 + x >= nsamples)
	    continue;
	  xspect &xtile = TLCI_2012_TCS [y * 6 + x];
	  spectrum tile;
	  compute_spectrum (tile, xtile);
	  xyz real_color = get_xyz_old_observer (backlight, tile);
          rgbdata color = film_rgb_response (tile) * scale;
	  fprintf (f, "A%c%i %f %f %f %f %f %f %f %f %f\n",
		   'A'+y, x+1,
		   real_color.x * 100, real_color.y * 100, real_color.z * 100,
		   color.red * 100, color.green * 100, color.blue * 100, 0.0, 0.0, 0.0);
	}
    }
  fprintf (f, "END_DATA\n");
  return true;
}
rgbdata
spectrum_dyes_to_xyz::linear_film_rgb_response (luminosity_t *s)
{
  return {simulated_response (backlight, film_response, red, s),
	  simulated_response (backlight, film_response, green, s),
	  simulated_response (backlight, film_response, blue, s)};
}

rgbdata
spectrum_dyes_to_xyz::film_rgb_response (luminosity_t *s)
{
  rgbdata ret = linear_film_rgb_response (s);
  if (red_characteristic_curve)
    {
      ret.red = red_characteristic_curve->apply (ret.red * exp_adjust.red);
      ret.green = green_characteristic_curve->apply (ret.green * exp_adjust.green);
      ret.blue = blue_characteristic_curve->apply (ret.blue * exp_adjust.blue);
    }
  return ret;
}

bool
spectrum_dyes_to_xyz::generate_color_target_tiff (const char *filename, const char **error, bool white_balance, bool optimized)
{
  xyz whitepoint = whitepoint_xyz ();
  rgbdata scale = {0,0,0};/*determine_relative_patch_sizes_by_simulated_response ();*/
  //scale = determine_patch_weights_by_simulated_response ();
  int nsamples = sizeof (TLCI_2012_TCS) / sizeof (xspect);
  int n = 0;
  adjust_exposure ();
  spectrum tile;
#if 0
  if (subtractive)
    {
	//xyz dufay_color = dyes_rgb_to_xyz (0.1, 0.1, 0.1);
	rscale = gscale = bscale = /*dufay_color.y / 0.1*/1;
    }
#endif
  if (optimized)
    {
      rgbdata film_white = film_rgb_response (NULL);
      luminosity_t sum = (film_white.red + film_white.green + film_white.blue) / 3;
      scale.red = 1/sum;
      scale.green = 1/sum;
      scale.blue = 1/sum;
    }
  else if (white_balance)
    {
      scale = determine_patch_weights_by_simulated_response ();
      printf ("white balance  %f%% %f%% %f%%\n",100 * scale.red, 100 * scale.green, 100 * scale.blue);
    }
  else 
    {
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	 tile[i] = 0.5;
      rgbdata film_white = film_rgb_response (tile);

      luminosity_t sum;
      /* For subtractive processes just be sure that backlight is 100% white on film.  */
      if (subtractive)
        sum = (film_white.red + film_white.green + film_white.blue) / 3;
      /* For additive processes make backlight photo to have 100% white in replay.
         This also compensates the screen darkness.  */
      else
        {
	  xyz c = dyes_rgb_to_xyz (film_white.red, film_white.green, film_white.blue);
	  sum = c.y;
        }
      printf ("Film response to backlight %f %f %f sum:%f\n", film_white.red, film_white.green, film_white.blue, sum);
      scale.red = scale.green = scale.blue = 0.5 / sum;
	      /*determine_relative_patch_sizes_by_whitepoint ();*/
              /*xyz_to_dyes_rgb (whitepoint);*/
    
      //scale /= sum * 0.3;
    }
  luminosity_t sum = scale.red + scale.green + scale.blue;
  luminosity_t sum2 = scale.red * rscale + scale.green * gscale + scale.blue * bscale;
  printf ("RGB scales  %f %f%% %f %f%% %f %f%%\n", scale.red, 100 * scale.red / sum, scale.green, 100 * scale.green / sum, scale.blue, 100 * scale.blue / sum);
  printf ("RGB scales adjusted by patch sizes  %f %f%% %f %f%% %f %f%%\n", scale.red * rscale, 100 * scale.red * rscale / sum2, scale.green * gscale, 100 * scale.green * gscale / sum2, scale.blue * bscale, 100 * scale.blue * bscale / sum2);
  color_matrix id;
  color_matrix m = optimized ? optimized_xyz_matrix () : subtractive ? id : xyz_matrix ();
  luminosity_t deltaEsum = 0;
  luminosity_t deltaEmax = 0;

  void *buffer;
  size_t len = create_pro_photo_rgb_profile (&buffer, whitepoint);
  tiff_writer_params par;
  par.filename = filename;
  par.width = 12;
  par.height = (nsamples + 5) / 6;
  par.depth = 32;
  par.hdr = true;
  par.icc_profile = buffer;
  par.icc_profile_len = len;
  tiff_writer tiff (par, error);
  if (*error)
    {
      free (buffer);
      return false;
    }
  for (int y = 0; y < (nsamples + 5) / 6; y++)
    {
      for (int d = 0; d < 2; d++)
	{
	  for (int x = 0; x < 6; x++)
	    {
	      xspect &xtile = TLCI_2012_TCS [std::min (y * 6 + x, nsamples - 1)];
	      compute_spectrum (tile, xtile);
	      xyz real_color = get_xyz_old_observer (backlight, tile);
	      rgbdata color = film_rgb_response (tile) * scale;
	      xyz dufay_color (0,0,0);
	      if (!subtractive || optimized)
	        m.apply_to_rgb (color.red, color.green, color.blue, &dufay_color.x, &dufay_color.y, &dufay_color.z);
	      else
		dufay_color = dyes_rgb_to_xyz (color.red, color.green, color.blue);
	      //xyz dufay_color = dyes_rgb_to_xyz (color.red, color.green, color.blue);
	      luminosity_t r,g,b;
	      xyz_to_pro_photo_rgb (real_color.x, real_color.y, real_color.z, &r, &g, &b);
	      tiff.put_hdr_pixel (x * 2, r, g, b);
	      xyz_to_pro_photo_rgb (dufay_color.x, dufay_color.y, dufay_color.z, &r, &g, &b);
	      tiff.put_hdr_pixel (x * 2 + 1, r, g, b);
	      if (y * 6 + x < nsamples)
		{
#if 0
			printf ("Compare2 %i\n", y * 6 + x);
			real_color.print (stdout);
			dufay_color.print (stdout);
#endif
		  luminosity_t de = deltaE2000 (real_color, dufay_color, whitepoint);
		  if (de > deltaEmax)
		    deltaEmax = de;
		  deltaEsum += de;
		  n++;
		}
	    }
	  if (!tiff.write_row ())
	    {
	      *error = "write error";
	      free (buffer);
	      return false;
	    }
	}
    }
  free (buffer);
  printf ("Average deltaE 2000 %f, max %f\n", deltaEsum / n, deltaEmax);
  return true;
}
color_matrix
spectrum_dyes_to_xyz::optimized_xyz_matrix (spectrum_dyes_to_xyz *observing_spec)
{
  if (observing_spec == NULL)
    observing_spec = this;
  const int n = sizeof (TLCI_2012_TCS) / sizeof (xspect);
  rgbdata colors[n];
  xyz targets[n];
  rgbdata res = film_rgb_response (NULL);
  luminosity_t sum = res.red + res.green + res.blue;
  res.red = res.green = res.blue = sum / 3;
  rgbdata scale = {1 / res.red, 1 / res.green, 1 / res.blue};
  for (int i = 0; i < n; i++)
    {
      xspect &xtile = TLCI_2012_TCS [i];
      spectrum tile;
      compute_spectrum (tile, xtile);
      colors[i] = film_rgb_response (tile) * scale;
      targets[i] = get_xyz_old_observer (observing_spec->backlight, tile);
    }
  color_matrix m1 = determine_color_matrix (colors, targets, NULL, n, observing_spec->whitepoint_xyz ());
  m1.scale_channels (1/rscale, 1/gscale, 1/bscale);
  
  return m1;
}
void
spectrum_dyes_to_xyz::write_spectra (const char *reds, const char *greens, const char *blues, const char *backlights, int start, int end, bool absorbance)
{
  if (reds)
    {
      FILE *f = fopen (reds, "wt");
      if (absorbance)
        print_absorbance_spectrum (f, red, start, end);
      else
        print_transmitance_spectrum (f, red, start, end);
      fclose (f);
    }
  if (greens)
    {
      FILE *f = fopen (greens, "wt");
      if (absorbance)
        print_absorbance_spectrum (f, green, start, end);
      else
        print_transmitance_spectrum (f, green, start, end);
      fclose (f);
    }
  if (blues)
    {
      FILE *f = fopen (blues, "wt");
      if (absorbance)
        print_absorbance_spectrum (f, blue, start, end);
      else
        print_transmitance_spectrum (f, blue, start, end);
      fclose (f);
    }
  if (backlights)
    {
      FILE *f = fopen (backlights, "wt");
      print_transmitance_spectrum (f, backlight, start, end);
      fclose (f);
    }
}


void
spectrum_dyes_to_xyz::write_film_characteristic_curves (const char *reds, const char *greens, const char *blues)
{
  if (reds && red_characteristic_curve)
    {
      FILE *f = fopen (reds, "wt");
      red_characteristic_curve->print (f);
      fclose (f);
    }
  if (greens && green_characteristic_curve)
    {
      FILE *f = fopen (greens, "wt");
      green_characteristic_curve->print (f);
      fclose (f);
    }
  if (blues && blue_characteristic_curve)
    {
      FILE *f = fopen (blues, "wt");
      blue_characteristic_curve->print (f);
      fclose (f);
    }
}
void
spectrum_dyes_to_xyz::write_film_hd_characteristic_curves (const char *reds, const char *greens, const char *blues)
{
  if (reds && red_characteristic_curve)
    {
      FILE *f = fopen (reds, "wt");
      red_characteristic_curve->print_hd (f);
      fclose (f);
    }
  if (greens && green_characteristic_curve)
    {
      FILE *f = fopen (greens, "wt");
      green_characteristic_curve->print_hd (f);
      fclose (f);
    }
  if (blues && blue_characteristic_curve)
    {
      FILE *f = fopen (blues, "wt");
      blue_characteristic_curve->print_hd (f);
      fclose (f);
    }
}

/* Output gnuplottable data.  */
static void
print_response_spectrum (FILE * out, const spectrum spec, int start = SPECTRUM_START, int end = SPECTRUM_END)
{
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    if (i * SPECTRUM_STEP + SPECTRUM_START >= start && i * SPECTRUM_STEP + SPECTRUM_START <= end)
      {
	//if (spec[i])
	  fprintf (out, "%i %f\n", i * SPECTRUM_STEP + SPECTRUM_START, log10 (spec[i]));
	//else
	  //fprintf (out, "%i\n", i * SPECTRUM_STEP + SPECTRUM_START, log10 (spec[i]));
	//assert (spec[i] > -100 && spec [i] < 100);
      }
}

static void
print_transmitance_spectrum_json (FILE *f, const char *name, spectrum s)
{
  fprintf (f, "  \"%s\": [ ", name);
 fprintf (f, " %f", s[0]);
  for (int i = 1; i < SPECTRUM_SIZE; i++)
    fprintf (f, ", %f", s[i]);
  fprintf (f, "]");
}

void
spectrum_dyes_to_xyz::write_ssf_json (const char *name)
{
  FILE *f = fopen (name, "wt");
  fprintf (f, "// Simulated spectral sensitivity function generated by ColorScreen\n"
	  "// Use by dcamprof software\n"
	  "{\n"
	  "  \"camera_name\": \"simulated additive process\",\n"
	  "  \"ssf_bands\": [ %i, %i, %i ],\n", SPECTRUM_START, SPECTRUM_END, SPECTRUM_STEP);
  spectrum sred, sgreen, sblue;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      sred[i] = red[i] * film_response[i];
      sgreen[i] = green[i] * film_response[i];
      sblue[i] = blue[i] * film_response[i];
    }
  print_transmitance_spectrum_json (f, "red_ssf", sred);
  fprintf (f, ",\n");
  print_transmitance_spectrum_json (f, "green_ssf", sgreen);
  fprintf (f, ",\n");
  print_transmitance_spectrum_json (f, "blue_ssf", sblue);
  fprintf (f, "\n}");
}

void
spectrum_dyes_to_xyz::write_responses (const char *reds, const char *greens, const char *blues, bool log, int start, int end)
{
  spectrum sred, sgreen, sblue;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      sred[i] = red[i] * film_response[i];
      sgreen[i] = green[i] * film_response[i];
      sblue[i] = blue[i] * film_response[i];
    }
  if (reds)
    {
      FILE *f = fopen (reds, "wt");
      if (log)
        print_response_spectrum (f, sred);
      else
        print_transmitance_spectrum (f, sred, start, end);
      fclose (f);
    }
  if (greens)
    {
      FILE *f = fopen (greens, "wt");
      if (log)
        print_response_spectrum (f, sgreen);
      else
        print_transmitance_spectrum (f, sgreen, start, end);
      fclose (f);
    }
  if (blues)
    {
      FILE *f = fopen (blues, "wt");
      if (log)
        print_response_spectrum (f, sblue, start, end);
      else
        print_transmitance_spectrum (f, sblue, start, end);
      fclose (f);
    }
}
/* Write response of the film covered by optional filter specified by F.  */

bool
spectrum_dyes_to_xyz::write_film_response (const char *filename, luminosity_t *fi, bool absolute, bool log)
{
  FILE *f = fopen (filename, "wt");
  if (!f)
    return false;
  luminosity_t sum = 0;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    sum += film_response[i] * (!absolute ? backlight[i] : 1);
  spectrum s;
  for (int i = 0; i < SPECTRUM_SIZE; i++)
  {
    s[i] = (film_response[i] * (!absolute ? backlight[i] : 1) * (fi ? fi[i] : 1) * 100) / sum;
    //printf ("%s %f %f %f %f\n", filename, s[i], film_response[i] , (!absolute ? backlight[i] : 1), (fi ? fi[i] : 1));
  }
  if (log)
    print_response_spectrum (f, s);
  else
    print_transmitance_spectrum (f, s);
  fclose (f);
  return true;
}

/* Output tiff file showing primaries.  */
bool
tiff_with_strips (const char *filename, xyz filter_red, xyz filter_green, xyz filter_blue, xyz background, xyz white)
{
  void *buffer;
  size_t len = create_pro_photo_rgb_profile (&buffer, srgb_white);
  tiff_writer_params par;
  par.filename=filename;
  par.width = par.height = 19;
  par.height = 19;
  par.height = 19;
  par.depth = 32;
  par.hdr = true;
  par.icc_profile = buffer;
  par.icc_profile_len = len;
  const char *error;
  tiff_writer tiff (par, &error);
  if (error)
    {
      free (buffer);
      return false;
    }
  luminosity_t r,g,b;
  for (int i = 0; i < 19; i++)
    {
      xyz_to_pro_photo_rgb (background.x, background.y, background.z, &r, &g, &b);
      for (int j = 0; j < 19; j++)
	tiff.put_hdr_pixel (j, r, g, b);
      //filter_red.print (stdout);
      //filter_green.print (stdout);
      //filter_blue.print (stdout);
      xyz_to_pro_photo_rgb (filter_red.x, filter_red.y, filter_red.z, &r, &g, &b);
      tiff.put_hdr_pixel (4, r, g, b);
      tiff.put_hdr_pixel (5, r, g, b);
      tiff.put_hdr_pixel (6, r, g, b);
      xyz_to_pro_photo_rgb (filter_green.x, filter_green.y, filter_green.z, &r, &g, &b);
      tiff.put_hdr_pixel (8, r, g, b);
      tiff.put_hdr_pixel (9, r, g, b);
      tiff.put_hdr_pixel (10, r, g, b);
      xyz_to_pro_photo_rgb (filter_blue.x, filter_blue.y, filter_blue.z, &r, &g, &b);
      tiff.put_hdr_pixel (12, r, g, b);
      tiff.put_hdr_pixel (13, r, g, b);
      tiff.put_hdr_pixel (14, r, g, b);
      xyz_to_pro_photo_rgb (white.x, white.y, white.z, &r, &g, &b);
      tiff.put_hdr_pixel (16, r, g, b);
      tiff.put_hdr_pixel (17, r, g, b);
      tiff.put_hdr_pixel (18, r, g, b);
      if (!tiff.write_row ())
	{
	  free (buffer);
	  return false;
	}
    }
  free (buffer);
  return true;
}
/* Output tiff file showing primaries.  */
bool
spectrum_dyes_to_xyz::tiff_with_spectra_photo (const char *filename)
{
  tiff_writer_params par;
  par.filename=filename;
  const int w = 100;
  void *buffer;
  size_t len = create_pro_photo_rgb_profile (&buffer, srgb_white);
  par.width = SPECTRUM_END - SPECTRUM_START;
  par.height = w * 4;
  par.depth = 32;
  par.hdr = true;
  par.icc_profile = buffer;
  par.icc_profile_len = len;
  const char *error;
  tiff_writer tiff (par, &error);
  spectrum bandf;
  const int minp = 400;
  const int maxp = 780;
  const double powf = 1.5;
  if (error)
    return false;
  luminosity_t max = 0;
  for (int x = 0; x < SPECTRUM_END - SPECTRUM_START; x++)
  {
    int band = x + SPECTRUM_START;
    set_illuminant_to (bandf, il_band, band);
    luminosity_t l = simulated_response (backlight, film_response, bandf, NULL);
    if (l > max)
      max = l;
  }
  for (int y = 0; y < w * 4; y++)
    {
      for (int x = 0; x < par.width; x++)
        {
	  luminosity_t lxp = pow ((x-1) / (luminosity_t)par.width, powf);
	  luminosity_t xp = pow (x / (luminosity_t)par.width, powf);
	  luminosity_t nxp = pow ((x+1) / (luminosity_t)par.width, powf);
	  int lband = minp + lxp * (maxp - minp);
	  int band = minp + xp * (maxp - minp);
	  int nband = minp + nxp * (maxp - minp);
	  if ((((int)lband) / 100) < ((int)nband) / 100 && (y % w) > 3 *w /4)
	    tiff.put_hdr_pixel (x, 1, 0, 0);
	  else if ((((int)lband) / 50) < ((int)nband) / 50 && (y % w) > 5 *w /6)
	    tiff.put_hdr_pixel (x, 1, 0, 0);
#if 0
	  else if (((band + 1) % 50) < 3 && (y % w) > 5 *w /6)
#endif
	  else if ((((int)band) / 10) < ((int)nband) / 10 && (y % w) > 7 *w /8)
	    tiff.put_hdr_pixel (x, 0, 0, 1);
	  else 
	    {
	      set_illuminant_to (bandf, il_band, band);
	      luminosity_t *s = y < w ? blue : y < 2 * w ? green : y < 3 * w ? red : NULL, r, g, b;
	      if ((y % w) < 2 * w / 3)
		{
	          luminosity_t l = simulated_response (backlight, film_response, bandf, s);
		  l /= max;
		  xyz_to_pro_photo_rgb (l, l, l, &r, &g, &b);
		}
	      else
		{
		  xyz c;
		  if (s)
		    for (int i = 0; i < SPECTRUM_SIZE; i++)
		      bandf[i] *= s[i];
	          c = get_xyz_old_observer (backlight, bandf);
		  c = c * 15;
		  xyz_to_pro_photo_rgb (c.x, c.y, c.z, &r, &g, &b);
		}
	      tiff.put_hdr_pixel (x, r, g, b);
	    }
#if 0
	  else
	    {
	      set_backlight (il_band, band);
	      xyz color = whitepoint_xyz ();
	      luminosity_t r,g,b;
	      color.to_srgb (&r, &g, &b);
	      r = std::min (std::max (r, (luminosity_t)0), (luminosity_t)1);
	      g = std::min (std::max (g, (luminosity_t)0), (luminosity_t)1);
	      b = std::min (std::max (b, (luminosity_t)0), (luminosity_t)1);
	      tiff.put_pixel (x, r* 65535, g * 65535, b * 65535);
	    }
#endif
        }
      if (!tiff.write_row ())
	return false;
    }
  return true;
}

bool
spectrum_dyes_to_xyz::tiff_with_primaries (const char *filename, rgbdata white)
{
  return tiff_with_strips (filename,
			   dyes_rgb_to_xyz (1, 0, 0),
			   dyes_rgb_to_xyz (0, 1, 0),
			   dyes_rgb_to_xyz (0, 0, 1),
			   whitepoint_xyz (),
			   dyes_rgb_to_xyz (white.red, white.green, white.blue));
}

bool
spectrum_dyes_to_xyz::tiff_with_overlapping_filters (const char *filename, rgbdata white, const char *spectra_prefix)
{
  xyz filter_white = dyes_rgb_to_xyz (white.red, white.green, white.blue);
  xyz whitepoint = whitepoint_xyz ();
  void *buffer;
  size_t len = create_pro_photo_rgb_profile (&buffer, whitepoint);

  tiff_writer_params par;
  par.filename=filename;
  par.width = 19;
  par.height = 19;
  par.depth = 32;
  par.hdr = true;
  par.icc_profile = buffer;
  par.icc_profile_len = len;
  const char *error;
  tiff_writer tiff (par, &error);
  if (error)
    {
      free (buffer);
      return false;
    }
  luminosity_t r,g,b;
  for (int i = 0; i < 5; i++)
    {
      int br = /*200*/1;
      for (int d = 0; d < (i == 4 ? 3 : 4); d++)
	{
	  xyz_to_pro_photo_rgb (filter_white.x * br, filter_white.y * br, filter_white.z * br, &r, &g, &b);
	  int i1 = i == 0 || i == 4 || d == 3 ? -1 : i-1;
	  for (int j = 0; j < 19; j++)
	    tiff.put_hdr_pixel (j, r, g, b);
	  for (int j = 0; j < 5; j++)
	    {
	      xyz_to_pro_photo_rgb (filter_white.x * br, filter_white.y * br, filter_white.z * br, &r, &g, &b);
	      for (int d2 = 0; d2 < (j == 4 ? 3 : 4); d2++)
		{
		  int mul = 1;
		  const char *filename = NULL;
		  const char *filename2 = NULL;
		  std::string sfile, sfile2;
		  int i2 = j == 0 || j == 4 || d2 == 3 ? -1 : j-1;
		  if (spectra_prefix)
		    {
		      const char *name[3]={"red","green","blue"};
		      sfile = std::string (spectra_prefix);
		      sfile2 = std::string (spectra_prefix);
		      if (i1 >= 0)
			{
			  sfile = sfile + std::string (name[i1]);
			  sfile2 = sfile2 + std::string (name[i1]);
			}
		      if (i2 >= 0)
			{
			  sfile = sfile + std::string (name[i2]);
			  sfile2 = sfile2 + std::string (name[i2]);
			}
		      sfile = sfile + ".dat";
		      sfile2 = sfile2 + "-backlight.dat";
		      filename = sfile.c_str ();
		      filename2 = sfile2.c_str ();
		    }
		  xyz f = combined_xyz (i1 < 0 ? NULL : i1 == 0 ? red : i1 == 1 ? green : blue,
					i2 < 0 ? NULL : i2 == 0 ? red : i2 == 1 ? green : blue,
					backlight, filename, filename2);
		  int br2 = (i && j) ? br : 1;
		  xyz_to_pro_photo_rgb (f.x * br2, f.y * br2, f.z * br2, &r, &g, &b);
		  tiff.put_hdr_pixel (j*4+d2, r*mul, g*mul, b*mul);
		}
	    }
	  if (!tiff.write_row ())
	    {
	      free (buffer);
	      return false;
	    }
	}
    }
  free (buffer);
  return true;
}
bool
spectrum_dyes_to_xyz::tiff_with_overlapping_filters_response (const char *filename, rgbdata white)
{
  tiff_writer_params par;
  par.filename=filename;
  par.width = 23;
  par.height = 19;
  par.depth = 32;
  par.hdr = true;
  void *buffer;
  size_t len = create_pro_photo_rgb_profile (&buffer, whitepoint_xyz ());
  par.icc_profile = buffer;
  par.icc_profile_len = len;
  const char *error;
  tiff_writer tiff (par, &error);
  if (error)
  {
    free (buffer);
    return false;
  }
  luminosity_t gamma = 1;

  rgbdata dred = film_rgb_response (red);
  rgbdata dgreen = film_rgb_response (green);
  rgbdata dblue = film_rgb_response (blue);
  rgbdata dwhite = film_rgb_response (NULL);
  /*TODO apply sensitivity curve.  */
  luminosity_t dglass = simulated_response (backlight, film_response);
  color_matrix m = xyz_matrix ();

  for (int i = 0; i < 5; i++)
    {
      for (int d = 0; d < (i == 4 ? 3 : 4); d++)
	{
	  int i1 = i == 0 || i == 4 || d == 3 ? -1 : i-1;
	  luminosity_t g = invert_gamma (dglass, gamma);
	  for (int j = 0; j < 19; j++)
	    tiff.put_hdr_pixel (j, g, g, g);
	  for (int j = 0; j < 5; j++)
	    {
	      for (int d2 = 0; d2 < (j == 4 ? 3 : 4); d2++)
		{
		  luminosity_t dd;

		  int i2 = j == 0 || j == 4 || d2 == 3 ? -1 : j-1;
		  if (i1 == -1 && i2 == -1)
		    dd = dglass;
		  else if (i1 == -1 || i2 == -1)
		    {
		      int c = i1 == -1 ? i2 : i1;
		      dd = dwhite[c];
		    }
		  else if (i1 == 0)
		    dd = dred[i2];
		  else if (i1 == 1)
		    dd = dgreen[i2];
		  else 
		    dd = dblue[i2];
		  g = invert_gamma (dd, gamma);
		  tiff.put_hdr_pixel (j*4+d2, g,g,g);
		}
	    }
	  luminosity_t r=1, b=1;
	  g=1;
	  if (i1 != -1 || (i == 0 && d < 3))
	    {
	      rgbdata &f = i == 0 ? dwhite : (i1 == 0) ? dred : (i1 == 1) ? dgreen : dblue;
	      //xyz c = (filter_red * f.red) + (filter_green * f.green) + (filter_blue * f.blue);
	      xyz c (0,0,0);
	      m.apply_to_rgb (f.red * white.red, f.green * white.green, f.blue * white.blue, &c.x, &c.y, &c.z);
	      xyz_to_pro_photo_rgb (c.x, c.y, c.z, &r, &g, &b);
	    }
	  tiff.put_hdr_pixel (19, 0, 0, 0);
	  tiff.put_hdr_pixel (20, r, g, b);
	  tiff.put_hdr_pixel (21, r, g, b);
	  tiff.put_hdr_pixel (22, r, g, b);
	  if (!tiff.write_row ())
	    return false;
	}
    }
  free (buffer);
  return true;
}

bool
write_optimal_response (color_matrix m, const char *redname, const char *greenname, const char *bluename, luminosity_t rw, luminosity_t gw, luminosity_t bw)
{
  FILE *redf = fopen (redname, "wt");
  if (!redf)
    return false;
  FILE *greenf = fopen (greenname, "wt");
  if (!greenf)
    {
      fclose (redf);
      return false;
    }
  FILE *bluef = fopen (bluename, "wt");
  if (!bluef)
    {
      fclose (redf);
      fclose (greenf);
      return false;
    }
  color_matrix im = m.invert ();
  for (int i = 0; i < SPECTRUM_SIZE; i++)
    {
      luminosity_t r, g, b;
      int freq = i * SPECTRUM_STEP + SPECTRUM_START;
      im.apply_to_rgb (cie_cmf_x[i], cie_cmf_y[i], cie_cmf_z[i], &r, &g, &b);
      fprintf (redf, "%f %f\n", (double)freq, r/rw);
      fprintf (greenf, "%f %f\n", (double)freq, g/gw);
      fprintf (bluef, "%f %f\n", (double)freq, b/bw);
    }
  fclose (redf);
  fclose (greenf);
  fclose (bluef);
  return true;
}

void
spectrum_dyes_to_xyz::synthetic_dufay_red (luminosity_t d1, luminosity_t d2)
{
  set_synthetic_dufay_red (red, d1, d2);
}

void
spectrum_dyes_to_xyz::synthetic_dufay_green (luminosity_t d1, luminosity_t d2)
{
  set_synthetic_dufay_green (red, d1, d2);
}

void
spectrum_dyes_to_xyz::synthetic_dufay_blue (luminosity_t d1, luminosity_t d2)
{
  set_synthetic_dufay_blue (red, d1, d2);
}

void
spectrum_dyes_to_xyz::set_dyes (enum dyes dyes, enum dyes dyes2, luminosity_t age)
{
#if 0
  if ((int)dyes >= (int)dufaycolor_color_cinematography
      && (int)dyes <= (int)dufaycolor_narrow_cut_filters_harrison_horner)
    {
      rscale = dufaycolor::red_size;
      gscale = dufaycolor::green_size;
      bscale = dufaycolor::blue_size;
    }
#endif
  subtractive = set_dyes_to (red, green, blue, cyan, magenta, yellow, dyes);
  if (age > 0)
    {
      spectrum aged_red, aged_green, aged_blue;
      set_dyes_to (aged_red, aged_green, aged_blue, cyan, magenta, yellow, dyes2);
      for (int i = 0; i < SPECTRUM_SIZE; i++)
	{
	  red[i] = red[i] * (1 - age) + aged_red[i] * age;
	  green[i] = green[i] * (1 - age) + aged_green[i] * age;
	  blue[i] = blue[i] * (1 - age) + aged_blue[i] * age;
	}
    }
}

void
spectrum_dyes_to_xyz::set_characteristic_curve (enum characteristic_curves curve)
{
  assert (!red_characteristic_curve);
  switch (curve)
  {
  case linear_reversal_curve:
    break;
  case input_curve:
    hd_curve = new synthetic_hd_curve (10, input_curve_params);
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve);
    red_characteristic_curve->precompute ();
    break;
  case safe_output_curve:
    hd_curve = new synthetic_hd_curve (10, safe_output_curve_params);
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve);
    red_characteristic_curve->precompute ();
    break;
  case safe_reversal_output_curve:
    hd_curve = new synthetic_hd_curve (10, safe_reversal_output_curve_params);
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve);
    red_characteristic_curve->precompute ();
    break;
  case kodachrome25_curve:
    red_characteristic_curve = new film_sensitivity (&film_sensitivity::kodachrome_25_red, 0, 4);
    red_characteristic_curve->precompute ();
    green_characteristic_curve = new film_sensitivity (&film_sensitivity::kodachrome_25_green, 0, 4);
    green_characteristic_curve->precompute ();
    blue_characteristic_curve = new film_sensitivity (&film_sensitivity::kodachrome_25_blue, 0, 4);
    blue_characteristic_curve->precompute ();
    break;
    /* Based on chart in The Spicer-Dudfay Colour Film Process, Thorne Baker, The Photograhic Jounral, March 1932, 109--117 */
  case spicer_dufay_curve_low:
    hd_curve = new synthetic_hd_curve (10, {0.005596021177603383, 0.13326648483876236,
					    0.9264367078453395, 0.25357372051981475,
					    3.8351612385689076, 1.7539186587518052,
					    3.8351612385689076, 1.7539186587518052});

    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve, 0.25, 6);
    blue_characteristic_curve->precompute ();
    break;
  case spicer_dufay_curve_mid:
    hd_curve = new synthetic_hd_curve (10, {0.005596021177603383, 0.13326648483876236,
					    0.7346061286699825, 0.3354524306112632,
					    2.7042515642547724, 2.207183539226697,
					    2.7042515642547724, 2.207183539226697});
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve, 0.25, 4);
    blue_characteristic_curve->precompute ();
    break;
  case spicer_dufay_curve_high:
    hd_curve = new synthetic_hd_curve (10, {0.005596021177603383, 0.13326648483876236,
					    0.664193807155463, 0.430406706240976,
					    1.5716733515161239, 2.2480065778918665,
					    1.5716733515161239, 2.2480065778918665});
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve, 0.25, 4);
    blue_characteristic_curve->precompute ();
    break;
  case spicer_dufay_reversal_curve_low:
    hd_curve = new synthetic_hd_curve (10, {
		0.10817262955238283, 1.7389218674795455,
		0.10817262955238283, 1.7389218674795455,
		3.1461832183539227, 0.19716428686026033,
		3.990309642226858, 0.10466468795122763});

    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve, 0, 3000 /*6000*/);
    blue_characteristic_curve->precompute ();
    break;
  case spicer_dufay_reversal_curve_mid:
    hd_curve = new synthetic_hd_curve (10, {
		1.2834525910476495, 2.253437349590888,
		1.2834525910476495, 2.253437349590888,
		3.262801219316541, 0.27367639980747693,
		3.990309642226858, 0.10466468795122763});
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve,0 , 3000 /*20000*/);
    blue_characteristic_curve->precompute ();
    break;
  case spicer_dufay_reversal_curve_high:
    hd_curve = new synthetic_hd_curve (10, {
		2.446334028557678, 2.2031926841007543,
		2.446334028557678, 2.2031926841007543,
		3.409735279961495, 0.34393951548211144,
		3.9904123215145204, 0.13004572437028772});
    red_characteristic_curve = green_characteristic_curve = blue_characteristic_curve = new film_sensitivity (hd_curve,0 , 3000 /*30000*/);
    blue_characteristic_curve->precompute ();
    break;
  default:
    abort ();
  }
}
